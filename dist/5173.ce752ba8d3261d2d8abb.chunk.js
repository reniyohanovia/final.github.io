(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[5173],{645648:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(618446),o=n.n(r),a=n(45697),s=n.n(a),i=n(124852),l=n.n(i),p=n(630294),c=n(835516);function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class m extends l().Component{constructor(){super(...arguments),u(this,"onComboChange",(e=>{var t=parseInt(e.nativeEvent.target.value,10);this.props.onChange(t,this.props.scales[t])})),u(this,"getOptions",(()=>this.props.scales.map(((e,t)=>l().createElement("option",{value:t,key:t},this.props.template(e,t)))).filter(((e,t)=>t>=this.props.minZoom))))}shouldComponentUpdate(e){return!o()(e,this.props)}render(){var e;return e=this.props.readOnly?l().createElement("label",null,this.props.template(this.props.scales[this.props.currentZoomLvl],this.props.currentZoomLvl)):this.props.useRawInput?l().createElement("select",{label:this.props.label,onChange:this.onComboChange,bsSize:"small",value:this.props.currentZoomLvl||""},this.getOptions()):l().createElement(p.Form,{inline:!0},l().createElement(p.FormGroup,{bsSize:"small"},l().createElement(p.ControlLabel,null,this.props.label),l().createElement(p.FormControl,{componentClass:"select",onChange:this.onComboChange,value:this.props.currentZoomLvl||""},this.getOptions()))),l().createElement("div",{id:this.props.id,style:this.props.style},e)}}u(m,"propTypes",{id:s().string,style:s().object,scales:s().array,currentZoomLvl:s().number,minZoom:s().number,onChange:s().func,readOnly:s().bool,label:s().oneOfType([s().func,s().string,s().object]),template:s().func,useRawInput:s().bool}),u(m,"defaultProps",{id:"mapstore-scalebox",scales:(0,c.getGoogleMercatorScales)(0,28),currentZoomLvl:0,minZoom:0,onChange(){},readOnly:!1,template:e=>e<1?Math.round(1/e)+" : 1":"1 : "+Math.round(e),useRawInput:!1});const h=m},587929:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AdditionalLayers:()=>Ze,DefaultBackgrounOption:()=>ze,Description:()=>je,Layout:()=>Fe,LegendOptions:()=>Re,MapPreview:()=>Te,Name:()=>we,OutputFormat:()=>Oe,PrintPreview:()=>Ne,PrintSubmit:()=>$e,Projection:()=>ke,Resolution:()=>Le,default:()=>Me,standardItems:()=>Ge});var r=n(171703),o=n(687753),a=n(189260),s=n(234228),i=n(351546),l=n(124852),p=n.n(l),c=n(45697),u=n.n(c),m=n(152543),h=n(719648),g=n(630294),d=n(227361),y=n.n(d);function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}const f=(e,t)=>{let{spec:n,property:r,label:o,placeholder:a,actions:s,onChangeParameter:i,path:c="params.",type:u="text",additionalProperty:m=!0}=e;const d=c+r;return(0,l.useEffect)((()=>{m&&s.addParameter(r,y()(n,d)??"")}),[]),p().createElement(g.FormGroup,null,o&&p().createElement(g.ControlLabel,null,(0,h.S$)(t.messages,o))||null,p().createElement(g.FormControl,b({},function(e){return"textarea"!==e?{type:e}:{componentClass:e}}(u),{value:y()(n,d),placeholder:a&&(0,h.S$)(t.messages,a),onChange:e=>i(d,e.target.value)})))};function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}f.contextTypes={messages:u().object},(0,m.rx)("PrintTextInput",{component:(0,r.connect)((e=>({spec:e?.print?.spec||{}})),{onChangeParameter:a.d$})(f),containers:{Print:{priority:1}}});class C extends p().Component{constructor(){super(...arguments),v(this,"onChange",(()=>{this.props.onChange(!this.refs.input.props.checked)})),v(this,"isEnabled",(()=>this.props.isEnabled?this.props.isEnabled(this.props.layouts):0===this.props.layouts.length||this.props.layouts.some((e=>e.name.match(this.props.enableRegex)))))}render(){return p().createElement(g.Checkbox,{disabled:!this.isEnabled(),ref:"input",checked:this.props.checked,onChange:this.onChange},this.props.label)}}v(C,"propTypes",{layouts:u().array,enableRegex:u().oneOfType([u().object,u().string]),label:u().string,onChange:u().func,checked:u().bool,isEnabled:u().func}),v(C,"defaultProps",{layouts:[],enableRegex:/^.*$/,label:"Option",onChange:()=>{},checked:!1});const P=C,E=(e,t)=>{const{spec:n,property:r,label:o,onChangeParameter:a,enabled:s=!0,actions:i,path:c="params.",additionalProperty:u=!0}=e,g=c+r;return(0,l.useEffect)((()=>{u&&i?.addParameter(r,y()(n,g)??!1)}),[]),(0,m.CU)({},{...e},"{"+s+"}")?p().createElement(P,{checked:!!y()(n,g),label:(0,h.S$)(t.messages,o),onChange:e=>a(g,e)}):null};E.contextTypes={messages:u().object};var S=n(472986),x=n.n(S),w=n(804504);function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j.apply(this,arguments)}const O=e=>{const{text:t,actions:n,action:r,enabled:o,actionConfig:a,loading:s,className:i=""}=e,{glyph:l,buttonConfig:c}=a,u=l?p().createElement(g.Glyphicon,{glyph:l}):p().createElement("span",null),h=!!(0,m.CU)({},{...e},"{"+o+"}");return p().createElement(g.Button,j({className:i,disabled:!h},c,{style:{marginTop:"10px",marginRight:"5px"},onClick:n[r]}),s?p().createElement(x(),{spinnerName:"circle",overrideSpinnerClassName:"spinner",noFadeIn:!0}):u," ",p().createElement(w.Z,{msgId:t}))};function k(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,m.rx)("Action",{component:(0,r.connect)((e=>({spec:e?.print?.spec||{},loading:e.print&&e.print.isLoading||!1})))(O),containers:{Print:{priority:1}}});class F extends p().Component{constructor(){super(...arguments),k(this,"onChange",(e=>{this.props.onChange(e.target.value)}))}render(){const e=this.props.items.map((e=>p().createElement("option",{key:e.value,value:e.value},e.name)));return p().createElement(g.FormGroup,null,this.props.label?p().createElement(g.ControlLabel,null,this.props.label):null,p().createElement(g.FormControl,{ref:"input",value:this.props.selected,componentClass:"select",onChange:this.onChange},e))}}k(F,"propTypes",{items:u().array,label:u().string,onChange:u().func,selected:u().string}),k(F,"defaultProps",{items:[],label:"Choice",onChange:()=>{},selected:""});const R=F;var L=n(840494),T=n(357992);const z=(e,t)=>{let{items:n,spec:r,onChangeParameter:o,defaultFormat:a="pdf",allowedFormats:s,enabled:i=!0}=e;return(0,l.useEffect)((()=>{i&&(0,L.addTransformer)("outputFormat",((e,t)=>Promise.resolve({...t,outputFormat:e.print?.spec?.outputFormat??a})))}),[]),i?p().createElement(p().Fragment,null,p().createElement(R,{selected:r?.outputFormat??a,onChange:e=>o("outputFormat",e),items:(c=n,s?s.filter((e=>c.find((t=>t.value===e.value)))):c),label:(0,h.S$)(t.messages,"print.outputFormat")})):null;var c};z.contextTypes={messages:u().object},(0,m.rx)("PrintOutputFormat",{component:(0,r.connect)((e=>({spec:e?.print?.spec||{},items:e?.print?.capabilities?.outputFormats?.map((e=>({name:e.name,value:e.name})))??[{name:"pdf",value:"pdf"}]})),{onChangeParameter:a.d$})(z),reducers:{print:T.Z},containers:{Print:{priority:1,target:"left-panel",position:3}}});var Z=n(835516);const $=e=>e?.print?.spec?.params?.projection??e?.print?.map?.projection??"EPSG:3857";function N(e,t){const n=$(e),r=(0,L.mapProjectionSelector)(e),o=(0,i.normalizeSRS)(n),a=(0,i.normalizeSRS)(r);if(o!==a){const e=(0,Z.reprojectZoom)(t.scaleZoom,a,o),n=(0,Z.getScales)(o);return{...t,zoom:e,scaleZoom:e,scale:n[e],projection:o}}return t}const G=(e,t)=>{let{projection:n,items:r,onChangeParameter:o,allowPreview:a=!1,projections:s,enabled:c=!0,onRefresh:u=(()=>{})}=e;return(0,l.useEffect)((()=>{c&&(0,L.addValidator)("projection","map-preview",(e=>t=>{const n=$(t),r=(0,L.mapProjectionSelector)(t);return e||(0,i.normalizeSRS)(n)===(0,i.normalizeSRS)(r)?{valid:!0}:{valid:!1,errors:["print.projectionmismatch"]}})(a))}),[a]),(0,l.useEffect)((()=>{c&&(0,L.addMapTransformer)("projection",N)}),[]),c?p().createElement(p().Fragment,null,p().createElement(R,{selected:n,onChange:function(e){o("params.projection",e),u()},items:(m=r,g=s,g?g.filter((e=>m.find((t=>t.value===e.value)))):m),label:(0,h.S$)(t.messages,"print.projection")})):null;var m,g};G.contextTypes={messages:u().object},(0,m.rx)("PrintProjection",{component:(0,r.connect)((e=>({spec:e?.print?.spec||{},map:e?.print?.map,projection:$(e),items:Object.keys((0,i.getAvailableCRS)()).map((e=>({name:e,value:e})))})),{onChangeParameter:a.d$})(G),reducers:{print:T.Z},containers:{Print:{priority:1,target:"left-panel",position:4}}});var M=n(12838),I=n(623560),U=n.n(I);function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_.apply(this,arguments)}function B(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class A extends p().Component{constructor(){super(...arguments),B(this,"getLayoutName",(e=>this.props.layoutNames?U()(this.props.layoutNames)?this.props.layoutNames(e):this.props.layoutNames[e]||e:e)),B(this,"getSheetFormats",(()=>this.props.layouts.reduce(((e,t)=>{const n=t.name.match(this.props.sheetRegex);return n&&n.length>0&&-1===e.indexOf(n[n.length-1])&&e.concat([n[n.length-1]])||e}),[]).map((e=>({name:this.getLayoutName(e),value:e})))))}render(){const{children:e,sheetRegex:t,layouts:n,...r}=this.props;return p().createElement(R,_({},r,{items:this.getSheetFormats()}))}}B(A,"propTypes",{layouts:u().array,sheetRegex:u().oneOfType([u().object,u().string]),label:u().string,onChange:u().func,selected:u().string,layoutNames:u().oneOfType([u().object,u().func])}),B(A,"defaultProps",{layouts:[],sheetRegex:/^[^_]+/,label:"Sheet Size",onChange:()=>{},selected:""});const D=A;function V(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X extends p().Component{constructor(){super(...arguments),V(this,"onChange",(e=>{this.props.onChange(e.target.value)})),V(this,"renderOptions",(()=>this.props.options.map((e=>p().createElement(g.Radio,{key:e.label,disabled:!this.isEnabled(),ref:"input"+e.value,checked:this.props.selected===e.value,onChange:this.onChange,value:e.value},(0,h.S$)(this.context.messages,e.label)))))),V(this,"isEnabled",(()=>this.props.isEnabled?this.props.isEnabled(this.props.layouts):0===this.props.layouts.length||this.props.layouts.some((e=>e.name.match(this.props.enableRegex)))))}render(){return p().createElement("span",{className:"form-inline"},this.renderOptions())}}V(X,"propTypes",{layouts:u().array,enableRegex:u().oneOfType([u().object,u().string]),options:u().array,onChange:u().func,selected:u().string,isEnabled:u().func}),V(X,"contextTypes",{messages:u().object}),V(X,"defaultProps",{layouts:[],enableRegex:/^.*$/,options:[{label:"Option1",value:"Option1"},{label:"Option2",value:"Option2"}],onChange:()=>{},selected:"Option1"});const W=X;var q=n(451603);const H=[{name:"legend",component:(0,r.connect)((e=>({checked:e.print&&e.print.spec&&!!e.print.spec.includeLegend,layouts:(0,q.p6)(e)})),{onChange:a.d$.bind(null,"includeLegend")})(P),regex:/legend/},{name:"2pages",component:(0,r.connect)((e=>({checked:e.print&&e.print.spec.includeLegend&&e.print.spec&&!!e.print.spec.twoPages,layouts:(0,q.p6)(e),isEnabled:()=>(0,q.LI)(e)})),{onChange:a.d$.bind(null,"twoPages")})(P),regex:/2_pages/},{name:"landscape",component:(0,r.connect)((e=>({selected:e.print&&e.print.spec&&e.print.spec.landscape?"landscape":"portrait",layouts:(0,q.p6)(e),options:[{label:"print.alternatives.landscape",value:"landscape"},{label:"print.alternatives.portrait",value:"portrait"}]})),{onChange:(0,M.qC)(a.d$.bind(null,"landscape"),(e=>"landscape"===e))})(W),regex:/landscape/}],J=(e,t)=>{let{layouts:n,spec:r,onChangeParameter:o,alternatives:a}=e;return p().createElement(p().Fragment,null,p().createElement(D,{key:"sheetsize",selected:r?.sheet,onChange:e=>o("sheet",e),layouts:n,label:(0,h.S$)(t.messages,"print.sheetsize")}),function(e,t){return e.map((e=>p().createElement(e.component,{key:"printoption_"+e.name,label:(0,h.S$)(t.messages,"print.alternatives."+e.name),enableRegex:e.regex})))}(a||H,t))};J.contextTypes={messages:u().object};var Q=n(23888),K=n(481330);function Y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ee extends p().Component{constructor(){super(...arguments),Y(this,"onChangeFamily",(e=>{this.props.onChangeFamily(e)})),Y(this,"onChangeSize",(e=>{this.props.onChangeSize(parseInt(e,10))})),Y(this,"toggleBold",(()=>{this.props.onChangeBold(!this.props.bold)})),Y(this,"toggleItalic",(()=>{this.props.onChangeItalic(!this.props.italic)}))}render(){return p().createElement(g.Grid,{fluid:!0},p().createElement(g.Row,null,p().createElement(g.Col,{xs:12},p().createElement("label",{className:"control-label"},this.props.label))),p().createElement(g.Row,null,p().createElement(g.Col,{xs:5},p().createElement(R,{ref:"family",onChange:this.onChangeFamily,label:"",items:this.props.fonts.map((e=>({name:e,value:e}))),selected:this.props.family})),p().createElement(g.Col,{xs:3},p().createElement(K.Z,{ref:"size",type:"number",value:this.props.size,min:0,precision:0,onChange:this.onChangeSize})),p().createElement(g.Col,{xs:2},p().createElement(Q.Z,{bsStyle:"primary",bsSize:"small",active:this.props.bold,onClick:this.toggleBold},p().createElement(g.Glyphicon,{glyph:"bold"}))),p().createElement(g.Col,{xs:2},p().createElement(Q.Z,{bsStyle:"primary",bsSize:"small",active:this.props.italic,onClick:this.toggleItalic},p().createElement(g.Glyphicon,{glyph:"italic"})))))}}Y(ee,"propTypes",{fonts:u().array,label:u().string,onChangeFamily:u().func,onChangeSize:u().func,onChangeBold:u().func,onChangeItalic:u().func,family:u().string,size:u().number,bold:u().bool,italic:u().bool}),Y(ee,"defaultProps",{fonts:["Verdana","Serif","SansSerif","Arial","Courier New","Tahoma","Times New Roman"],label:"Font",onChangeFamily:()=>{},onChangeSize:()=>{},family:"",size:8,bold:!1,italic:!1});const te=ee,ne=(e,t)=>{let{spec:n,onChangeParameter:r,actions:o}=e;return p().createElement(p().Fragment,null,p().createElement(te,{family:n?.fontFamily,size:n?.fontSize,bold:n?.bold,italic:n?.italic,onChangeFamily:e=>r("fontFamily",e),onChangeSize:e=>r("fontSize",e),onChangeBold:e=>r("bold",e),onChangeItalic:e=>r("italic",e),label:(0,h.S$)(t.messages,"print.legend.font")}),p().createElement(P,{label:(0,h.S$)(t.messages,"print.legend.forceLabels"),checked:!!n?.forceLabels,onChange:e=>r("forceLabels",e)}),p().createElement(P,{label:(0,h.S$)(t.messages,"print.legend.antiAliasing"),checked:!!n?.antiAliasing,onChange:e=>r("antiAliasing",e)}),p().createElement(f,{label:(0,h.S$)(t.messages,"print.legend.iconsSize"),spec:n,type:"number",additionalProperty:!1,property:"iconSize",path:"",onChangeParameter:r,actions:o}),p().createElement(f,{label:(0,h.S$)(t.messages,"print.legend.dpi"),spec:n,type:"number",additionalProperty:!1,property:"legendDpi",path:"",onChangeParameter:r,actions:o}))};ne.contextTypes={messages:u().object};const re=(e,t)=>{let{items:n,spec:r,onChangeParameter:o}=e;return p().createElement(p().Fragment,null,p().createElement(R,{selected:r?.resolution,onChange:e=>o("resolution",e),items:n,label:(0,h.S$)(t.messages,"print.resolution")}))};re.contextTypes={messages:u().object};var oe=n(727418),ae=n.n(oe),se=n(645648),ie=n(414293),le=n.n(ie);function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pe.apply(this,arguments)}function ce(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let ue,me,he;class ge extends p().Component{constructor(){super(...arguments),ce(this,"state",{mapTypeLoaded:!1}),ce(this,"getRatio",(()=>this.props.width&&this.props.layoutSize&&this.props.resolutions?(0,L.getResolutionMultiplier)(this.props.layoutSize.width,this.props.width,this.props.printRatio):1)),ce(this,"getResolutions",(()=>this.props.width&&this.props.layoutSize&&this.props.resolutions?this.props.resolutions.map((e=>e*this.getRatio())):this.props.resolutions)),ce(this,"renderLayerContent",((e,t)=>e.features&&"vector"===e.type?e.features.map((n=>p().createElement(he,{crs:t,key:n.id,type:n.type,geometry:n.geometry,features:n.features,msId:n.id,featuresCrs:e.featuresCrs||"EPSG:4326",layerStyle:e.style,style:n.style||e.style||null,properties:n.properties}))):null)),ce(this,"adjustResolution",(e=>{const t=this.getRatio(),n=Math.round(96/t);return ae()({},e,{...!le()(e?.minResolution)&&{minResolution:e.minResolution*t},...!le()(e?.maxResolution)&&{maxResolution:e.maxResolution*t},params:ae()({},e.params,{format_options:"dpi:"+n,"MAP.RESOLUTION":n})})}))}UNSAFE_componentWillMount(){this._isMounted=!0,this.props.onLoadingMapPlugins(!0),Promise.all([n(109789)("./"+this.props.mapType+"/index"),n(188455)("./"+this.props.mapType+"/plugins/index")]).then((e=>{let[t]=e;if(this._isMounted){const e=t.default;ue=e.LMap,me=e.LLayer,he=e.Feature,this.setState({mapTypeLoaded:!0}),this.props.onLoadingMapPlugins(!1,this.props.mapType)}}))}componentWillUnmount(){this._isMounted=!1}render(){if(!this.state.mapTypeLoaded)return null;const e=ae()({},this.props.style,{width:this.props.width+"px",height:this.props.height+"px"}),t=this.getResolutions(),n=t?{view:{resolutions:t}}:{},r=this.props.map&&this.props.map.projection||"EPSG:3857";return this.props.map&&this.props.map.center?p().createElement("div",{className:"print-map-preview"},p().createElement(ue,pe({ref:"mappa"},this.props.map,{resize:this.props.height,style:e,interactive:!1,onMapViewChanges:this.props.onMapViewChanges,zoomControl:!1,zoom:this.props.useFixedScales&&this.props.scales?(0,L.getMapZoom)(this.props.map.scaleZoom,this.props.scales):this.props.map.zoom,center:this.props.map.center,id:"print_preview",registerHooks:!1,mapOptions:n}),this.props.layers.map(((e,t)=>p().createElement(me,{key:e.id||e.name,position:t,type:e.type,srs:r,options:ae()({},this.adjustResolution(e),{srs:r}),env:this.props.env},this.renderLayerContent(e,r))))),this.props.enableScalebox?p().createElement(se.Z,{id:"mappreview-scalebox",currentZoomLvl:this.props.map.scaleZoom,scales:this.props.scales,onChange:this.props.onChangeZoomLevel}):null,this.props.enableRefresh?p().createElement(Q.Z,{bsStyle:"primary",onClick:this.props.onMapRefresh,className:"print-mappreview-refresh"},p().createElement(g.Glyphicon,{glyph:"refresh"})):null):null}}ce(ge,"propTypes",{map:u().object,layers:u().array,style:u().object,scales:u().array,onChangeZoomLevel:u().func,onMapViewChanges:u().func,onMapRefresh:u().func,height:u().number,width:u().number,mapType:u().string,enableRefresh:u().bool,enableScalebox:u().bool,resolutions:u().array,printRatio:u().number,layout:u().string,layoutSize:u().object,useFixedScales:u().bool,env:u().object,onLoadingMapPlugins:u().func}),ce(ge,"defaultProps",{map:null,layers:[],mapType:"leaflet",style:{display:"block",border:"1px solid black",position:"relative"},onChangeZoomLevel:()=>{},onMapViewChanges:()=>{},onMapRefresh:()=>{},width:370,height:270,enableRefresh:!0,enableScalebox:!0,useFixedScales:!1,onLoadingMapPlugins:()=>{}});const de=ge;function ye(){return ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ye.apply(this,arguments)}const be=e=>{let{mapSize:t,layout:n,layoutName:r,resolutions:o,useFixedScales:a,localizedLayerStylesEnv:s,mapPreviewOptions:i,mapType:l,map:c,capabilities:u,onRefresh:m,validation:h={valid:!0},...g}=e;const d=u.scales.slice(0).reverse().map((e=>parseFloat(e.value)))||[];return h.valid?p().createElement(de,ye({},g,{map:c,layers:c?.layers??[],scales:d,width:t.width,height:t.height,mapType:l,onMapRefresh:m,layout:r,layoutSize:n&&n.map||{width:10,height:10},resolutions:o,useFixedScales:a,env:s},i)):p().createElement("div",{id:"map-preview-disabled-message"},p().createElement(w.Z,{msgId:"print.disabledpreview"}))};be.contextTypes={messages:u().object};var fe=n(466756);function ve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ce extends p().Component{constructor(){super(...arguments),ve(this,"onDocumentComplete",(e=>{this.props.setPages(e&&e.numPages||0)})),ve(this,"firstPage",(()=>{this.props.currentPage>0&&this.props.setPage(0)})),ve(this,"lastPage",(()=>{this.props.currentPage<this.props.pages-1&&this.props.setPage(this.props.pages-1)})),ve(this,"prevPage",(()=>{this.props.currentPage>0&&this.props.setPage(this.props.currentPage-1)})),ve(this,"nextPage",(()=>{this.props.currentPage<this.props.pages-1&&this.props.setPage(this.props.currentPage+1)})),ve(this,"zoomIn",(()=>{this.props.setScale(this.props.scale*this.props.zoomFactor)})),ve(this,"zoomOut",(()=>{this.props.setScale(this.props.scale/this.props.zoomFactor)}))}render(){return p().createElement("div",{id:"mapstore-print-preview-panel"},p().createElement("div",{style:this.props.style},p().createElement(fe.BB,{file:this.props.url,onLoadSuccess:this.onDocumentComplete},p().createElement(fe.T3,{pageNumber:this.props.currentPage+1,scale:this.props.scale}))),p().createElement("div",{style:{marginTop:"10px"}},p().createElement(Q.Z,{bsStyle:this.props.buttonStyle,style:{marginRight:"10px"},onClick:this.props.back},p().createElement(g.Glyphicon,{glyph:"arrow-left"})),p().createElement(Q.Z,{bsStyle:this.props.buttonStyle,disabled:this.props.scale>=this.props.maxScale,onClick:this.zoomIn},p().createElement(g.Glyphicon,{glyph:"zoom-in"})),p().createElement(Q.Z,{bsStyle:this.props.buttonStyle,disabled:this.props.scale<=this.props.minScale,onClick:this.zoomOut},p().createElement(g.Glyphicon,{glyph:"zoom-out"})),p().createElement("label",{style:{marginLeft:"10px",marginRight:"10px"}},this.props.scale,"x"),p().createElement("div",{className:"print-download btn btn-"+this.props.buttonStyle},p().createElement("a",{href:this.props.downloadUrl,target:"_blank"},p().createElement(g.Glyphicon,{glyph:"save"}))),p().createElement(Q.Z,{bsStyle:this.props.buttonStyle,disabled:0===this.props.currentPage,onClick:this.firstPage},p().createElement(g.Glyphicon,{glyph:"step-backward"})),p().createElement(Q.Z,{bsStyle:this.props.buttonStyle,disabled:0===this.props.currentPage,onClick:this.prevPage},p().createElement(g.Glyphicon,{glyph:"chevron-left"})),p().createElement("label",{style:{marginLeft:"10px",marginRight:"10px"}},this.props.currentPage+1," / ",this.props.pages),p().createElement(Q.Z,{bsStyle:this.props.buttonStyle,disabled:this.props.currentPage===this.props.pages-1,onClick:this.nextPage},p().createElement(g.Glyphicon,{glyph:"chevron-right"})),p().createElement(Q.Z,{bsStyle:this.props.buttonStyle,disabled:this.props.currentPage===this.props.pages-1,onClick:this.lastPage},p().createElement(g.Glyphicon,{glyph:"step-forward"}))))}}ve(Ce,"propTypes",{url:u().string,downloadUrl:u().string,scale:u().number,currentPage:u().number,pages:u().number,zoomFactor:u().number,minScale:u().number,maxScale:u().number,back:u().func,setScale:u().func,setPage:u().func,setPages:u().func,style:u().object,buttonStyle:u().string}),ve(Ce,"defaultProps",{url:null,downloadUrl:null,scale:1,minScale:.25,maxScale:8,currentPage:0,pages:1,zoomFactor:2,back:()=>{},setScale:()=>{},setPage:()=>{},setPages:()=>{},style:{height:"500px",width:"800px",overflow:"auto",backgroundColor:"#888",padding:"10px"},buttonStyle:"default"});const Pe=Ce;function Ee(){return Ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ee.apply(this,arguments)}const Se=["png","jpg","bmp","gif","jpeg"],xe=e=>{let{downloadUrl:t,format:n,buttonStyle:r,back:o,maxPreviewZoom:a=5,supportedFormats:s=Se}=e;const[i,c]=(0,l.useState)(1),u=-1!==s.indexOf(n);return p().createElement("div",{id:"mapstore-image-print-preview-panel"},u?p().createElement("div",{className:"mapstore-print-preview-img-wrapper"},p().createElement("img",{src:t,style:{transform:`scale(${i})`,transformOrigin:"top left"}})):p().createElement(w.Z,{msgId:"print.previewFormatUnsupported"}),p().createElement("div",{style:{marginTop:"10px"}},p().createElement(g.Button,{bsStyle:r,style:{marginRight:"10px"},onClick:o},p().createElement(g.Glyphicon,{glyph:"arrow-left"})),p().createElement(g.Button,{bsStyle:r,disabled:!u||i>=a,onClick:()=>{c((e=>e+1))}},p().createElement(g.Glyphicon,{glyph:"zoom-in"})),p().createElement(g.Button,{bsStyle:r,disabled:!u||i<=1,onClick:()=>{c((e=>e-1))}},p().createElement(g.Glyphicon,{glyph:"zoom-out"})),p().createElement("label",{style:{marginLeft:"10px",marginRight:"10px"}},i,"x"),p().createElement("div",{className:"print-download btn btn-"+r},p().createElement("a",{href:t,target:"_blank"},p().createElement(g.Glyphicon,{glyph:"save"})))))},we=(0,r.connect)((e=>({spec:e.print?.spec||{},additionalProperty:!1,property:"name",path:"",type:"text",label:"print.title",placeholder:"print.titleplaceholder"})),{onChangeParameter:a.d$})(f),je=(0,r.connect)((e=>({spec:e.print?.spec||{},additionalProperty:!1,property:"description",path:"",type:"textarea",label:"print.description",placeholder:"print.descriptionplaceholder"})),{onChangeParameter:a.d$})(f),Oe=(0,r.connect)((e=>({spec:e?.print?.spec||{},items:e?.print?.capabilities?.outputFormats?.map((e=>({name:e.name,value:e.name})))??[{name:"PDF",value:"pdf"}]})),{onChangeParameter:a.d$})(z),ke=(0,r.connect)((e=>({spec:e?.print?.spec||{},map:e?.print?.map,projection:$(e),items:Object.keys((0,i.getAvailableCRS)()).map((e=>({name:e,value:e})))})),{onChangeParameter:a.d$})(G),Fe=(0,r.connect)((e=>({spec:e.print?.spec||{},layouts:e?.print?.capabilities?.layouts||[]})),{onChangeParameter:a.d$})(J),Re=(0,r.connect)((e=>({spec:e.print?.spec||{}})),{onChangeParameter:a.d$})(ne),Le=(0,r.connect)((e=>({spec:e.print?.spec||{},items:e?.print?.capabilities?.dpis?.map((e=>({name:e.name+" dpi",value:e.value})))??[]})),{onChangeParameter:a.d$})(re),Te=(0,r.connect)((e=>({capabilities:e.print?.capabilities??{}})),{onChangeZoomLevel:a.pQ,onMapViewChanges:a.z})(be),ze=(0,r.connect)((e=>({spec:e?.print?.spec||{},enabled:"context.notAllowedLayers",path:"",property:"defaultBackground",additionalProperty:!1,label:"print.defaultBackground"})),{onChangeParameter:a.d$})(E),Ze=(0,r.connect)((e=>({spec:e.print?.spec||{},path:"",property:"additionalLayers",additionalProperty:!1,label:"print.additionalLayers"})),{onChangeParameter:a.d$})(E),$e=(0,r.connect)((e=>({spec:e?.print?.spec||{},loading:e.print&&e.print.isLoading||!1,text:"print.submit",action:"print",enabled:"context.layout",className:"print-submit"})))(O),Ne=(0,r.connect)((e=>({url:e.print&&s.ZP.getProxiedUrl(e.print.pdfUrl),downloadUrl:e.print&&e.print.pdfUrl,scale:e.controls&&e.controls.print&&e.controls.print.viewScale||.5,currentPage:e.controls&&e.controls.print&&e.controls.print.currentPage||0,pages:e.controls&&e.controls.print&&e.controls.print.pages||1,additionalLayers:e.print?.spec?.additionalLayers??!1,outputFormat:e.print?.spec?.outputFormat||"pdf"})),{back:a._4,setPage:o.Xg.bind(null,"print","currentPage"),setPages:o.Xg.bind(null,"print","pages"),setScale:o.Xg.bind(null,"print","viewScale")})((e=>{let{outputFormat:t,...n}=e;return"pdf"===t?p().createElement(Pe,n):p().createElement(xe,Ee({format:t},n))})),Ge={"left-panel":[{id:"name",plugin:we,cfg:{},position:1},{id:"description",plugin:je,cfg:{},position:2},{id:"outputFormat",plugin:Oe,cfg:{allowedFormats:[{name:"PDF",value:"pdf"},{name:"PNG",value:"png"},{name:"JPEG",value:"jpg"}]},position:3},{id:"projection",plugin:ke,cfg:{allowPreview:!0,projections:[{name:"EPSG:3857",value:"EPSG:3857"},{name:"EPSG:4326",value:"EPSG:4326"}]},position:4},{id:"overlayLayers",plugin:Ze,cfg:{enabled:!1},position:5}],"left-panel-accordion":[{id:"layout",plugin:Fe,cfg:{title:"print.layout"},position:1},{id:"legend-options",plugin:Re,cfg:{title:"print.legendoptions"},position:2}],"right-panel":[{id:"resolution",plugin:Le,cfg:{},position:1},{id:"map-preview",plugin:Te,cfg:{},position:2},{id:"default-background-ignore",plugin:ze,cfg:{},position:3}],buttons:[{id:"submit",plugin:$e,cfg:{},position:1}],"preview-panel":[{id:"printpreview",plugin:Ne,cfg:{},position:1}]},Me={standardItems:Ge}},109789:(e,t,n)=>{var r={"./cesium/plugins/index":[570531,9,6212,949,854,531],"./leaflet/index":[784887,9,5243,2201,5831,320,3436,4489],"./leaflet/plugins/index":[72183,7,5243,1263,2183],"./openlayers/index":[918141,9,1704,8471,8256,1260,6624,467],"./openlayers/plugins/index":[532454,9,5604,5986,2454,2784],"./popups/index":[492619,9]};function o(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return Promise.all(t.slice(2).map(n.e)).then((()=>n.t(o,16|t[1])))}o.keys=()=>Object.keys(r),o.id=109789,e.exports=o},188455:(e,t,n)=>{var r={"./cesium/plugins/index":[570531,9,6212,949,5792,531,5578],"./leaflet/plugins/index":[72183,7,5243,1263,2183],"./openlayers/plugins/index":[532454,9,317,5604,5986,302,9141,2454,3715,8728]};function o(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return Promise.all(t.slice(2).map(n.e)).then((()=>n.t(o,16|t[1])))}o.keys=()=>Object.keys(r),o.id=188455,e.exports=o},558618:()=>{},200120:()=>{},945804:()=>{}}]);