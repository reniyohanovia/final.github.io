(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[962],{420544:(e,t,o)=>{"use strict";o.d(t,{Cv:()=>r,RD:()=>n,NR:()=>a,mV:()=>l,N3:()=>s,dR:()=>i,sS:()=>c,sm:()=>m});const r="SET_SEARCH_BOOKMARK_CONFIG",n="RESET_BOOKMARK_CONFIG",a="UPDATE_BOOKMARK",l="FILTER_BOOKMARKS";function s(e,t){return{type:r,property:e,value:t}}function i(){return{type:n}}function c(e){return{type:a,bookmark:e,idx:arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1}}function m(e){return{type:l,filter:e}}},102187:(e,t,o)=>{"use strict";o.d(t,{Z:()=>d});var r=o(45697),n=o.n(r),a=o(124852),l=o.n(a),s=o(294184),i=o.n(s);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},c.apply(this,arguments)}function m(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class b extends l().Component{constructor(){super(...arguments),m(this,"state",{is:"active"}),m(this,"onClick",(()=>this.props.onClick?this.props.onClick.bind(this):()=>{})),m(this,"onDisable",(()=>this.props.onDisable?this.props.onDisable.bind(this):()=>{})),m(this,"onConfirm",(()=>this.props.onConfirm?this.props.onConfirm():this.props.confirming&&this.props.confirming.onClick?this.props.confirming.onClick():()=>{})),m(this,"isDisabled",(()=>"disabled"===this.state.is)),m(this,"isConfirming",(()=>"confirming"===this.state.is)),m(this,"isActive",(()=>!this.isConfirming()&&!this.isDisabled())),m(this,"handleClick",(()=>this.isConfirming()&&this.props.disableAfterConfirmed?(this.onConfirm(),this.onDisable(),void this.setState({is:"disabled"})):this.isConfirming()?(this.onConfirm(),void this.setState({is:"active"})):(this.onClick(),void this.setState({is:"confirming"})))),m(this,"handleBlur",(()=>{this.setState({is:"active"})}))}render(){const{children:e,buttonProps:t,confirming:o,disabled:r}=this.props;let{text:n,style:a,className:s="btn btn-sm btn-danger"}=this.props;const m=this.isDisabled(),b=this.isConfirming();return m&&(n=r&&r.text||"Loading...",s=r&&r.className||"btn btn-sm btn-secondary",a=r&&r.style||{}),b&&(n=o&&o.text||"Confirm?",s=o&&o.className||"btn btn-sm btn-warning",a=o&&o.style||{}),l().createElement("button",c({className:i()("confirm-button",s),style:a,onClick:this.handleClick,onBlur:this.handleBlur,disabled:m},t),e,e?" ":"",n)}}m(b,"propTypes",{disableAfterConfirmed:n().bool,resetOnBlur:n().bool,onConfirm:n().func,onDisable:n().func,onClick:n().func,text:n().oneOfType([n().string,n().node]),className:n().string,style:n().object,confirming:n().shape({text:n().oneOfType([n().string,n().node]),className:n().string,style:n().object,onClick:n().func}),disabled:n().shape({text:n().oneOfType([n().string,n().node]),className:n().string,style:n().object}),children:n().node,buttonProps:n().object}),m(b,"defaultProps",{resetOnBlur:!0});const d=b},687694:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>z});var r=o(124852),n=o.n(r),a=o(171703),l=o(22222),s=o(630294),i=o(227361),c=o.n(i),m=o(414293),b=o.n(m),d=o(152543),h=o(351546),p=o(102187),k=o(590504),u=o(23888),g=o(488400),f=o(45697),y=o.n(f),E=o(603754),C=o(804504),v=o(222777),x=o(486234),S=o(8204);const _=(0,x.Z)("filterPlaceholder")(E.Z),w=e=>{const{filter:t="",onFilter:o,onPropertyChange:r,bookmarks:a=[]}=e,l=(e,t)=>{r("bookmark",e),r("editIdx",t),r("page",1)};return n().createElement(s.Grid,{fluid:!0,id:"bookmark-list",className:"ms-header",style:{width:"100%",boxShadow:"none"}},n().createElement(s.Row,null,n().createElement(s.Col,{xs:12,style:{padding:0}},n().createElement(_,{filterPlaceholder:"search.bookmarkFilter",filterText:t,onFilter:o}))),n().createElement(s.Row,{className:"bookmark-card"},0===a.length?n().createElement("div",{className:"search-bookmark-name"},n().createElement(C.Z,{msgId:"search.bookmarkslistempty"})):a.map(((e,o)=>{return(i=e.title)&&-1!==i.toLowerCase().indexOf(t.toLowerCase())?n().createElement(v.Z,{key:`bookmark-card-${o}`,preview:n().createElement(s.Glyphicon,{glyph:"bookmark"}),title:n().createElement("span",{onClick:()=>l(e,o),style:{margin:"6px 0px"}},e&&e.title),size:"sm",tools:n().createElement(S.Z,{btnDefaultProps:{className:"square-button-md no-border"},btnGroupProps:{style:{margin:10}},buttons:[{glyph:"pencil",tooltipId:"search.editBookmark",onClick:()=>l(e,o)},{glyph:"trash",tooltipId:"search.deleteBookmark",onClick:()=>(e=>{const t=a.filter(((t,o)=>o!==e));r("bookmarkSearchConfig",{bookmarks:t})})(o)}]})}):null;var i}))))};w.propTypes={filter:y().string,onFilter:y().func.isRequired,onPropertyChange:y().func.isRequired,bookmarks:y().array.isRequired};const I={Element:w,validate:!0};var Z=o(694174),N=o.n(Z),O=o(481330);const B=(0,x.Z)("placeholder")(s.FormControl),P=(0,x.Z)("placeholder")(O.Z),R=e=>{const{onPropertyChange:t,bookmark:o={},bbox:r}=e,{options:a={},title:l,layerVisibilityReload:i=!1}=o,c=(e,r)=>{const n={...o.options,[r]:parseFloat(e)};t("bookmark",{...o,options:n})},m=e=>{t("bookmark",{...o,title:e})},b=e=>a[e]?["north","south"].includes(e)?a[e]&&!N()(a[e],-90,91)?"error":null:a[e]&&!N()(a[e],-180,181)?"error":null:null;return n().createElement("div",{id:"add-new-bookmark"},n().createElement(s.Col,null,n().createElement(s.FormGroup,{validationState:b("title")},n().createElement(s.ControlLabel,null,n().createElement(C.Z,{msgId:"search.b_title"})),n().createElement(B,{className:"bookmark-title",value:l,name:"title",type:"text",placeholder:"search.b_title",onChange:e=>{let{target:t}=e;return m(t.value)},onBlur:e=>{let{target:t}=e;return m(t.value.trim())}}))),n().createElement(s.Col,null,n().createElement(s.FormGroup,{style:{display:"flex",justifyContent:"space-between"}},n().createElement(s.ControlLabel,null,n().createElement(C.Z,{msgId:"search.b_bbox"})),n().createElement("div",{id:"bookmark-tools"},n().createElement(s.OverlayTrigger,{key:"toggleLayer",placement:"top",overlay:n().createElement(s.Tooltip,{id:"search-bookmark-layer"},n().createElement(C.Z,{msgId:"search.b_layer_tooltip"}))},n().createElement(u.Z,{key:"toggleLayer",bsStyle:"primary",className:"square-button-md btn btn-default no-border",onClick:()=>{t("bookmark",{...o,layerVisibilityReload:!i})}},n().createElement(s.Glyphicon,{glyph:i?"eye-open":"eye-close"}))),n().createElement(s.OverlayTrigger,{key:"getBBox",placement:"top",overlay:n().createElement(s.Tooltip,{id:"search-bookmark-bbox"},n().createElement(C.Z,{msgId:"search.b_bbox_tooltip"}))},n().createElement(u.Z,{key:"getBBox",bsStyle:"primary",className:"square-button-md btn btn-default no-border",onClick:()=>{const[e,n,a,l]=r,s={west:parseFloat(e)||0,south:parseFloat(n)||0,east:parseFloat(a)||0,north:parseFloat(l)||0},i={...o.options,...s};t("bookmark",{...o,options:i})}},n().createElement(s.Glyphicon,{glyph:"fit-cover"})))))),n().createElement("div",{className:"bbox-field-group"},n().createElement("div",{className:"field-top-bottom"},n().createElement(s.FormGroup,{validationState:b("north")},n().createElement(s.ControlLabel,null,n().createElement(C.Z,{msgId:"search.b_bbox_north"})),n().createElement(P,{placeholder:"search.b_bbox_north_placeholder",min:-90,max:90,name:"north",type:"number",onChange:e=>c(e,"north"),value:a.north}))),n().createElement("div",{className:"field-center-group"},n().createElement("div",{className:"field-left-right"},n().createElement(s.FormGroup,{validationState:b("west")},n().createElement(s.ControlLabel,null,n().createElement(C.Z,{msgId:"search.b_bbox_west"})),n().createElement(P,{placeholder:"search.b_bbox_west_placeholder",min:-180,max:180,name:"west",type:"number",onChange:e=>c(e,"west"),value:a.west}))),n().createElement("div",{className:"field-left-right"},n().createElement(s.FormGroup,{validationState:b("east")},n().createElement(s.ControlLabel,null,n().createElement(C.Z,{msgId:"search.b_bbox_east"})),n().createElement(P,{placeholder:"search.b_bbox_east_placeholder",min:-180,max:180,name:"east",type:"number",onChange:e=>c(e,"east"),value:a.east})))),n().createElement("div",{className:"field-top-bottom"},n().createElement(s.FormGroup,{validationState:b("south")},n().createElement(s.ControlLabel,null,n().createElement(C.Z,{msgId:"search.b_bbox_south"})),n().createElement(P,{placeholder:"search.b_bbox_south_placeholder",min:-90,max:90,name:"south",type:"number",onChange:e=>c(e,"south"),value:a.south})))))};R.propTypes={onPropertyChange:y().func,bookmark:y().object,bbox:y().array};const F={Element:R,validate:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={},title:o=""}=e,{south:r,north:n,west:a,east:l}=t,s=N()(r,-90,91)&&N()(n,-90,91),i=N()(a,-180,181)&&N()(l,-180,181),c=!!o.trim().length;return i&&s&&c}};var T=o(687753),j=o(596974),D=o(420544),G=o(926854),L=o(274363),A=o(510644);function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},q.apply(this,arguments)}const K=(e,t,o,r)=>{let{canEdit:n,id:a}=o;const l=t&&(n||b()(a));return"ALL"===e||"EDIT"===e&&l||"ADMIN"===e&&r},M=(0,a.connect)((0,l.P1)([e=>e?.search?.activeSearchTool||null,e=>e?.searchbookmarkconfig||{}],((e,t)=>({active:"bookmarkSearch"===e,show:t?.allowUser||!!c()(t,"bookmarkSearchConfig.bookmarks",[]).length}))),{onClick:j.a})((e=>{let{show:t,onClick:o,active:r}=e;return t?n().createElement(s.MenuItem,{active:r,onClick:()=>{o("bookmarkSearch"),document.dispatchEvent(new MouseEvent("click"))}},n().createElement(s.Glyphicon,{glyph:"bookmark"})," ",n().createElement(g.Z,{msgId:"search.searchByBookmark"})):null})),V=(0,l.P1)([L.Od,e=>e.controls||{},e=>e.searchbookmarkconfig||{},A.jl,A.qg,L._H],(function(e,t,o,r,n){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return{bbox:e&&e.bbox&&(0,h.getExtentFromViewport)(e.bbox),enabled:t.searchBookmarkConfig&&t.searchBookmarkConfig.enabled||!1,pages:[I,F],page:o&&o.page||0,bookmark:o&&o.bookmark,bookmarkSearchConfig:o&&o.bookmarkSearchConfig,editIdx:o&&o.editIdx,filter:o&&o.filter,allowUser:K(c()(o,"bookmarkEditing"),r,a,n)}})),U=(0,a.connect)(V,{toggleControl:T.Xi,onPropertyChange:D.N3,resetBookmarkConfig:D.dR,updateBookmark:D.sS,onFilter:D.sm})((e=>{const{enabled:t,pages:o,page:a,onPropertyChange:l,bookmark:i,bookmarkSearchConfig:c={},editIdx:m,zoomOnSelect:b=!0,bookmarkEditing:d="EDIT",allowUser:h}=e;(0,r.useEffect)((()=>{l("zoomOnSelect",b),l("bookmarkEditing",d)}),[l]),(0,r.useEffect)((()=>{l("allowUser",h)}),[h]);const f=()=>{a>1?l("page",a-1):1===a&&e.resetBookmarkConfig()},y=()=>o[a].validate(i),E=o&&o[a]||null;return t?n().createElement(k.Z,{id:"bookmark-panel-dialog",draggable:!0,modal:!1},n().createElement("span",{role:"header",style:{display:"flex",justifyContent:"space-between"}},n().createElement("span",null,(()=>{const e=0===a?"search.b_listpaneltitle":"search.b_newpaneltitle";return n().createElement(g.Z,{msgId:e})})()),0===a&&n().createElement("button",{onClick:()=>{e.toggleControl("searchBookmarkConfig"),e.resetBookmarkConfig()},className:"close"}," ",n().createElement(s.Glyphicon,{glyph:"1-close"}))),n().createElement("div",{role:"body",className:"services-config-editor"},n().createElement(E.Element,q({bookmarks:c.bookmarks,onPropertyChange:l,bookmark:i},e))),0===a?n().createElement("span",{role:"footer"},n().createElement(u.Z,{onClick:()=>{l("bookmark",{}),l("page",1)},bsStyle:"primary"},n().createElement(g.Z,{msgId:"search.addbtn"}))):a===o.length-1?n().createElement("span",{role:"footer"},n().createElement(u.Z,{onClick:f,bsStyle:"primary"},n().createElement(g.Z,{msgId:"search.prevbtn"})),n().createElement(u.Z,{disabled:!y(),onClick:()=>{const{layerVisibilityReload:t=!1}=i;e.updateBookmark({...i,layerVisibilityReload:t},m)},bsStyle:"success"},n().createElement(g.Z,{msgId:"search.savebtn"}))):n().createElement("span",{role:"footer"},1===a?n().createElement(p.Z,{onConfirm:f,bsStyle:"primary",confirming:{text:n().createElement(g.Z,{msgId:"search.cancelconfirm"})},text:n().createElement(g.Z,{msgId:"search.cancelbtn"})}):n().createElement(u.Z,{onClick:f,bsStyle:"primary"},n().createElement(g.Z,{msgId:1===a?"search.cancelbtn":"search.prevbtn"})),n().createElement(u.Z,{disabled:!y(),onClick:()=>{a<o.length-1&&l("page",a+1)},bsStyle:"primary"},n().createElement(g.Z,{msgId:"search.nextbtn"})))):null})),z=(0,d.rx)("SearchByBookmark",{component:U,containers:{Search:{menuItem:M,bookmarkConfig:(e,t,o)=>({onClick:()=>{t||e("searchBookmarkConfig")},glyph:"cog",className:"square-button-md no-border ",tooltipId:"search.bookmarksettings",tooltipPosition:"bottom",bsStyle:"default",pullRight:!0,visible:"bookmarkSearch"===o})}},reducers:{searchbookmarkconfig:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D.Cv:return{...e,[t.property]:t.value};case G.ok:{const o=t.config.map.bookmark_search_config||{};return{...e,bookmarkSearchConfig:o}}case T.l:case D.RD:return{...e,bookmark:void 0,page:0,editIdx:void 0};case D.NR:{let o=(e.bookmarkSearchConfig&&e.bookmarkSearchConfig.bookmarks||[]).slice();const r={...t.bookmark};return-1!==t.idx?o[t.idx]=r:o.push(r),{...e,bookmark:void 0,page:0,editIdx:void 0,bookmarkSearchConfig:{...e.bookmarkSearchConfig,bookmarks:o}}}case D.mV:return{...e,filter:t.filter};default:return e}}}})}}]);