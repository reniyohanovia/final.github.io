(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[6949],{69371:(e,t,n)=>{"use strict";n.d(t,{qx:()=>s,Lv:()=>o,iv:()=>r,br:()=>i,Xe:()=>l,_V:()=>a,JU:()=>p,cb:()=>c,lz:()=>d,Wb:()=>u,M5:()=>g,w:()=>h,p:()=>E,Ud:()=>y,vf:()=>m,AE:()=>f,xp:()=>b,i9:()=>T,HM:()=>I,y3:()=>v,cO:()=>w,aA:()=>P,Nb:()=>N,kq:()=>S,PQ:()=>L,KI:()=>O,m7:()=>M,Hz:()=>_,w2:()=>A,Z7:()=>C,_e:()=>x,FE:()=>k,st:()=>G,Qq:()=>W,bz:()=>R,mF:()=>D});const s="TIMELINE:SELECT_TIME",o="TIMELINE:RANGE_CHANGE",r="TIMELINE:RANGE_DATA_LOADED",i="TIMELINE:LOADING",l="TIMELINE:INIT_SELECT_LAYER",a="TIMELINE:SELECT_LAYER",p="TIMELINE:ENABLE_OFFSET",c="TIMELINE:AUTOSELECT",d="TIMELINE:SET_SNAP_TYPE",u="TIMELINE:SET_END_VALUES_SUPPORT",g="TIMELINE:SET_COLLAPSED",h="TIMELINE:SET_MAP_SYNC",E="TIMELINE:INIT_TIMELINE",y="TIMELINE:RESET_TIMELINE",m="TIMELINE:SET_RANGE_INIT",f="TIMELINE:SNAP_RADIO_BUTTON_ENABLED",b="TIMELINE:SET_LAYERS",T="TIMELINE:UPDATE_LAYERS_SETTINGS",I=(e,t,n,o)=>({type:s,time:e,group:t,what:n,item:o}),v=function(){let{start:e,end:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:o,start:e,end:t}},w=(e,t,n,s)=>({type:r,layerId:e,range:t,histogram:n,domain:s}),P=(e,t)=>({type:i,layerId:e,loading:t}),N=function(e){return{type:l,layerId:e,snap:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]}},S=function(e){return{type:a,layerId:e,snap:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]}},L=e=>({type:p,enabled:e}),O=()=>({type:c}),M=e=>({type:d,snapType:e}),_=e=>({type:u,endValuesSupport:e}),A=e=>({type:g,collapsed:e}),C=e=>({type:h,mapSync:e}),x=e=>({type:E,config:e}),k=()=>({type:y}),G=e=>({type:m,value:e}),W=e=>({type:f,snapRadioButtonEnabled:e}),R=e=>({type:b,layers:e}),D=(e,t)=>({type:T,id:e,checked:t})},811256:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Q});var s=n(124852),o=n.n(s),r=n(45697),i=n.n(r),l=n(171703),a=n(867076),p=n(22222),c=n(36549),d=n(630294),u=n(952273),g=n(492838),h=n(313311),E=n.n(h),y=n(630998),m=n.n(y),f=n(189734),b=n.n(f);const T=e=>!e.dataGrid||!e.dataGrid.static,I=(0,p.P1)(u.zm,u.YR,u.yZ,u.lF,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return b()(e.filter(T).map((e=>m()(t,(t=>t===e.id))>=0?{...e,collapsed:!0}:e)),(e=>{const t=s[e.id]&&s[e.id].layout,o=E()(n,{i:e.id})||t||{},{x:r=0,y:i=0}=o;return 100*i+r}))}));var v=n(725211);const w=(0,a.compose)((0,a.defaultProps)({toolsOptions:{seeHidden:"user.role===ADMIN"}}),(0,v.Z)("toolsOptions",{asObject:!0}),(0,a.withProps)((e=>{let{widgets:t,toolsOptions:n={seeHidden:!1}}=e;return{widgets:n.seeHidden?t:t.filter((e=>!e.hide))}})));var P=n(756435),N=n(8204);const S=function(){let{widgetType:e,charts:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e;if(!e||"chart"===e){const[{type:e}={}]=t;n=e}switch(n){case"text":return"sheet";case"table":return"features-grid";case"pie":return"pie-chart";case"line":return"1-line";case"map":return"1-map";case"counter":return"counter";default:return"stats"}},L=(0,a.compose)((0,a.withPropsOnChange)(["btnGroupProps"],(e=>{let{btnGroupProps:t}=e;return{btnGroupProps:{...t,className:"widgets-bar"+(t&&t.className?` ${t.className}`:"")}}})),(0,a.withPropsOnChange)(["widgets","onClick"],(e=>{let{widgets:t=[],onClick:n=(()=>{})}=e;return{buttons:t.map((e=>({glyph:S(e),tooltip:e.title,className:e.collapsed?"btn-tray":"btn-tray active",onClick:()=>n(e)})))}})))(N.Z),O=(0,a.compose)((0,l.connect)((0,p.P1)(I,(e=>({widgets:e}))),{onClick:g.f}),(0,a.defaultProps)({btnGroupProps:{className:"widgets-toolbar",style:{marginLeft:2,marginRight:2}}}),w,(0,a.withProps)((e=>{let{btnGroupProps:t={},btnDefaultProps:n={}}=e;return{btnGroupProps:{bsSize:"xsmall",...t},btnDefaultProps:{bsSize:"xsmall",...n||{}}}})))(L);var M=n(23888),_=n(350126),A=n(496259);function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},C.apply(this,arguments)}function x(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const k=(0,c.Z)(M.Z),G=function(){let{expanded:e,onClick:t=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(k,{tooltipId:e?"widgets.tray.collapseTray":"widgets.tray.expandTray",bsSize:"xsmall",bsStyle:"default",style:{borderColor:"transparent"},onClick:t},o().createElement(d.Glyphicon,{glyph:e?"chevron-right":"chevron-left"}))},W=(0,a.compose)((0,l.connect)((0,p.P1)(u.E5,(function(){return{widgets:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}})),{onClick:()=>(0,g.Ff)()}),w,(0,a.withProps)((e=>{let{widgets:t=[]}=e;return{shouldExpand:0===t.length}})))((function(){let{onClick:e=(()=>{}),shouldExpand:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(k,{tooltipId:t?"widgets.tray.expandAll":"widgets.tray.collapseAll",bsStyle:t?"primary":"success active",bsSize:"xsmall",onClick:e},o().createElement(d.Glyphicon,{glyph:"list"}))}));class R extends o().Component{render(){return this.props.enabled?o().createElement("div",{className:"widgets-tray",style:{marginBottom:32,marginRight:(this.props.layout?.right??0)+65,bottom:0,right:0,position:"absolute"}},o().createElement(P.Z,{columns:[...this.props.isSingleWidgetLayout?[]:[o().createElement(G,{key:"collapse-tray",toolsOptions:this.props.toolsOptions,expanded:this.props.expanded,onClick:()=>this.props.setExpanded(!this.props.expanded)})],o().createElement(W,{key:"collapse-all",toolsOptions:this.props.toolsOptions}),...this.props.items.map((e=>e.tool))||[]]},this.props.expanded&&!this.props.isSingleWidgetLayout?o().createElement(O,{toolsOptions:this.props.toolsOptions}):null)):null}}x(R,"propTypes",{enabled:i().bool,toolsOptions:i().object,items:i().array,expanded:i().bool,setExpanded:i().func,layout:i().object,isSingleWidgetLayout:i().bool}),x(R,"defaultProps",{enabled:!0,items:[],expanded:!1,setExpanded:()=>{},layout:{}});const D=(0,a.compose)((e=>t=>o().createElement(A.Z,{handleWidth:!0},(function(){let{width:n,height:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(e,C({},t,{width:n,height:s}))}))),(0,a.withState)("expanded","setExpanded",!1),(0,l.connect)((0,p.P1)(I,(e=>e.browser&&e.browser.mobile),(e=>(0,_.ic)(e,{right:!0})),(function(e,t){return{widgets:e,layout:arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],isMobileAgent:t}})),{toggleTray:g.ep}),w,(0,a.withProps)((e=>{let{widgets:t=[]}=e;return{hasCollapsedWidgets:t.filter((function(){let{collapsed:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).length>0,hasTrayWidgets:t.length>0}})),(0,a.withProps)((e=>{let{isMobileAgent:t,width:n,singleWidgetLayoutBreakpoint:s=1024}=e;return{isSingleWidgetLayout:t||n<=s}})),(0,a.lifecycle)({componentDidMount(){this.props.toggleTray&&this.props.toggleTray(!0)},componentWillUnmount(){this.props.toggleTray&&this.props.toggleTray(!1)}}),(0,a.mapPropsStream)((e=>e.merge(e.distinctUntilKeyChanged("hasCollapsedWidgets").do((e=>{let{setExpanded:t=(()=>{}),hasCollapsedWidgets:n}=e;return t(n)})).ignoreElements()))),(0,a.withProps)((e=>{let{enabled:t,hasTrayWidgets:n}=e;return{enabled:t&&n}})))(R);var F=n(748928),U=n(49977),Z=n.n(U),j=n(227361),z=n.n(j),V=n(69371),Y=n(926854),H=n(504518),B=n(333101),J=n(555994);const q=e=>((0,u.E5)(e)||[]).filter((e=>!z()(e,"dataGrid.static"))).length>0,$=e=>t=>t.take(1).switchMap((()=>Z().Observable.of((0,H.um)({...e,autoDismiss:8,position:"tr",uid:"timeline-collapsed"})))).merge(t),K={collapseTimelineOnWidgetsEvents:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Z().Observable.merge(e.ofType(g.Ym,g.uU,Y.ok,g.$A,g.Jm).filter((()=>q(t())&&(0,J.pn)(t())))).switchMap((()=>Z().Observable.of((0,V.w2)(!0)))).let($({title:"widgets.tray.notifications.collapsed.timelineTitle",message:"widgets.tray.notifications.collapsed.message"}))},collapseWidgetsOnTimelineEvents:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Z().Observable.merge(e.ofType(V.M5).filter((e=>{let{collapsed:t}=e;return!t})),e.ofType(B.yS).filter((function(){let{newProperties:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.dimensions}))).filter((()=>q(t())&&(0,J.qJ)(t())&&(0,J.pn)(t()))).switchMap((()=>Z().Observable.of((0,g.Ff)()))).let($({title:"widgets.tray.notifications.collapsed.widgetsTitle",message:"widgets.tray.notifications.collapsed.message"}))},expandTimelineIfCollapsedOnTrayUnmount:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(g.yY,g.$A,Y.ok).filter((()=>!(0,J.pn)(t())&&(0,J.qJ)(t()))).filter((()=>!q(t()))).switchMap((()=>Z().Observable.of((0,V.w2)(!1))))}},Q={WidgetsTrayPlugin:(0,F.Z)(D),epics:K}},748928:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n(22222),o=n(171703),r=n(350126),i=n(101092);const l=(0,o.connect)((0,s.P1)(r.Jz,r.VM,i.c0,((e,t,n)=>({enabled:!e&&!t&&!n}))))},725211:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var s=n(867076),o=n(171703),r=n(22222),i=n(274363),l=n(510644),a=n(227361),p=n.n(a),c=n(984596),d=n.n(c),u=n(66604),g=n.n(u),h=n(747037),E=n.n(h),y=n(701469),m=n.n(y);const f=e=>{let{accessInfo:t,postProcessValue:n,reduceFun:s}=e;return e=>{let o=d()(e),r=s;return o.length>1&&"__OR__"===o[0]&&(r=(e,t)=>e||t,o=o.slice(1)),o.map((e=>{let o=e;if(m()(o))return f({accessInfo:t,postProcessValue:n,reduceFun:s})(o);let r=!1;o&&E()(o)&&o.startsWith("!")&&(r=!0,o=o.substr(1));const i=e=>r?!e:e,l=E()(o)&&o.split(":");if(l&&l[0]){const e=l[0].split(/\!\=\=?/),s=l[0].split(/\=\=?\=?/);return e.length>1?i(n(p()(t,e[0]),o)!==e[1]):s.length>1?i(n(p()(t,s[0]),o)===s[1]):i(n(p()(t,l[0]),o))}return o})).reduce(r||((e,t)=>e&&t))}},b=function(){return(0,s.compose)((0,o.connect)((0,r.P1)(i.J9,i._H,l.np,((e,t,n)=>({accessInfo:{mapId:e,mapInfo:t,user:n}})))),function(e){let{asObject:t=!1,postProcessValue:n=(e=>e),reduceFun:o,accessInfo:r="accessInfo"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.withPropsOnChange)([e,r],(function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t?{[e]:g()(s[e],f({accessInfo:s[r],postProcessValue:n,reduceFun:o}))}:{[e]:f({accessInfo:s[r],postProcessValue:n,reduceFun:o})(s[e])}}))}(...arguments))}}}]);