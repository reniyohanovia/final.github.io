(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[1299],{718341:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>Z});var r=t(124852),o=t.n(r),i=t(45697),s=t.n(i),a=t(171703),l=t(49977),p=t.n(l),c=t(333101),u=t(926854),m=t(504518),f=t(687753),g=t(859518),d=t(274363);const h=(0,t(22222).P1)([e=>e.layers&&e.layers.flat&&e.layers.flat.filter((e=>"wms"===e.type&&"background"!==e.group))||[],e=>e.layers&&e.layers.refreshing||[]],((e,n)=>({loading:!!(n&&n.length>0),length:e.length||0,count:e.length-n.length+1||0})));var b=t(630294),v=t(472986),y=t.n(v),w=t(804504),E=t(893379),x=t.n(E),S=t(467062);function k(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}x()(S.Z,{insert:"head",singleton:!1}),S.Z.locals;class U extends o().Component{render(){return this.props.loading?o().createElement("div",{className:"overlay-spinner-container"},o().createElement("div",null,o().createElement(b.Row,null,o().createElement(b.Col,{xs:12,className:"text-center overlay-spinner-label"},o().createElement("h3",null,o().createElement(w.Z,{msgId:this.props.label})))),o().createElement(b.Row,null,o().createElement(b.Col,{xs:12},this.props.spinner?o().createElement(y(),{noFadeIn:!0,overrideSpinnerClassName:"spinner",spinnerName:this.props.spinner}):o().createElement(b.ProgressBar,{active:!0,now:100*this.props.count/this.props.length}))),o().createElement(b.Row,null,o().createElement(b.Col,{xs:12,className:"text-center overlay-spinner-label"},o().createElement("h3",null,this.props.count+" "," ",o().createElement(w.Z,{msgId:"autorefresh.of"})," "+this.props.length+" ",o().createElement(w.Z,{msgId:this.props.unit})))))):null}}k(U,"propTypes",{loading:s().bool,count:s().number,length:s().number,label:s().string,unit:s().string,spinner:s().string}),k(U,"defaultProps",{loading:!1,count:0,length:0,label:"autorefresh.updating",unit:"autorefresh.layers"});const C=U;var O=t(152543);function P(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}class M extends o().Component{UNSAFE_componentWillMount(){this.props.onUpdateOptions(this.props.options)}render(){return o().createElement(C,{loading:this.props.loading,count:this.props.count,length:this.props.length,label:this.props.label,unit:this.props.unit,spinner:this.props.spinner})}}P(M,"propTypes",{options:s().object,loading:s().bool,count:s().number,length:s().number,label:s().string,unit:s().string,onUpdateOptions:s().func,spinner:s().string}),P(M,"defaultProps",{loading:!1,count:0,length:0,label:"autorefresh.updating",unit:"autorefresh.layers",options:{bbox:!0,search:!0,dimensions:!0,title:!1},onUpdateOptions:()=>{}});const j=(0,a.connect)(h,{onUpdateOptions:f.Xg.bind(null,"mapUpdate","options")})(M),Z=(0,O.rx)("AutoMapUpdate",{component:j,reducers:{},epics:{manageAutoMapUpdate:(e,n)=>e.ofType(u.ok).switchMap((t=>e.ofType(u.KS).take(1).switchMap((r=>{const o=(0,d.Zr)(n.getState()),i=r.info&&r.info.canEdit||!1;let s=t.config&&t.config.map&&t.config.map.layers&&t.config.map.layers.filter((e=>"wms"===e.type&&"background"!==e.group))||[];const a=(l=n.getState()).controls&&l.controls.mapUpdate&&l.controls.mapUpdate.options||{bbox:!0,search:!0,dimensions:!0,title:!1};var l;return o<2&&i?p().Observable.of((0,m.Kp)({title:"notification.warning",message:"notification.updateOldMap",action:{label:"notification.update",dispatch:(0,c.oZ)(s,a)},autoDismiss:12,position:"tc"})).concat(e.ofType(c.k3,c.CQ).bufferCount(s.length).switchMap((e=>{const n=e.filter((e=>e.type===c.CQ)).length>0?(0,m.Kp)({title:"notification.warning",message:"notification.warningSaveUpdatedMap",autoDismiss:6,position:"tc"}):(0,m.Vp)({title:"notification.success",message:"notification.saveUpdatedMap",autoDismiss:6,position:"tc"});return p().Observable.of(n,(0,f.Xi)("save"),(0,g.SL)(2))}))):p().Observable.empty()}))))}})},467062:(e,n,t)=>{"use strict";t.d(n,{Z:()=>i});var r=t(923645),o=t.n(r)()((function(e){return e[1]}));o.push([e.id,".ms2 .overlay-spinner-container  {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 9998;\n    background-color: rgba(0, 0, 0, 0.5);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.ms2 .overlay-spinner-container > div {\n    width: 80%;\n}\n\n.ms2 .overlay-spinner-label {\n    color: #fff;\n}\n\n.ms2 .overlay-spinner-container .spinner {\n    float: none;\n    clear: both;\n    margin: auto;\n    width: 52px;\n    height: 52px;\n}\n\n.ms2 .overlay-spinner-container .spinner .sk-circle:before {\n    background-color: #fff;\n}\n",""]);const i=o}}]);