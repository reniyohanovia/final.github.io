(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[7330],{430856:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>V});var n=o(218721),r=o.n(n),a=o(264721),s=o.n(a),i=o(103651),l=o.n(i),c=o(727418),p=o.n(c),u=o(45697),d=o.n(u),h=o(124852),m=o.n(h),g=o(630294),v=o(152543),f=o(22222);const y="CHANGE_CRS_INPUT_VALUE";var S=o(859518),w=o(504518),b=o(804504),C=o(719648);function E(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class R extends m().Component{constructor(){super(...arguments),E(this,"handleChange",(e=>{this.props.changeInputValue(e.target.value)}))}render(){const{children:e}=this.props;return m().createElement("div",{className:"dropdown-menu",style:{left:"auto",right:0}},m().createElement(g.ListGroupItem,{className:"ms-prj-header",bsSize:"sm"},m().createElement("div",null,m().createElement(b.Z,{msgId:"crsSelectorSelectedCRS"})),m().createElement("div",null,this.props.selected)),m().createElement(g.ListGroup,{style:{maxHeight:150,overflowY:"auto",marginBottom:0}},e.filter((e=>!this.props.value.trim()||-1!==e.props.children.indexOf(this.props.value)))),m().createElement(g.FormControl,{ref:e=>{this.input=e},type:"text",placeholder:(0,C.S$)(this.context.messages,"crsSelectorFilterPlaceholder"),onChange:this.handleChange,value:this.props.value}))}}E(R,"propTypes",{selected:d().string,value:d().string,changeInputValue:d().func}),E(R,"contextTypes",{messages:d().object}),E(R,"defaultProps",{value:"",changeInputValue:()=>{}});const P=R;var j=o(36549);var M=o(30206),G=o(119008),I=o(820709),T=o(612912),U=o(274363),k=o(350126),A=o(101092),x=o(510644),D=o(351546),L=o(23888);function F(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const O=(0,j.Z)(L.Z);class B extends m().Component{constructor(){super(...arguments),F(this,"state",{toggled:!1})}render(){let e=[],t={};Object.keys(this.props.availableCRS).length&&(t=(0,D.filterCRSList)(this.props.availableCRS,this.props.filterAllowedCRS,this.props.additionalCRS,this.props.projectionDefs));for(let o in t)t.hasOwnProperty(o)&&e.push({value:o});const o=(0,D.normalizeSRS)(this.props.selected,this.props.filterAllowedCRS),n=["EPSG:4326","EPSG:3857","EPSG:900913"],a=["wms","osm","tileprovider","empty"],i=e=>{l()(n,e)>-1||l()(a,this.props.currentBackground.type)>-1||this.props.currentBackground.allowedSRS&&r()(this.props.currentBackground.allowedSRS,e)?this.props.setCrs(e):this.props.onError({title:"error",message:"notification.incompatibleBackgroundAndProjection",action:{label:"close"},position:"tc",uid:"3"})},c=s()(this.props.allowedRoles,"ALL")||s()(this.props.allowedRoles,this.props.currentRole);return this.props.enabled&&c?m().createElement(g.Dropdown,{dropup:!0,className:"ms-prj-selector",onToggle:e=>this.setState({toggled:e})},m().createElement(O,{bsRole:"toggle",bsStyle:"primary",className:"map-footer-btn btn-"+(this.state.toggled?"success":"primary"),tooltip:m().createElement(b.Z,{msgId:"showCrsSelector"}),tooltipPosition:"top"},m().createElement(g.Glyphicon,{glyph:"crs"})),m().createElement(P,{bsRole:"menu",value:this.props.value,selected:o,projectionDefs:this.props.projectionDefs,filterAllowedCRS:this.props.filterAllowedCRS,additionalCRS:this.props.additionalCRS,changeInputValue:e=>this.props.typeInput(e)},e.map((e=>m().createElement(g.ListGroupItem,{key:e.value,active:o===e.value,onClick:e=>i(e.target.textContent),eventKey:e.value},e.value))))):null}}F(B,"propTypes",{selected:d().string,value:d().string,projections:d().array,availableCRS:d().object,filterAllowedCRS:d().array,projectionDefs:d().array,additionalCRS:d().object,setCrs:d().func,typeInput:d().func,enabled:d().bool,currentBackground:d().object,onError:d().func,allowedRoles:d().array,currentRole:d().string}),F(B,"defaultProps",{availableCRS:(0,D.getAvailableCRS)(),setCrs:()=>{},typeInput:()=>{},enabled:!0,allowedRoles:["ALL"]});const N=(0,v.$j)((0,f.P1)(x.L3,T.DP,U.uy,U.pb,(e=>e&&e.crsselector&&e.crsselector.value),I.eK,A.c0,k.VM,G.QF,G._d,G.h,M.cM,((e,t,o,n,r,a,s,i,l,c,p,u)=>({currentRole:e,currentBackground:t,selected:o,projectionDefs:n,value:r,enabled:!("EDIT"===a||s||i||l||c||p||u)}))),{typeInput:function(e){return{type:y,value:e}},setCrs:S.NH,onError:w.vU})(B),V={CRSSelectorPlugin:p()(N,{disablePluginIf:"{state('mapType') === 'leaflet'}",MapFooter:{name:"crsSelector",position:10,tool:!0,priority:1}}),reducers:{crsselector:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{projections:[]},t=arguments.length>1?arguments[1]:void 0;return t.type===y?p()({},e,{value:t.value}):e}},epics:{}}},30206:(e,t,o)=>{"use strict";o.d(t,{sB:()=>g,_o:()=>v,cM:()=>P,Cq:()=>V,cQ:()=>Q,dm:()=>z});var n=o(22222),r=o(612912),a=o(274363),s=o(101092),i=o(975872),l=o(91175),c=o.n(l),p=o(227361),u=o.n(p),d=o(727418),h=o.n(d),m=o(234228);const g=(0,n.P1)([r.l2],(e=>c()(e.filter((e=>"annotations"===e.id))))),v=e=>u()(e,"annotations.config.multiGeometry",!1),f=e=>u()(e,"annotations.removing"),y=e=>u()(e,"annotations.format"),S=e=>u()(e,"annotations.aeronauticalOptions"),w=e=>u()(e,"annotations.showUnsavedChangesModal",!1),b=e=>u()(e,"annotations.showUnsavedStyleModal",!1),C=e=>u()(e,"annotations.showUnsavedGeometryModal",!1),E=e=>u()(e,"annotations.showDeleteFeatureModal",!1),R=e=>!!u()(e,"annotations.closing"),P=e=>u()(e,"annotations.editing"),j=e=>u()(e,"annotations.editGeometry",!0),M=e=>u()(e,"annotations.featureType"),G=e=>u()(e,"annotations.coordinateEditorEnabled"),I=e=>!!u()(e,"annotations.drawing"),T=e=>u()(e,"annotations.stylerType"),U=e=>u()(e,"annotations.drawingText"),k=e=>u()(e,"annotations.editedFields",{}),A=e=>!!u()(e,"annotations.styling"),x=e=>u()(e,"annotations.selected",null),D=e=>u()(e,"annotations.unsavedChanges",!1),L=e=>u()(e,"annotations.unsavedGeometry",!1),F=e=>u()(e,"annotations.unsavedStyle",!1),O=e=>u()(e,"annotations.validationErrors",{}),B=e=>u()(e,"annotations.config",{}),N=e=>u()(e,"annotations.symbolList",[]),V=e=>u()(e,"annotations.symbolErrors",[]),_=e=>(P(e)?"editing":g(e)&&(e=>u()(e,"annotations.current"))(e)&&"detail")||"list",H=e=>u()(e,"annotations.showAgain",!1),Z=e=>u()(e,"annotations.showPopupWarning",!0),Q=e=>h()({},{symbolErrors:V(e),showEdit:(0,s.m6)(e),canEdit:j(e),mouseHoverEvents:(0,i.Qp)(e),closing:R(e),format:y(e)||(0,m.u8)("defaultCoordinateFormat"),aeronauticalOptions:S(e),config:B(e),drawing:I(e),drawingText:U(e),errors:O(e),editing:P(e),coordinateEditorEnabled:G(e),editedFields:k(e),mode:_(e),selected:x(e),featureType:M(e),removing:f(e),mapProjection:(0,a.uy)(e),showUnsavedChangesModal:w(e),showDeleteFeatureModal:E(e),showUnsavedGeometryModal:C(e),showUnsavedStyleModal:b(e),stylerType:T(e),styling:A(e),unsavedChanges:D(e),unsavedGeometry:L(e),unsavedStyle:F(e),symbolList:N(e),showAgain:H(e),showPopupWarning:Z(e)}),z=(0,n.P1)([Q,e=>({...e.annotations||{}}),g,_],((e,t,o,n)=>h()({},{format:t.format,aeronauticalOptions:t.aeronauticalOptions,removing:t.removing,showUnsavedChangesModal:t.showUnsavedChangesModal,showUnsavedGeometryModal:t.showUnsavedGeometryModal,showUnsavedStyleModal:t.showUnsavedStyleModal,showDeleteFeatureModal:t.showDeleteFeatureModal,closing:!!t.closing,mode:n,annotations:o&&o.features||[],current:t.current||null,editing:e.editing,selected:e.selected,filter:t.filter||"",defaultStyles:t.defaultStyles,loading:t.loading},e.config?{config:e.config}:{})));(0,n.P1)([z],(e=>{const t=e.current;return{annotation:c()(e.annotations.filter((e=>e.properties.id===t)))}}))},103651:(e,t,o)=>{var n=o(442118),r=o(640554),a=Math.max;e.exports=function(e,t,o){var s=null==e?0:e.length;if(!s)return-1;var i=null==o?0:r(o);return i<0&&(i=a(s+i,0)),n(e,t,i)}}}]);