(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[8443],{546997:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>w});var n=o(893379),r=o.n(n),s=o(560691);r()(s.Z,{insert:"head",singleton:!1}),s.Z.locals;var a=o(124852),i=o.n(a),l=o(171703),A=o(630294);const c="CHANGE_LOCATE_STATE",p="LOCATE_ERROR";function u(t){return{type:c,state:t}}var h=o(488400),g=o(45697),d=o.n(g),E=o(804504),m=o(401811),f=o(68390),y=o.n(f),C=o(23888);function I(){return I=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},I.apply(this,arguments)}function L(t,e,o){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}o.e(5593).then(o.bind(o,645593));let b=!1,k=!1;class v extends i().Component{constructor(){super(...arguments),L(this,"onClick",(()=>{let t;switch(this.props.locate){case"FOLLOWING":case"LOCATING":case"PERMISSION_DENIED":t="DISABLED";break;case"ENABLED":t="FOLLOWING";break;case"DISABLED":t="ENABLED"}this.props.onClick(t)})),L(this,"renderButton",(()=>{const t="PERMISSION_DENIED"===this.props.locate;return i().createElement(C.Z,I({id:this.props.id,disabled:t},this.props.btnConfig,{onClick:this.onClick,bsStyle:this.getBtnStyle(),style:this.props.style}),i().createElement(A.Glyphicon,{glyph:this.props.glyph}),this.props.text,this.props.help)})),L(this,"renderLoadingButton",(()=>{let t=i().createElement("img",{src:y(),style:{display:"inline-block",margin:"0px",padding:0,background:"transparent",border:0},alt:"..."});return i().createElement(C.Z,I({id:this.props.id,onClick:this.onClick},this.props.btnConfig,{bsStyle:this.getBtnStyle(),style:this.props.style}),t)})),L(this,"addTooltip",(t=>{const e=i().createElement(A.Tooltip,{id:"locate-tooltip"},i().createElement(E.Z,{msgId:this.props.tooltip}));return i().createElement(m.Z,{placement:this.props.tooltipPlace,key:`{overlay-trigger.${this.props.id}-${this.props.tooltip}}`,overlay:e},t)})),L(this,"getBtnStyle",(()=>{const{locate:t,bsStyle:e}=this.props;let o=e;return"FOLLOWING"!==t&&"ENABLED"!==t||(o="success active"),o}))}UNSAFE_componentWillMount(){"PERMISSION_DENIED"===this.props.locate||b||k||(b=!0,navigator?.geolocation?.getCurrentPosition?navigator.geolocation.getCurrentPosition((()=>{b=!1,k=!0}),(t=>{b=!1,1===t.code&&this.props.onClick("PERMISSION_DENIED")})):(b=!1,this.props.onClick("PERMISSION_DENIED")))}render(){var t="LOCATING"===this.props.locate?this.renderLoadingButton():this.renderButton();return this.props.tooltip?this.addTooltip(t):t}}L(v,"propTypes",{id:d().string,hide:d().bool,btnConfig:d().object,text:d().oneOfType([d().string,d().element]),help:d().oneOfType([d().string,d().element]),locate:d().string,onClick:d().func,tooltip:d().element,tooltipPlace:d().string,style:d().object,bsStyle:d().string,glyph:d().string}),L(v,"defaultProps",{id:"locate-btn",onClick:()=>{},locate:"DISABLED",tooltipPlace:"left",bsStyle:"default",glyph:"1-position-1",btnConfig:{className:"square-button"}});const S=v;var D=o(152543),O=o(727418),N=o.n(O);var B=o(588887);const T=(0,l.connect)((t=>({locate:t.locate&&t.locate.state||"DISABLED",tooltip:t.locate&&"FOLLOWING"===t.locate.state?"locate.tooltipDeactivate":"locate.tooltip"})),{onClick:u})(S),w=(0,D.rx)("Locate",{component:T,options:{disablePluginIf:"{state('mapType') === 'cesium'}"},containers:{Toolbar:{name:"locate",position:2,tool:!0,icon:i().createElement(A.Glyphicon,{glyph:"screenshot"}),help:i().createElement(h.Z,{msgId:"helptexts.locateBtn"}),priority:1},Map:{name:"Locate",Tool:(0,l.connect)((t=>({status:t.locate&&t.locate.state,messages:t.locale&&t.locale.messages?t.locale.messages.locate:void 0})),{changeLocateState:u,onLocateError:function(t){return{type:p,error:t}}})((t=>{let{map:e,mapType:o,speedThreshold:n,status:r,messages:s,maxZoom:i,changeLocateState:l,onLocateError:A,rateControl:c}=t;const p=(0,a.useRef)(),[u,h,g]=(0,B.default)(o,"locate");(0,a.useEffect)((()=>{g&&A(g)}),[g]);const d=t=>{r!==t&&l(t)},E=t=>{A(t.message),l("DISABLED")};function m(){return{locateOptions:{...void 0!==i&&{maxZoom:i},...void 0!==c&&{rateControl:c},...void 0!==n&&{speedThreshold:n}}}}return(0,a.useEffect)((()=>{if(u){const t=m();p.current=new h,p.current.start({map:e,options:t,messages:s,status:r,onStateChange:d,onLocationError:E})}return()=>{p.current?.clear()}}),[u]),(0,a.useEffect)((()=>{const t=m();p.current?.update({status:r,messages:s,options:t})}),[r,s,u,i]),null})),priority:1}},reducers:{locate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{state:"DISABLED"},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case c:return N()({},t,{state:e.state});case p:return N()({},t,{error:e.error});default:return t}}}})},560691:(t,e,o)=>{"use strict";o.d(e,{Z:()=>s});var n=o(923645),r=o.n(n)()((function(t){return t[1]}));r.push([t.id,".ms2 #locate-btn {\n    position: absolute;\n    z-index: 1000;\n    right: 10px;\n    bottom: 150px;\n}\n\n.ms2 #mapstore-toolbar #locate-btn {\n    position: static;\n}\n",""]);const s=r},68390:t=>{t.exports="data:image/gif;base64,R0lGODlhEAALAPQAAP///zMzM+Hh4dnZ2e7u7jc3NzMzM1dXV5qamn9/f8fHx05OTm5ubqGhoYKCgsrKylFRUTY2NnFxcerq6t/f3/b29l9fX+Li4vT09MTExLKystTU1PHx8QAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCwAAACwAAAAAEAALAAAFLSAgjmRpnqSgCuLKAq5AEIM4zDVw03ve27ifDgfkEYe04kDIDC5zrtYKRa2WQgAh+QQJCwAAACwAAAAAEAALAAAFJGBhGAVgnqhpHIeRvsDawqns0qeN5+y967tYLyicBYE7EYkYAgAh+QQJCwAAACwAAAAAEAALAAAFNiAgjothLOOIJAkiGgxjpGKiKMkbz7SN6zIawJcDwIK9W/HISxGBzdHTuBNOmcJVCyoUlk7CEAAh+QQJCwAAACwAAAAAEAALAAAFNSAgjqQIRRFUAo3jNGIkSdHqPI8Tz3V55zuaDacDyIQ+YrBH+hWPzJFzOQQaeavWi7oqnVIhACH5BAkLAAAALAAAAAAQAAsAAAUyICCOZGme1rJY5kRRk7hI0mJSVUXJtF3iOl7tltsBZsNfUegjAY3I5sgFY55KqdX1GgIAIfkECQsAAAAsAAAAABAACwAABTcgII5kaZ4kcV2EqLJipmnZhWGXaOOitm2aXQ4g7P2Ct2ER4AMul00kj5g0Al8tADY2y6C+4FIIACH5BAkLAAAALAAAAAAQAAsAAAUvICCOZGme5ERRk6iy7qpyHCVStA3gNa/7txxwlwv2isSacYUc+l4tADQGQ1mvpBAAIfkECQsAAAAsAAAAABAACwAABS8gII5kaZ7kRFGTqLLuqnIcJVK0DeA1r/u3HHCXC/aKxJpxhRz6Xi0ANAZDWa+kEAA7AAAAAAAAAAAA"},588887:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>r});var n=o(124852);const r=(t,e)=>{const[r,s]=(0,n.useState)(!1),[a,i]=(0,n.useState)(null),l=(0,n.useRef)(),A=(0,n.useRef)();return(0,n.useEffect)((()=>(A.current=!0,()=>{A.current=!1})),[]),(0,n.useEffect)((()=>(t&&!l.current&&(s(!1),i(null),o(78641)("./"+t+"/"+e).then((t=>{A.current&&(l.current=t.default,s(!0))})).catch((t=>{A.current&&i(t)}))),()=>{})),[t]),[r,l.current,a]}},78641:(t,e,o)=>{var n={"./hooks/useMapTool":[588887],"./hooks/useMapTool.js":[588887],"./leaflet/locate":[401419,5243,1419],"./leaflet/locate.js":[401419,5243,1419],"./openlayers/locate":[554712,317,302,4712],"./openlayers/locate.js":[554712,317,302,4712]};function r(t){if(!o.o(n,t))return Promise.resolve().then((()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=n[t],r=e[0];return Promise.all(e.slice(1).map(o.e)).then((()=>o(r)))}r.keys=()=>Object.keys(n),r.id=78641,t.exports=r}}]);