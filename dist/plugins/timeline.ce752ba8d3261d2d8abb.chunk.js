(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[6523],{832979:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var a=n(124852),i=n.n(a),r=n(118438),l=n(630294),s=n(957557),o=n.n(s),c=n(180307),d=n.n(c);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},m.apply(this,arguments)}const p=e=>class extends i().Component{render(){let t=null;const{popoverOptions:n,keyProp:a,...s}=this.props;return i().createElement("span",{className:"mapstore-info-popover"},i().createElement(e,m({},o()(s,["renderPopover","tooltipId"]),{key:a,ref:e=>{t=e}})),i().createElement(r.Z,{placement:n.placement,shouldUpdatePosition:!0,show:!0,target:()=>d().findDOMNode(t)},i().createElement(l.Popover,n.props,n.content)))}}},169988:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>B});var a=n(49977),i=n.n(a),r=n(747037),l=n.n(r),s=n(227361),o=n.n(s),c=n(91175),d=n.n(c),m=n(984596),p=n.n(m),u=n(441609),g=n.n(u),y=n(414293),f=n.n(y),b=n(730381),h=n.n(b),v=n(426529),O=n(859518),T=n(69371),S=n(929761),w=n(333101),L=n(504518),P=n(612912),k=n(555994),E=n(833517),I=n(926244),R=n(175082),C=n(234425),D=n(926854);const M="time",Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,k.Li)(e()),a=(0,k.uy)(e()),i=(0,k.Ry)(e()),r=(0,k.F3)(n)(e());return[i,a,"time",{limit:1,...t,fromEnd:"end"===(0,k.pW)(e())},r]},N=(e,t,n)=>{const a=e();if((0,k.uy)(a)){const t=(0,k.pW)(a);return(0,C.w)(Z,!1,e,t,n).map((e=>(0,I.Qn)(e.filter((e=>!!e)),n,t)||n))}const r=(0,E.aK)((0,P.CA)(a,t))(a);return i().Observable.of((0,I.Qn)(r,n)||n)},V=e=>l()(e)?e:e.toISOString(),A=5,x=(e,t,n)=>{const{isFullRange:a,offsetTime:r}=e;let s;s=l()(t)?t.indexOf("--")>0?t.split("--"):t.indexOf(",")>0?t.split(","):[t]:t,s.length>2&&(s=[s[0],s[s.length-1]]);let[o,c]=s?.filter((e=>!!e))||[];const d=a?o??n:n,m=h()(864e5*A).diff(0),p=h()(new Date).add(m/A).toISOString(),u=a?c??p:r??p,g=h()(u).diff(h()(d)),y=h()(d).add(g).toISOString();return i().Observable.of((0,S.yR)(d)).concat(i().Observable.of((0,S.pF)(u))).concat(i().Observable.of((0,T.y3)({start:o,end:y})))},H=(e,t)=>(0,T.Nb)(o()((0,E.LS)(e),"[0].id"),t),B={updateTimelineDataOnMapLoad:e=>e.ofType(D.ok).filter((function(){let{config:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!g()(e)})).switchMap((function(){let{config:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e?.timelineData?.selectedLayer,n=e?.dimensionData?.currentTime,a=e?.timelineData?.endValuesSupport,r=e?.timelineData?.snapRadioButtonEnabled,l=e?.timelineData?.layers;return i().Observable.of(...g()(t)?[]:[(0,T.Nb)(t)],...f()(a)?[]:[(0,T.Hz)(a)],...f()(r)?[]:[(0,T.Qq)(r)],...g()(l)?[]:[(0,T.bz)(l)]).concat(i().Observable.of(...g()(n)?[(0,T.KI)()]:[]))})),setTimelineCurrentTime:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.qx).throttleTime(100).switchMap((e=>{let{time:n,group:a}=e;const r=t();return a?N(t,a,n).switchMap((e=>{const t=(0,k.YK)(r),{start:n,end:a}=t||{};let l=[];if(n&&a&&(h()(e).isBefore(n)||h()(e).isAfter(a))){const t=h()(a).diff(n);l=[(0,T.y3)({start:h()(e).subtract(t/2),end:h()(e).add(t/2)})]}return i().Observable.from([...l,(0,S.yR)(e)])})).let((0,v.hP)((0,T.aA)(!1,!0),(0,T.aA)(!1,!1))):i().Observable.of((0,S.yR)(n))}))},settingInitialOffsetValue:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.JU).switchMap((e=>{const n=t(),a=(0,E.WT)(n),r=(0,k.YK)(n);if(e.enabled){const{start:t=0,end:l=864e5*A}=r||{},s=(0,E.ns)(n),o=h()(l).diff(t);let c=r?h()(t).add(o/2).toISOString():h()(new Date).toISOString();const d=h()(a||c).add(o/A);let m=e.enabled&&!a?i().Observable.of((0,S.yR)(c)):i().Observable.empty(),p=e.enabled&&!s||e.enabled&&h()(s).diff(a)<0?i().Observable.of((0,S.pF)(d.toISOString())):i().Observable.empty();const u=r?i().Observable.empty():i().Observable.of((0,T.y3)({start:h()(c).add(-1*o/2),end:h()(c).add(o/2)}));return m.concat(p).concat(u)}return i().Observable.of((0,S.pF)())}))},updateRangeDataOnRangeChange:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.Lv).merge(e.ofType(O.pP).filter((()=>(0,k.cX)(t()))),e.ofType(T.w)).debounceTime(400).merge(e.ofType(S.XV).debounceTime(50)).switchMap((()=>{const e=(0,E.m$)(t())||{},n=Object.keys(e).filter((n=>e[n]&&e[n].domain&&(0,I._q)(e[n].domain)||(0,k.cX)(t())));return i().Observable.merge(...n.map((n=>((e,t,n)=>{const a=t.domain.split("--"),r=(0,k.YK)(n())||{start:new Date(a[0]),end:new Date(a[1])},{range:l,resolution:s}=(0,I.un)(r,20),c=(0,P.CA)(n(),e).name,m=(0,k.oo)(n()),u={[M]:`${V(l.start)}/${V(l.end)}`};return(0,R.ot)(t.source.url,c,M,{[M]:`${V(l.start)}/${V(l.end)}`},s,(0,k.F3)(e)(n())).merge((0,R.i8)(t.source.url,c,u,{...(0,k.F3)(e)(n()),expandLimit:m})).scan(((e,t)=>({...e,...t})),{}).switchMap((e=>{let{Histogram:t,Domains:n}=e;const a=o()(d()(p()(o()(n,"DimensionDomain")||[]).filter((function(){let{Identifier:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e===M}))),"Domain");let r;try{r=t&&t.Values&&t.Values.split(",").map((e=>parseInt(e,10)))||[]}catch(e){r=[]}const s=a&&a.indexOf("--")<0&&a.split(",");return i().Observable.of({range:l,histogram:t&&t.Domain?{values:r,domain:t.Domain}:void 0,domain:a?{values:s}:void 0})}))})(n,e[n],t).map((e=>{let{range:t,histogram:a,domain:i}=e;return(0,T.cO)(n,t,a,i)})).startWith((0,T.aA)(n,!0)).catch((()=>i().Observable.of((0,L.vU)({uid:"error_with_timeline_update",title:"timeline.errors.multidim_error_title",message:"timeline.errors.multidim_error_message"})))).concat(i().Observable.of((0,T.aA)(n,!1))))))}))},syncTimelineGuideLayer:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.cb).merge(e.ofType(w.sb,w.yS).withLatestFrom(e.ofType(T._V),((e,n)=>{let{layerId:a}=n;return a&&!(0,k.rV)(t()).some((e=>e.id===a))})).filter((e=>!!e))).switchMap((()=>{const e=t(),n=o()((0,k.rV)(e),"[0].id");return(0,k.en)(e)&&n?i().Observable.of((0,T.kq)(n)):i().Observable.empty()}))},snapTimeGuideLayer:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T._V,T.Xe).filter((e=>e?.layerId&&(0,k.en)(t())&&e?.snap)).switchMap((e=>{let{layerId:n}=e;return N(t,n,(0,E.WT)(t())||(new Date).toISOString()).filter((e=>e)).map((e=>(0,S.yR)(e)))}))},onInitTimeLine:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.p).debounceTime(500).switchMap((function(){let{config:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t(),a=(0,k.uy)(n),{initialMode:r,initialSnap:l}=e;if("single"===r&&"now"===l)return i().Observable.of(...g()(a)?[H(n)]:[]);if("range"===r&&!g()(l)){const e="fullRange"!==l;return i().Observable.of(g()(a)?H(n,e):(0,T.st)())}return i().Observable.empty()}))},setRangeOnInit:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.vf).switchMap((function(){let{value:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t(),a=(0,k.pW)(n),i=(0,k.Li)(n),r={isFullRange:[e,(0,k.TQ)(n)?.initialSnap].includes("fullRange"),offsetTime:(0,E.ns)(n)},{domain:l}=(0,E.Qw)(i,"time")(n)||{},s=(0,E.WT)(n),o=e=>(0,C.w)(Z,!1,t,a,e),c=e=>o().switchMap((t=>x(r,t,e)));if(!g()(l)&&!g()(s))return x(r,l,s);if(g()(l)&&!g()(s)||r.isFullRange)return c(s);const d=(new Date).toISOString();return o(d).switchMap((e=>{const t=(0,I.Qn)(e.filter((e=>!!e)),d,a)||d;return c(t)}))}))},rangeOnInitSelectLayer:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.Xe).filter((()=>(0,E.RP)(t())||"range"===(0,k.TQ)(t())?.initialMode)).switchMap((function(){let{snap:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i().Observable.of((0,T.st)(f()(e)||e?"now":"fullRange"))}))},onUpdateLayerDimensionData:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(S.XV).filter((e=>{let{data:n}=e;return"time"===n?.name&&!(0,k.Li)(t())})).switchMap((function(){let{data:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return g()(e)?i().Observable.empty():i().Observable.of((0,T.KI)(),...void 0===(0,k.Hc)(t())?[(0,T.Hz)("1.2"===e?.source?.version)]:[])}))},resetTimeline:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.Ud).switchMap((()=>{const e=t(),n=(0,E.RP)(e),a=(0,k.Li)(e);if(n)return i().Observable.of(g()(a)?H(e,!1):(0,T.st)("fullRange"));const r=(0,k.YK)(e)||{},l=new Date,s=h()(r.end)>h()(l);return i().Observable.of((0,T.HM)(l.toISOString(),a)).concat(...s?[]:[i().Observable.of((0,T.y3)({start:r.start,end:h()(l).add(864e5*A)}))])}))},setTimeLayersSetting:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(T.p,w.sb,w.yS,w.K$).switchMap((function(){let{config:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t();let a=i().Observable.empty();const r=(0,k.Kf)(n)||[];if(!g()(e)&&!g()(r))return a;const l=(0,E.AF)(n)?.filter((e=>e.visibility));if(!g()(l)){let e=l.map((e=>{const t=e.id,n=r.find((e=>e[t]));return{[t]:{hideInTimeline:!g()(n)&&o()(n,`${t}.hideInTimeline`)}}}));1===e.length&&(e=e.map((e=>({[o()(Object.keys(e),"[0]")]:{hideInTimeline:!1}})))),a=i().Observable.of((0,T.bz)(e))}return a}))}}},382652:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>fe});var a=n(91175),i=n.n(a),r=n(747037),l=n.n(r),s=n(730381),o=n.n(s),c=n(727418),d=n.n(c),m=n(124852),p=n.n(m),u=n(630294),g=n(171703),y=n(867076),f=n(22222),b=n(929761),h=n(481151),v=n(69371),O=n(804504),T=n(36549),S=n(640924),w=n(8204),L=n(251820),P=n(833517),k=n(350126),E=n(365452),I=n(555994),R=n(513218),C=n.n(R),D=n(170735),M=n.n(D),Z=n(414293),N=n.n(Z),V=n(359704),A=n.n(V),x=n(297977),H=n(904160),B=n(715828),W=n(52713),Y=n(92742),z=n.n(Y),_=n(926244);const $=(e,t)=>o()(t).diff(e)>0,j=(0,y.withHandlers)({clickHandler:e=>{let{selectedLayer:t,offsetEnabled:n,status:a,setCurrentTime:i=(()=>{}),selectGroup:r=(()=>{})}=e;return function(){let{time:e,group:l,what:s,event:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("PLAY"!==a)switch(s){case"group-label":l&&"PLAY"!==a&&r(l);break;default:{const a=o&&o.target&&o.target.closest(".vis-custom-time"),r=a&&a.getAttribute("class"),l=r&&z()(r.replace("vis-custom-time",""));e&&!n&&"startPlaybackTime"!==l&&"endPlaybackTime"!==l&&i(e.toISOString(),t);break}}}},timechangedHandler:e=>{let{currentTime:t,setOffset:n=(()=>{}),setCurrentTime:a=(()=>{}),currentTimeRange:i={},playbackRange:r,setPlaybackRange:l=(()=>{}),selectedLayer:s}=e;return function(){let{time:e,id:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("startPlaybackTime"!==o&&"endPlaybackTime"!==o)"currentTime"===o&&(i.end?$(e,i.end)?a(e.toISOString(),null):(a(i.end),n(e.toISOString())):a(e.toISOString(),s)),"offsetTime"===o&&($(t,e)?n(e.toISOString()):(a(e.toISOString()),n(t)));else{const t={...r,[o]:e.toISOString()};let{start:n,end:a}=(0,_.og)(t.startPlaybackTime,t.endPlaybackTime);$(n,a)&&l({startPlaybackTime:n,endPlaybackTime:a})}}}}),F=(0,y.compose)((0,y.withPropsOnChange)(["rangeItems","playbackRange","playbackEnabled","selectedLayer"],(e=>{let{rangeItems:t=[],playbackEnabled:n,playbackRange:a}=e;return{rangeItems:n&&a&&void 0!==a.startPlaybackTime&&void 0!==a.endPlaybackTime?[...t,{id:"playback-range",...(0,_.og)(a.startPlaybackTime,a.endPlaybackTime),type:"background",className:"ms-playback-range"}].filter((e=>e)):t}})),(0,y.compose)((0,y.withHandlers)({onUpdate:e=>{let{moveCurrentRange:t=(()=>{})}=e;return e=>{let{id:n,start:a}=e;"current-range"===n&&t(a.toISOString())}}}),(0,y.withPropsOnChange)(["options","onUpdate"],(e=>{let{options:t={},onUpdate:n=(()=>{})}=e;return{options:{...t,snap:null,editable:{add:!1,updateTime:!1,updateGroup:!1,remove:!1,overrideItems:!1},onMove:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;n(e),t(e)}}}})),(0,y.withPropsOnChange)(["rangeItems","currentTime","offsetEnabled","selectedLayer","currentTimeRange","readOnly"],(e=>{let{currentTimeRange:t,rangeItems:n=[],readOnly:a,offsetEnabled:i}=e;return{rangeItems:i&&void 0!==t.start&&void 0!==t.end?[...n,{id:"current-range",editable:{updateTime:!a,updateGroup:!1,remove:!1},...(0,_.og)(t.start,t.end),type:"background",className:"ms-current-range"}].filter((e=>e)):n}}))),(0,y.withPropsOnChange)(["currentTime","playbackRange","playbackEnabled","offsetEnabled","currentTimeRange"],(e=>{let{currentTime:t,playbackRange:n,playbackEnabled:a,offsetEnabled:i,currentTimeRange:r}=e;return{customTimes:[t?{currentTime:t}:{},a&&n&&n.startPlaybackTime&&n.endPlaybackTime?n:{},i&&r?{offsetTime:r.end}:{}].reduce(((e,t)=>t?{...e,...t}:{...e}),{})}})));var K=n(707366);const U=(0,H.oz)(((e,t)=>e===t||!N()(e)&&!N()(t)&&e.id===t.id&&e.title===t.title&&e.name===t.name))(I.rV,(e=>e)),q=(0,y.compose)((0,g.connect)((0,f.P1)(I.YK,I.__,U,I.E2,K.Pz,((e,t,n,a,i)=>({viewRange:e,items:t,layers:n,loading:a,currentLocale:i})))),(0,y.withPropsOnChange)(((e,t)=>{const{layers:n=[],loading:a,selectedLayer:i,currentLocale:r}=e,{layers:l,loading:s,selectedLayer:o,nextLocale:c}=t,d=e.hideLayersName!==t.hideLayersName;return a!==s||i!==o||r!==c||d||n&&l&&n.length!==l.length||M()(n,l||[],(function(){let{id:e,title:t,name:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e+t+n})).length>0}),(e=>{let{layers:t=[],loading:n={},selectedLayer:a,currentLocale:i}=e;return{groups:t.map((e=>({id:e.id,className:(n[e.id]?"loading":"")+(e.id&&e.id===a?" selected":""),content:'<div class="timeline-layer-label-container">'+(n[e.id]?'<div class="timeline-layer-icon"><div class="timeline-spinner"></div></div>':`<div class="timeline-layer-icon">${e.id&&e.id===a?'<i class="glyphicon glyphicon-time"></i>':""}</div>`)+`<div class="timeline-layer-title">${C()(e.title)?e.title[i]??e.title.default:l()(e.title)&&e.title?e.title:e.name}</div></div>`})))}}))),G=(0,y.compose)((0,g.connect)((0,f.P1)(P.WT,I.m_,((e,t)=>({currentTime:e,currentTimeRange:t}))),{setCurrentTime:v.HM,moveCurrentRange:b.PZ,setOffset:b.pF})),Q=(0,y.compose)((0,g.connect)((0,f.zB)({playbackRange:E.KC,status:E.dS}),{setPlaybackRange:h.VS})),X=(0,y.compose)((0,g.connect)((0,f.P1)(I.Li,(e=>({selectedLayer:e}))),{selectGroup:v.kq})),J=(0,y.compose)((0,g.connect)((()=>({})),{rangechangedHandler:v.y3})),ee=(0,y.compose)(G,Q,X,j,J,q,(0,y.defaultProps)({key:"timeline",options:{maxHeight:"90%",verticalScroll:!0,stack:!1,showMajorLabels:!0,showCurrentTime:!1,zoomMin:10,zoomable:!0,type:"background",margin:{item:0,axis:0},format:{minorLabels:{minute:"h:mma",hour:"ha"}},itemsAlwaysDraggable:!0,moment:e=>o()(e).utc()}}),(0,y.withPropsOnChange)(["viewRange","options"],(e=>{let{viewRange:t={},options:n}=e;return{options:{...n,...t}}})),(0,y.withPropsOnChange)(["status"],(e=>{let{status:t}=e;return{readOnly:"PLAY"===t}})),(0,y.withPropsOnChange)(["items"],(e=>{let{items:t,options:n}=e;return{options:{...n,...A()(t,{className:"interval"})&&{stack:!0}}}})),F,(0,B.Z)((e=>{let{loading:t}=e;return t&&t.timeline}),(()=>p().createElement("div",{style:{margin:"auto",fontWeight:"bold"}},p().createElement(W.Z,{style:{display:"inline-block",verticalAlign:"middle"}}),p().createElement(O.Z,{msgId:"loading"}))),{white:!0}))((0,x.Z)()((0,m.lazy)((()=>Promise.all([n.e(9824),n.e(4328)]).then(n.bind(n,875990))))));var te=n(49977),ne=n.n(te),ae=n(832979),ie=n(23888);function re(){return re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},re.apply(this,arguments)}const le=(0,y.compose)((0,y.withProps)({collapseHintPopoverOptions:{placement:"top",props:{title:p().createElement("span",null,p().createElement(u.Glyphicon,{glyph:"time"})," ",p().createElement("strong",null,p().createElement(O.Z,{msgId:"timeline.collapsed.title"})))},content:p().createElement(O.Z,{msgId:"timeline.collapsed.tooltip"})}}),(0,y.mapPropsStream)((e=>e.combineLatest((e=>e.distinctUntilKeyChanged("collapsed").filter((e=>{let{collapsed:t}=e;return t})).take(1).switchMap((e=>{let{collapseHintPopoverOptions:t}=e;return ne().Observable.timer(5e3).startWith({popoverOptions:t}).concat(ne().Observable.of({}))})).startWith({}))(e),((e,t)=>({...e,...t}))))),(0,y.branch)((e=>{let{popoverOptions:t}=e;return t}),ae.Z,T.Z))(ie.Z),se=(0,y.compose)((0,g.connect)((0,f.P1)(I.zb,I.qJ,((e,t)=>({collapsed:e,visible:t}))),{setCollapsed:v.w2}),(0,y.branch)((e=>{let{visible:t}=e;return!t}),y.renderNothing),(0,y.withHandlers)({onClick:e=>{let{collapsed:t,setCollapsed:n}=e;return()=>n(!t)}}),(0,y.withProps)((e=>{let{collapsed:t}=e;return{bsStyle:t?"primary":"success",tooltipId:t?"timeline.show":"timeline.hide"}})))((e=>p().createElement(le,re({},e,{bsSize:"xsmall"}),p().createElement(u.Glyphicon,{glyph:"time"}))));var oe=n(399790),ce=n(89518);function de(){return de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},de.apply(this,arguments)}const me=(0,T.Z)(ie.Z),pe=e=>l()(e)&&-1!==e.indexOf("%"),ue=e=>parseInt(e,10)/100,ge=(e,t)=>o()(t).diff(e)>0,ye=(0,y.compose)((0,g.connect)((0,f.P1)(I.pn,I.rV,P.WT,I.m_,P.RP,E.KC,E.dS,I.YK,(e=>void 0!==e.timeline?.loader),I.Li,((e,t,n,a,i,r,l,s,o,c)=>({visible:e,layers:t,currentTime:n,currentTimeRange:a,offsetEnabled:i,playbackRange:r,status:l,viewRange:s,timelineIsReady:o,selectedLayer:c}))),{setCurrentTime:v.HM,onOffsetEnabled:v.PQ,setOffset:b.pF,setPlaybackRange:h.VS,moveRangeTo:v.y3,onInit:v._e,reset:v.FE}),(0,y.branch)((e=>{let{visible:t=!0,layers:n=[]}=e;return!t||0===Object.keys(n).length}),y.renderNothing),(0,y.withState)("options","setOptions",(e=>{let{expandedPanel:t}=e;return{collapsed:!t}})),(0,g.connect)((0,f.P1)(I.cX,(e=>({mapSync:e}))),{toggleMapSync:v.Z7}),(0,y.compose)((0,y.compose)((0,y.withStateHandlers)((()=>({})),{onResize:()=>e=>{let{width:t}=e;return{containerWidth:t}}}),(0,S.Z)({querySelector:".ms2",closest:!0,debounceTime:100})),(0,y.defaultProps)({showHiddenLayers:!1,expandLimit:20,snapType:"start",endValuesSupport:void 0,style:{marginBottom:35,marginLeft:100,marginRight:80}}),(0,g.connect)((0,f.P1)((e=>(0,k.ic)(e,{right:!0,bottom:!0,left:!0})),(e=>({mapLayoutStyle:e})))),(0,y.withProps)((e=>{let{containerWidth:t,style:n,mapLayoutStyle:a}=e;const{marginLeft:i,marginRight:r}=n||{};let{left:l=0,right:s=0}=a;if(s=pe(s)&&ue(s)*t||s,l=pe(l)&&ue(l)*t||l,t){const e=t-s-l-i-r;return{hide:e<410,compactToolbar:e<880,style:{...n,...a,minWidth:410}}}return{style:{...n,...a,minWidth:410}}})),(0,y.branch)((e=>{let{hide:t}=e;return t}),y.renderNothing),(0,y.setDisplayName)("TimelinePlugin")))((e=>{let{items:t,options:n,setOptions:a,mapSync:r,toggleMapSync:l=(()=>{}),currentTime:s,setCurrentTime:c,offsetEnabled:d,onOffsetEnabled:g,currentTimeRange:y,setOffset:f,style:b,status:h,viewRange:v,moveRangeTo:T,compactToolbar:S,showHiddenLayers:P,expandLimit:k,snapType:E,endValuesSupport:I,onInit:R=(()=>{}),layers:C,timelineIsReady:D,initialMode:M="single",initialSnap:Z="now",resetButton:N,reset:V=(()=>{}),selectedLayer:A}=e;(0,m.useEffect)((()=>{R({showHiddenLayers:P,expandLimit:k,snapType:E,endValuesSupport:I,initialMode:M,initialSnap:Z})}),[R]);const{hideLayersName:x,collapsed:H}=n,B=i()(t&&t.filter((e=>"playback"===e.name))),W=B&&B.plugin,Y=(e,t,n,a)=>{const i=o()(n.end).diff(n.start)/2;if("time-current"===t&&n&&n.start.toString()!==o()(e).add(-1*i).toString()&&n.end.toString()!==o()(e).add(i).toString()&&T({start:o()(e).add(-1*i),end:o()(e).add(i)}),"range-start"===t||"range-end"===t){const e=o()(a.end).diff(a.start),t=o()(a.start).add(e/2);T(e/2<=i?{start:o()(t).add(-1*i),end:o()(t).add(i)}:{start:o()(t).add(-1*e*5/2),end:o()(t).add(5*e/2)})}};return p().createElement("div",{style:{position:"absolute",marginBottom:35,marginLeft:100,...b,right:H?"auto":b.right||0},className:`timeline-plugin${x?" hide-layers-name":""}${d?" with-time-offset":""} ${(0,oe.ab)(C)?"":"hidden"}`},d&&p().createElement(L.Z,{clickable:!H,glyph:"range-start",onIconClick:(e,t)=>"PLAY"!==h&&Y(e,t,v,y),tooltip:p().createElement(O.Z,{msgId:"timeline.rangeStart"}),showButtons:!0,date:s||y&&y.start,onUpdate:e=>(y&&ge(e,y.end)||!y)&&"PLAY"!==h&&c(e),className:"shadow-soft",style:{position:"absolute",top:-5,left:2,transform:"translateY(-100%)"}}),p().createElement("div",{className:"timeline-plugin-toolbar"+(S?" ms-collapsed":"")},d&&y?p().createElement(L.Z,{clickable:!H,glyph:"range-end",onIconClick:(e,t)=>"PLAY"!==h&&Y(e,t,v,y),tooltip:p().createElement(O.Z,{msgId:"timeline.rangeEnd"}),date:y.end,showButtons:!0,onUpdate:e=>"PLAY"!==h&&ge(s,e)&&f(e)}):p().createElement(L.Z,{clickable:!H,glyph:"time-current",showButtons:!0,onIconClick:(e,t)=>"PLAY"!==h&&Y(e,t,v),tooltip:p().createElement(O.Z,{msgId:"timeline.currentTime"}),date:s||y&&y.start,onUpdate:e=>(y&&ge(e,y.end)||!y)&&"PLAY"!==h&&c(e)}),p().createElement("div",{className:"timeline-plugin-btn-group"},p().createElement(w.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"list",tooltip:p().createElement(O.Z,{msgId:x?"timeline.showLayerName":"timeline.hideLayerName"}),bsStyle:x?"primary":"success",visible:!H,active:!x,onClick:()=>a({...n,hideLayersName:!x})},{glyph:"time-offset",bsStyle:d?"success":"primary",active:d,disabled:"PLAY"===h,tooltip:p().createElement(O.Z,{msgId:d?"timeline.disableRange":"timeline.enableRange"}),onClick:()=>{"PLAY"!==h&&g(!d)}},{glyph:"viewport-filter",tooltip:p().createElement(O.Z,{msgId:r?"timeline.mapSyncOn":"timeline.mapSyncOff"}),bsStyle:r?"success":"primary",active:r,onClick:()=>l(!r)},{glyph:d?"resize-horizontal":"time",visible:!!N,tooltip:p().createElement(O.Z,{msgId:"timeline.reset."+(d?"range":A?"singleNearest":"singleNow")}),bsStyle:"primary",onClick:V}]}),W&&p().createElement(W,de({},B,{settingsStyle:{right:H||S?40:"unset"}}))),p().createElement(me,{onClick:()=>a({...n,collapsed:!H}),className:"square-button-sm ms-timeline-expand",bsStyle:"primary",tooltip:p().createElement(O.Z,{msgId:H?"timeline.expand":"timeline.collapse"})},p().createElement(u.Glyphicon,{glyph:H?"chevron-up":"chevron-down"}))),!D&&p().createElement("div",{className:"timeline-loader"},p().createElement(ce.Z,{size:50})),!H&&p().createElement(ee,{offsetEnabled:d,playbackEnabled:!0,hideLayersName:x,timelineLayers:C}))})),fe={TimelinePlugin:d()(ye,{disablePluginIf:"{state('mapType') === 'cesium'}",WidgetsTray:{tool:p().createElement(se,null),position:0}}),reducers:{dimension:n(811974).Z,timeline:n(729536).Z},epics:n(169988).ZP}},729536:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var a=n(333101),i=n(687753),r=n(69371),l=n(926854),s=n(481151),o=n(521923),c=n(328583),d=n.n(c),m=n(535937),p=n.n(m),u=n(218721),g=n.n(u);const y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{settings:{autoSelect:!0,collapsed:!1,snapType:"start",snapRadioButtonEnabled:!1}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.M5:return(0,o.t8)("settings.collapsed",t.collapsed,e);case r.w:return(0,o.t8)("settings.mapSync",t.mapSync,e);case r.lz:return(0,o.t8)("settings.snapType",t.snapType,e);case r.Wb:return(0,o.t8)("settings.endValuesSupport",t.endValuesSupport,e);case r.Lv:return(0,o.t8)("range",{start:t.start,end:t.end},e);case r.iv:return(0,o.t8)(`rangeData[${t.layerId}]`,{range:t.range,histogram:t.histogram,domain:t.domain},e);case r.br:return t.layerId?(0,o.t8)(`loading[${t.layerId}]`,t.loading,e):(0,o.t8)("loading.timeline",t.loading,e);case r._V:{let n=e;return n=(0,o.t8)("selectedLayer",t.layerId,n),n=(0,o.t8)("settings",{...n.settings,snapType:"start",snapRadioButtonEnabled:!1},n),n}case r.AE:case s.AN:{const n=t.timeIntervalData??t.snapRadioButtonEnabled;return(0,o.t8)("settings.snapRadioButtonEnabled",n,e)}case r.Xe:return(0,o.t8)("selectedLayer",t.layerId,e);case a.sb:{let n=e;return d()({},e,{rangeData:g()(n.rangeData,t.node)?p()(n.rangeData,((e,n)=>n!==t.node)):n.rangeData,loading:g()(n.rangeData,t.node)?p()(n.loading,((e,n)=>n!==t.node)):n.loading,selectedLayer:e.selectedLayer===t.node?void 0:e.selectedLayer})}case i.l:return d()({},e,{range:void 0,rangeData:void 0,selectedLayer:void 0,loading:void 0,MouseEvent:void 0,layers:void 0});case r.p:{const n=e?.settings?.endValuesSupport,a=e?.settings?.snapRadioButtonEnabled,i=t?.config;return(0,o.t8)("settings",{...e.settings,showHiddenLayers:i.showHiddenLayers,expandLimit:i.expandLimit,snapType:i.snapType,endValuesSupport:n??i.endValuesSupport,snapRadioButtonEnabled:a??i.snapRadioButtonEnabled,initialMode:i.initialMode,initialSnap:i.initialSnap},e)}case l.ok:return{...e,settings:{...e.settings,endValuesSupport:t?.config?.timelineData?.endValuesSupport,snapRadioButtonEnabled:t?.config?.timelineData?.snapRadioButtonEnabled}};case r.xp:return(0,o.t8)("layers",t.layers,e);case r.i9:return(0,o.t8)("layers",(e.layers||[]).map((e=>Object.keys(e)?.find((e=>e===t.id))?(0,o.t8)(`${t.id}`,{hideInTimeline:!t.checked},e):e)),e);default:return e}}},105076:(e,t,n)=>{var a=n(989881);e.exports=function(e,t){var n;return a(e,(function(e,a,i){return!(n=t(e,a,i))})),!!n}},170735:(e,t,n)=>{var a=n(920731),i=n(121078),r=n(267206),l=n(105976),s=n(229246),o=n(610928),c=l((function(e,t){var n=o(t);return s(n)&&(n=void 0),s(e)?a(e,i(t,1,s,!0),r(n,2)):[]}));e.exports=c},359704:(e,t,n)=>{var a=n(282908),i=n(267206),r=n(105076),l=n(701469),s=n(816612);e.exports=function(e,t,n){var o=l(e)?a:r;return n&&s(e,t,n)&&(t=void 0),o(e,i(t,3))}}}]);