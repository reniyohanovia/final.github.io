(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[9972],{768977:(e,t,o)=>{"use strict";o.d(t,{Z:()=>h});var n=o(45697),r=o.n(n),s=o(124852),i=o.n(s),a=o(630294),l=o(222777);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},p.apply(this,arguments)}function c(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class d extends i().Component{render(){const{cardComponent:e,items:t,colProps:o,onItemClick:n,size:r}=this.props,s=e||l.Z;return i().createElement("div",{className:"msSideGrid"+(this.props.className?" "+this.props.className:"")},i().createElement(a.Row,{className:"items-list"},t.map(((e,t)=>i().createElement(a.Col,p({key:e.id||t},o),i().createElement(s,p({onClick:function(){for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return n(e,...o)},size:r},e)))))))}}c(d,"propTypes",{size:r().string,onItemClick:r().func,colProps:r().object,items:r().array,cardComponent:r().oneOfType([r().string,r().func]),className:r().string}),c(d,"defaultProps",{size:"",onItemClick:()=>{},colProps:{xs:12},className:"",items:[]});const h=d},670186:(e,t,o)=>{"use strict";o.d(t,{Z:()=>u});var n=o(124852),r=o.n(n),s=o(45697),i=o.n(s),a=o(747037),l=o.n(a),p=o(366757),c=o.n(p),d=o(119950);function h(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class m extends r().Component{constructor(){super(...arguments),h(this,"paint",(e=>{e.save(),e.beginPath();const{color:t,fill:o}=this.props.shapeStyle;switch(e.fillStyle=o?l()(o)?o:`rgba(${o.r}, ${o.g}, ${o.b}, ${o.a})`:null,e.strokeStyle=t?l()(t)?t:`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`:null,e.lineWidth=this.props.shapeStyle.width||this.props.shapeStyle.weight,this.props.shapeStyle.dashArray&&this.props.shapeStyle.dashArray.length&&e.setLineDash(this.props.shapeStyle.dashArray),this.props.geomType){case"Polygon":this.paintPolygon(e);break;case"Polyline":this.paintPolyline(e);break;case"Point":this.paintPoint(e,this.props.shapeStyle.markName);break;case"Circle":this.paintPoint(e,"circle");break;case"Marker":this.paintMarker(e);break;case"Text":this.paintText(e);break;case"Symbol":this.paintSymbol(e);break;default:return}e.restore()})),h(this,"drawSymbol",((e,t)=>{t.clearRect(0,0,600,600);let n=new Image,r=new Image;r.src=o(264372),n.src=e||this.props.shapeStyle.symbolUrl,n.onload=()=>{try{t.drawImage(n,this.props.width/2-n.width/2,this.props.height/2-n.height/2)}catch(e){return}},n.onerror=()=>{r.onload=()=>{try{t.drawImage(r,this.props.width/2-r.width/2,this.props.height/2-r.height/2)}catch(e){return}}}})),h(this,"paintSymbol",(e=>{(0,d.isSymbolStyle)(this.props.originalStyle)?this.props.originalStyle.symbolUrlCustomized&&this.props.originalStyle.symbolUrl?this.drawSymbol(this.props.originalStyle.symbolUrlCustomized,e):(0,d.createSvgUrl)(this.props.originalStyle,this.props.originalStyle.symbolUrlCustomized||this.props.originalStyle.symbolUrl).then((t=>this.drawSymbol(t,e))):this.drawSymbol(null,e)})),h(this,"paintText",(e=>{const{width:t,height:o}=this.props,{textAlign:n="center",label:r,font:s="14px Arial"}=this.props.shapeStyle;return e.textAlign=n,e.font=s,"start"===n?(e.strokeText(r||"New",t/2.5,o/2),void e.fillText(r||"New",t/2.5,o/2)):"end"===n?(e.strokeText(r||"New",t/1.5,o/2),void e.fillText(r||"New",t/1.5,o/2)):(e.strokeText(r||"New",t/2,o/2),void e.fillText(r||"New",t/2,o/2))})),h(this,"paintPolygon",(e=>{e.transform(1,0,0,1,-27.5,0),e.moveTo(55,8),e.lineTo(100,8),e.lineTo(117.5,40),e.lineTo(100,72),e.lineTo(55,72),e.lineTo(37.5,40),e.closePath(),e.fill(),e.stroke()})),h(this,"paintPolyline",(e=>{e.transform(1,0,0,1,0,0),e.moveTo(10,20),e.bezierCurveTo(40,40,70,0,90,20),e.stroke()})),h(this,"paintPoint",((e,t)=>{let o=this.props.shapeStyle.radius,n=o/2;switch(t){case"square":e.rect(50-n,48.5-n,o,o);break;case"circle":e.arc(50,48.5,n,0,2*Math.PI);break;case"triangle":{let t=Math.sqrt(3)*o/2/3;e.moveTo(50,48.5-2*t),e.lineTo(50+n,48.5+t),e.lineTo(50-n,48.5+t),e.closePath();break}case"star":this.paintStar(e,50,48.5,5,n,n/2);break;case"cross":this.paintCross(e,50,48.5,o,.23);break;case"x":e.translate(50,48.5),e.rotate(45*Math.PI/180),e.translate(-50,-48.5),this.paintCross(e,50,48.5,o,.23);break;default:e.arc(50,48.5,o,0,2*Math.PI)}e.fill(),e.stroke()})),h(this,"paintMarker",(e=>{let t=new Image;t.src=c();try{e.drawImage(t,42.5,24)}catch(e){return}})),h(this,"paintStar",(function(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,i=Math.PI/2*3,a=t,l=o;const p=Math.PI/n;e.moveTo(t,o-r);for(let c=0;c<n;c++)a=t+Math.cos(i)*r,l=o+Math.sin(i)*r,e.lineTo(a,l),i+=p,a=t+Math.cos(i)*s,l=o+Math.sin(i)*s,e.lineTo(a,l),i+=p;e.lineTo(t,o-r),e.closePath()})),h(this,"paintCross",((e,t,o,n,r)=>{const s=n*r/2,i=n/2;e.moveTo(t-s,o-i),e.lineTo(t+s,o-i),e.lineTo(t+s,o-s),e.lineTo(t+i,o-s),e.lineTo(t+i,o+s),e.lineTo(t+s,o+s),e.lineTo(t+s,o+i),e.lineTo(t-s,o+i),e.lineTo(t-s,o+s),e.lineTo(t-i,o+s),e.lineTo(t-i,o-s),e.lineTo(t-s,o-s),e.closePath()}))}componentDidMount(){let e=this.refs.styleCanvas.getContext("2d");e.clearRect(0,0,this.props.width||500,this.props.height||500),this.paint(e)}componentDidUpdate(){let e=this.refs.styleCanvas.getContext("2d");e.clearRect(0,0,this.props.width||500,this.props.height||500),this.paint(e)}render(){return r().createElement("canvas",{ref:"styleCanvas",style:this.props.style,width:this.props.width,height:this.props.height})}}h(m,"propTypes",{originalStyle:i().object,style:i().object,shapeStyle:i().object,geomType:i().oneOf(["Polygon","Polyline","Point","Marker","Text","Symbol","Circle",void 0]),width:i().number,height:i().number}),h(m,"defaultProps",{originalStyle:{},style:{},shapeStyle:{},geomType:"Polygon",width:100,height:80});const u=m},392021:(e,t,o)=>{"use strict";o.d(t,{Z:()=>h});var n=o(45697),r=o.n(n),s=o(124852),i=o.n(s),a=o(743129),l=o(598611),p=o.n(l);function c(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class d extends i().Component{constructor(){super(...arguments),c(this,"styleRenderer",((e,t,o)=>{const n=this.props.styleRendererPattern||i().createElement("svg",{style:{height:33,width:"100%"},viewBox:"0 0 300 25"},i().createElement("path",{className:"ms-dash-array",strokeWidth:this.props.defaultStrokeWidth,strokeDasharray:o||e.value,d:"M0 12.5, 300 12.5"}));return i().createElement("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingRight:25}},n)}))}render(){const e=p()(this.props.dashArray||"1 0"," "),t=this.props.options.find((t=>t.value===e))?this.props.options:[{value:e},...this.props.options],o=this.props.creatable?a.ZP.Creatable:a.ZP;return i().createElement(o,{options:t,disabled:this.props.disabled,menuPlacement:this.props.menuPlacement,clearable:this.props.clearable,optionRenderer:this.props.optionRenderer||this.styleRenderer,valueRenderer:this.props.valueRenderer||this.styleRenderer,value:e,isValidNewOption:this.props.isValidNewOption,onChange:e=>{if(e){const t=e.value.split(" ");this.props.onChange(t)}}})}}c(d,"propTypes",{dashArray:r().array,menuPlacement:r().string,clearable:r().bool,value:r().string,optionRenderer:r().func,styleRendererPattern:r().node,valueRenderer:r().func,disabled:r().bool,onChange:r().func,options:r().array,creatable:r().bool,isValidNewOption:r().func,defaultStrokeWidth:r().number}),c(d,"defaultProps",{dashArray:["1","0"],menuPlacement:"top",clearable:!1,onChange:()=>{},options:[{value:"1 0"},{value:"10 50 30"},{value:"6 6"},{value:"20 20"},{value:"30 30"}],defaultStrokeWidth:4});const h=d},173581:(e,t,o)=>{"use strict";o.d(t,{Z:()=>r});var n=o(124852);const r=(0,o(297977).Z)()((0,n.lazy)((()=>Promise.all([o.e(1167),o.e(9715)]).then(o.bind(o,439715)))))},42215:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>vo});var n=o(124852),r=o.n(n),s=o(727418),i=o.n(s),a=o(45697),l=o.n(a),p=o(22222),c=o(441609),d=o.n(c),h=o(152543),m=o(687753),u=o(91175),g=o.n(u),y=o(623560),f=o.n(y),b=o(352353),v=o.n(b),S=o(630294),E=o(173581),C=o(363082),w=o(454295),T=o(804504),P=o(16246),x=o(466737),k=o(8204),O=o(409669),j=o.n(O),M=o(984596),F=o.n(M),Z=o(763105),N=o.n(Z),I=o(313311),A=o.n(I),G=o(630998),U=o.n(G),D=o(414293),B=o.n(D),R=o(717621),V=o.n(R),L=o(423570),z=o.n(L),W=o(521923),H=o(119950),_=o(569291),Y=o(670186),$=o(509886),q=o.n($),Q=o(908956),X=o(147814);function J(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}q()();class K extends r().Component{render(){const{style:e}=this.props;return r().createElement("div",null,r().createElement(S.Row,null,r().createElement(S.Col,{xs:12},r().createElement("strong",null,r().createElement(T.Z,{msgId:"draw.fill"})))),r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.color"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement(X.Z,{color:(0,H.addOpacityToColor)(V()(e.fillColor||this.props.defaultColor).toRgb(),e.fillOpacity),width:this.props.width,onChangeColor:t=>{if(!B()(t)){const o=V()(t).toHexString(),n=t.a;this.props.onChange(e.id,{fillColor:o,fillOpacity:n})}}}))),r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.opacity"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement(Q.Z,{opacity:e.fillOpacity,onChange:t=>{this.props.onChange(e.id,{fillOpacity:t})}}))))}}J(K,"propTypes",{style:l().object,defaultColor:l().string,onChange:l().func,width:l().number}),J(K,"defaultProps",{style:{},onChange:()=>{}});const ee=K;var te=o(603754),oe=o(424471);function ne(e){let{disabled:t,containerNode:o,onOpen:n,placement:s,children:i,triggerNode:a}=e;const l=t?" ms-disabled":"";return r().createElement(oe.Z,{containerNode:o,placement:s,disabled:t,onOpen:e=>n(e),content:r().createElement("div",{className:"ms-picker-node shadow-soft"},i)},r().createElement("div",{className:`ms-property-picker${l}`},r().createElement("div",{className:"ms-property-picker-swatch",style:{padding:0,boxShadow:"none"}},a)))}ne.propTypes={value:l().oneOfType([l().string,l().shape({r:l().number,g:l().number,b:l().number,a:l().number})]),format:l().string,onChangeColor:l().func,text:l().string,line:l().bool,disabled:l().bool,pickerProps:l().object,containerNode:l().node,onOpen:l().function,placement:l().string},ne.defaultProps={disabled:!1,line:!1,onChangeColor:()=>{},pickerProps:{},onOpen:()=>{}};const re=ne;function se(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class ie extends r().Component{constructor(){var e;super(...arguments),e=this,se(this,"renderMarkers",(function(t){return t.map((t=>t.markers?e.renderMarkers(t.markers,t.name+"-"):r().createElement("div",{onClick:()=>e.selectStyle(t),className:e.isCurrentStyle(t)?"ms-marker-selected":"",style:{...t.thumbnailStyle}})))})),se(this,"isCurrentStyle",(e=>this.props.markersOptions.markersConfig.matches(this.props.style,e.style))),se(this,"selectStyle",(e=>this.props.onChange(this.props.style.id,{...this.props.markersOptions.markersConfig.getStyle(e.style)}))),se(this,"filterMarkerGlyph",(e=>e&&-1!==e.toLowerCase().indexOf(this.props.markersOptions?.filter?.toLowerCase()||"")))}render(){const e=this.props.markersOptions.markers.reduce(((e,t)=>{let{markers:o}=t;return[...e,...o]}),[]).find((e=>this.isCurrentStyle(e)))||{};return r().createElement("div",{className:"marker-container"},r().createElement("div",{className:"marker-icon"},r().createElement("div",{style:{flex:1}},r().createElement(T.Z,{msgId:"draw.marker.icon"})),r().createElement("div",{style:{flex:1}},r().createElement(re,{triggerNode:r().createElement("div",{style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,cursor:"pointer",margin:"auto"}},r().createElement("i",{className:`fa fa-${this.props.style.iconGlyph}`}))},r().createElement("div",{className:"ms-marker-icon-content",style:{width:256,height:256,overflow:"auto",position:"relative"}},r().createElement("div",{style:{position:"sticky",top:0}},r().createElement(te.Z,{filterPlaceholder:"Filter icons...",filterText:this.props.markersOptions.filter,onFilter:this.props.markersOptions.onFilterMarker})),r().createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center"}},this.props.markersOptions.glyphs.map((e=>this.filterMarkerGlyph(e)?r().createElement("div",{className:e===this.props.style.iconGlyph?"ms-marker-selected":"",style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,cursor:"pointer"},onClick:()=>{this.props.onChange(this.props.style.id,{iconGlyph:e})}},r().createElement("i",{className:`fa fa-${e}`})):null))))))),r().createElement("div",{className:"marker-shape"},r().createElement("div",{style:{flex:1}},r().createElement(T.Z,{msgId:"draw.marker.shape"})),r().createElement("div",{style:{flex:1}},r().createElement(re,{triggerNode:r().createElement("div",{style:{...e.thumbnailStyle,margin:"auto"}})},r().createElement("div",{className:"ms-marker-shape-content",style:{display:"flex",flexWrap:"wrap",justifyContent:"center",width:256,height:256,overflow:"auto"}},this.renderMarkers(this.props.markersOptions.markers))))))}}se(ie,"propTypes",{style:l().object,markersOptions:l().object,onChange:l().func,width:l().number}),se(ie,"defaultProps",{style:{},onChange:()=>{}});const ae=ie;var le=o(743129);function pe(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class ce extends r().Component{render(){return r().createElement("div",null,r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement("strong",null,r().createElement(T.Z,{msgId:"draw.marker.type"}))),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement(le.ZP,{clearable:!1,options:this.props.options,value:this.props.pointType||"marker",onChange:e=>{const t=e&&e.value;this.props.onChangeType(this.props.style.id,t)}}))))}}pe(ce,"propTypes",{style:l().object,pointType:l().string,options:l().array,onChangeType:l().func,width:l().number}),pe(ce,"defaultProps",{style:{},options:[{label:"Marker",value:"marker"},{label:"Symbol",value:"symbol"}],pointType:"marker",onChangeType:()=>{}});const de=ce;var he=o(701469),me=o.n(he),ue=o(618446),ge=o.n(ue),ye=o(981537);function fe(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class be extends r().Component{constructor(){super(...arguments),fe(this,"loadSymbolsList",(e=>{const t=this.props.symbolsPath+"symbols.json";j().get(t,{"Content-type":"application/json"}).then((t=>{let{data:o}=t;me()(o)?this.props.onUpdateOptions(o.map((e=>({label:e.label||e.name,value:e.name,symbolUrl:this.props.symbolsPath+e.name+".svg?_t="+Math.random()}))),!0):this.props.onUpdateOptions([{label:e,value:e,symbolUrl:this.props.symbolsPath+e+".svg"}]),this.checkSymbolUrl(this.props),this.props.onChange(this.props.style.id);const n=this.props.symbolErrors.length?N()(this.props.symbolErrors,(e=>"loading_symbols_path"!==e)):[];this.props.onLoadingError(n)})).catch((()=>{(0,C.ZA)(this.props.symbolErrors)||this.props.onLoadingError(this.props.symbolErrors.concat(["loading_symbols_path"]))})),this.forceUpdate()})),fe(this,"checkSymbolUrl",(e=>{let{style:t,symbolErrors:o,onLoadingError:n}=e;j().get(t.symbolUrl).then((()=>{let e=o.length?N()(o,(e=>e!=="loading_symbol"+t.shape)):[];e=e.length?N()(e,(e=>"loading_symbols_path"!==e)):[],n(e)})).catch((()=>{(0,C.ZA)(this.props.symbolErrors,"loading_symbol"+t.shape)||n(o.concat(["loading_symbol"+t.shape]))}))}))}UNSAFE_componentWillMount(){if(me()(this.props.options)&&0===this.props.options.length){const e=this.props.options&&this.props.options.length?A()(this.props.options,(e=>e.value===this.props.defaultShape))&&this.props.defaultShape:C.xw;this.loadSymbolsList(e)}}UNSAFE_componentWillReceiveProps(e){if(ge()(e.style,this.props.style)||this.checkSymbolUrl(e),!ge()(e.symbolErrors,this.props.symbolErrors)){const e=this.props.options&&this.props.options.length?A()(this.props.options,(e=>e.value===this.props.defaultShape))&&this.props.defaultShape:C.xw;this.loadSymbolsList(e)}}render(){const e=e=>r().createElement("div",{style:{display:"flex",alignItems:"center"}},r().createElement("img",{src:e.symbolUrl||e.iconUrl,width:15,height:15}),r().createElement("span",{style:{flex:1,paddingLeft:4}}," ",e.label)),t=this.props.options&&this.props.options.length?A()(this.props.options,(e=>e.value===this.props.defaultShape))&&this.props.defaultShape:C.xw;return r().createElement("div",null,r().createElement(S.Row,null,r().createElement(S.Col,{xs:12},r().createElement(T.Z,{msgId:"draw.marker.layout"}))),(0,C.ZA)(this.props.symbolErrors)?r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.marker.shape"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement(S.Alert,{bsStyle:"warning"},r().createElement(T.Z,{msgId:"annotations.errorLoadingSymbols"})))):r().createElement("div",null,r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.marker.shape"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement(S.InputGroup,null,r().createElement(le.ZP,{clearable:!1,options:this.props.options,value:this.props.style.shape,onChange:e=>{const t=e&&e.value;this.props.onChange(this.props.style.id,{symbolUrl:this.props.symbolsPath+t+".svg",shape:t})},optionRenderer:e,valueRenderer:e}),r().createElement(S.InputGroup.Addon,{className:"btn",onClick:()=>this.loadSymbolsList(t)},r().createElement(S.Glyphicon,{glyph:"refresh"}))))),!((0,C.ZA)(this.props.symbolErrors,"loading_symbol"+this.props.style.shape)||(0,C.ZA)(this.props.symbolErrors,"loading_symbol"+this.props.defaultShape))&&r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.marker.size"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement("div",{className:"mapstore-slider with-tooltip"},r().createElement(ye.Z,{tooltips:!0,step:1,start:[this.props.style.size||this.props.defaultShapeSize],format:{from:e=>Math.round(e),to:e=>Math.round(e)+" px"},range:{min:1,max:64},onChange:e=>{const t=parseInt(e[0].replace(" px",""),10);this.props.onChange(this.props.style.id,{size:t})}}))))))}}fe(be,"propTypes",{style:l().object,options:l().array,defaultShape:l().string,defaultShapeSize:l().number,onChange:l().func,onUpdateOptions:l().func,onLoadingError:l().func,symbolErrors:l().array,width:l().number,symbolsPath:l().string}),fe(be,"contextTypes",{messages:l().object}),fe(be,"defaultProps",{symbolsPath:C.Fi,style:{},defaultShape:C.xw,defaultShapeSize:64,options:[],symbolErrors:[],onChange:()=>{},onUpdateOptions:()=>{}});const ve=be;var Se=o(185552),Ee=o.n(Se),Ce=o(392021);function we(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}q()();class Te extends r().Component{shouldComponentUpdate(e){return!ge()(this.props.style,e.style)||!ge()(this.props.lineDashOptions,e.lineDashOptions)}render(){const{style:e}=this.props;return r().createElement("div",null,r().createElement(S.Row,null,r().createElement(S.Col,{xs:12},r().createElement("strong",null,r().createElement(T.Z,{msgId:"draw.stroke"})))),r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.lineDash"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement(Ce.Z,{options:this.props.lineDashOptions,dashArray:e.dashArray,onChange:t=>{this.props.onChange(e.id,{dashArray:t})}}))),r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.color"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement(X.Z,{color:(0,H.addOpacityToColor)(V()(e.color||this.props.defaultColor).toRgb(),e.opacity),width:this.props.width,onChangeColor:t=>{if(!B()(t)){const o=V()(t).toHexString(),n=t.a;this.props.onChange(e.id,{color:o,opacity:n})}}}))),r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.opacity"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement(Q.Z,{opacity:B()(e.opacity)?.2:e.opacity,onChange:t=>{this.props.onChange(e.id,{opacity:t})}}))),r().createElement(S.Row,null,r().createElement(S.Col,{xs:6},r().createElement(T.Z,{msgId:"draw.width"})),r().createElement(S.Col,{xs:6,style:{position:"static"}},r().createElement("div",{className:"mapstore-slider with-tooltip"},r().createElement(Ee(),{tooltips:!0,step:1,start:[e.weight||e.width||1],format:{from:e=>Math.round(e),to:e=>Math.round(e)+" px"},range:{min:B()(this.props.constraints&&this.props.constraints.minWidth)?1:this.props.constraints.maxWidth,max:this.props.constraints&&this.props.constraints.maxWidth||15},onChange:t=>{const o=parseInt(t[0].replace(" px",""),10);this.props.onChange(e.id,{weight:o})}})))))}}we(Te,"propTypes",{style:l().object,defaultColor:l().string,lineDashOptions:l().array,onChange:l().func,width:l().number,constraints:l().object}),we(Te,"defaultProps",{style:{},constraints:{maxWidth:15,minWidth:1},onChange:()=>{}});const Pe=Te;var xe=o(200020),ke=o(481330),Oe=o(719648);function je(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}q()();class Me extends r().Component{constructor(){super(...arguments),je(this,"state",{fontFamily:"Arial"})}render(){const e={emptyList:(0,Oe.S$)(this.context.messages,"queryform.attributefilter.autocomplete.emptyList"),open:(0,Oe.S$)(this.context.messages,"queryform.attributefilter.autocomplete.open"),emptyFilter:(0,Oe.S$)(this.context.messages,"queryform.attributefilter.autocomplete.emptyFilter")},{style:t}=this.props;return r().createElement("div",{className:"ms-text-style"},r().createElement("div",{className:"content"},r().createElement("strong",null,r().createElement(T.Z,{msgId:"draw.fontTitle"}))),r().createElement("div",{className:"content"},r().createElement("div",{className:"left"},r().createElement(T.Z,{msgId:"draw.font.family"})),r().createElement("div",{className:"right"},r().createElement(xe.Combobox,{value:this.state.fontFamily||"Arial",textField:"value",valueField:"value",messages:e,data:this.props.fontFamilyValues,onChange:e=>{let o=e.value?e.value:e;""===o&&(o="Arial"),this.setState({fontFamily:o});const n=(0,C.vh)({...t,fontFamily:o});this.props.onChange(t.id,{fontFamily:o,font:n})}}))),r().createElement("div",{className:"content"},r().createElement("div",{className:"left"},r().createElement(T.Z,{msgId:"draw.font.size"})),r().createElement("div",{className:"right",style:{display:"flex"}},r().createElement("div",{className:"left font-size"},r().createElement(ke.Z,{value:t.fontSize||14,placeholder:"",onChange:e=>{const o=e||14,n=(0,C.vh)({...t,fontSize:o});this.props.onChange(t.id,{fontSize:o,font:n})},type:"number"})),r().createElement(xe.Combobox,{className:"font-uom",value:t.fontSizeUom||"px",textField:"value",valueField:"value",messages:e,data:this.props.uomValues,onChange:e=>{let o=e.value?e.value:e;-1===this.props.uomValues.map((e=>e.value)).indexOf(o)&&(o="px");const n=(0,C.vh)({...t,fontSizeUom:o});this.props.onChange(t.id,{fontSizeUom:o,font:n})}}))),r().createElement("div",{className:"content"},r().createElement("div",{className:"left"},r().createElement(T.Z,{msgId:"draw.font.style"})),r().createElement("div",{className:"right"},r().createElement(xe.Combobox,{value:t.fontStyle||"normal",textField:"value",valueField:"value",messages:e,data:this.props.fontStyleValues,onChange:e=>{let o=e.value?e.value:e;-1===this.props.fontStyleValues.map((e=>e.value)).indexOf(o)&&(o=t.fontStyle);const n=(0,C.vh)({...t,fontStyle:o});this.props.onChange(t.id,{fontStyle:o,font:n})}}))),r().createElement("div",{className:"content"},r().createElement("div",{className:"left"},r().createElement(T.Z,{msgId:"draw.font.weight"})),r().createElement("div",{className:"right"},r().createElement(xe.Combobox,{value:t.fontWeight||"normal",textField:"value",valueField:"value",messages:e,data:this.props.fontWeightValues,onChange:e=>{let o=e.value?e.value:e;-1===this.props.fontWeightValues.map((e=>e.value)).indexOf(o)&&(o=t.fontWeight);const n=(0,C.vh)({...t,fontWeight:o});this.props.onChange(t.id,{fontWeight:o,font:n})}}))),r().createElement("div",{className:"content"},r().createElement("div",{className:"left"},r().createElement("strong",null,r().createElement(T.Z,{msgId:"draw.text"})))),r().createElement("div",{className:"content"},r().createElement("div",{className:"left"},r().createElement(T.Z,{msgId:"draw.font.textAlign"})),r().createElement("div",{className:"right"},r().createElement(xe.Combobox,{value:t.textAlign||"center",textField:"label",valueField:"value",messages:e,data:this.props.alignValues,onChange:e=>{let o=e.value?e.value:e;-1===this.props.alignValues.map((e=>e.value)).indexOf(o)&&(o="center"),this.props.onChange(t.id,{textAlign:o})}}))),r().createElement("div",{className:"content"},r().createElement("div",{className:"left"},r().createElement(T.Z,{msgId:"draw.textRotation"})),r().createElement("div",{className:"right"},r().createElement("div",{className:"mapstore-slider with-tooltip"},r().createElement(Ee(),{tooltips:!0,step:this.props.rotationStep,start:[t.textRotationDeg||0],format:{from:e=>Math.round(parseFloat(e)),to:e=>Math.round(e)+" &deg;"},range:{min:0,max:359},onChange:e=>{const o=parseInt(e[0].replace(" &deg;",""),10);this.props.onChange(t.id,{textRotationDeg:o})}})))))}}je(Me,"propTypes",{style:l().object,onChange:l().func,addOpacityToColor:l().func,width:l().number,uomValues:l().array,alignValues:l().array,fontStyleValues:l().array,fontWeightValues:l().array,fontFamilyValues:l().array,shapeStyle:l().object,rotationStep:l().number}),je(Me,"contextTypes",{messages:l().object}),je(Me,"defaultProps",{style:{},onChange:()=>{},uomValues:[{value:"px"},{value:"em"}],fontWeightValues:[{value:"normal"},{value:"bold"}],alignValues:[{value:"start",label:"left"},{value:"center",label:"center"},{value:"end",label:"right"}],fontStyleValues:[{value:"normal"},{value:"italic"}],fontFamilyValues:[{value:"Arial"},{value:"Helvetica"},{value:"sans-serif"},{value:"Courier"}],shapeStyle:{},rotationStep:5});const Fe=Me;function Ze(){return Ze=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Ze.apply(this,arguments)}function Ne(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class Ie extends r().Component{constructor(){var e;super(...arguments),e=this,Ne(this,"state",{}),Ne(this,"renderPanelStyle",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s={style:t,onChange:e.change,width:e.props.width},a=(0,H.isTextStyle)(t)||(0,H.isSymbolStyle)(t),l=!((0,H.isMarkerStyle)(t)||(0,H.isSymbolStyle)(t)&&((0,C.ZA)(e.props.symbolErrors)||(0,C.ZA)(e.props.symbolErrors,"loading_symbol"+t.shape)))&&r().createElement("div",{className:"ms-marker-preview",style:{display:"flex",width:"100%",height:90}},r().createElement(Y.Z,{style:{padding:0,margin:"auto",display:"block",width:a?"100%":"auto",...a&&{transform:"scaleX(2.2) scaleY(2.5)"}},originalStyle:t,shapeStyle:i()({},t,{color:(0,H.addOpacityToColor)(V()(t.color).toRgb(),B()(t.opacity)?1:t.opacity),fill:(0,H.addOpacityToColor)(V()(t.fillColor||"#FFCC33").toRgb(),B()(t.fillOpacity)?1:t.fillOpacity),radius:75}),geomType:(0,H.getStylerTitle)(t),width:a?600:90,height:120})),p=(0,H.isStrokeStyle)(t)&&(0,H.isSymbolStyle)(t)&&((0,C.ZA)(e.props.symbolErrors)||(0,C.ZA)(e.props.symbolErrors,"loading_symbol"+t.shape))?null:(0,H.isStrokeStyle)(t)?r().createElement(Pe,Ze({},s,{defaultColor:e.props.defaultShapeStrokeColor,lineDashOptions:e.props.lineDashOptions,constraints:{maxWidth:(0,H.isSymbolStyle)(t)?5:15},key:"stroke"+n})):null,c=(0,H.isFillStyle)(t)&&(0,H.isSymbolStyle)(t)&&((0,C.ZA)(e.props.symbolErrors)||(0,C.ZA)(e.props.symbolErrors,"loading_symbol"+t.shape))?null:(0,H.isFillStyle)(t)&&r().createElement(ee,Ze({},s,{defaultColor:e.props.defaultShapeFillColor,key:"fill"+n}))||null,d=(0,H.isTextStyle)(t)&&r().createElement(Fe,Ze({},s,{rotationStep:e.props.textRotationStep}))||null,h=((0,H.isMarkerStyle)(t)||(0,H.isSymbolStyle)(t))&&r().createElement(de,Ze({},s,{pointType:(0,H.isSymbolStyle)(t)?"symbol":"marker",onChangeType:e.changeSymbolType}))||null,m=(0,H.isMarkerStyle)(t)&&r().createElement(ae,Ze({},s,{markersOptions:e.props.markersOptions}))||null,u=(0,H.isSymbolStyle)(t)&&r().createElement(ve,Ze({},s,{style:{...t},symbolsPath:e.props.symbolsPath,defaultShape:e.props.defaultShape,defaultShapeSize:e.props.defaultShapeSize,onUpdateOptions:t=>{e.props.onUpdateSymbols(t)},options:e.props.symbolList,symbolErrors:e.props.symbolErrors,onLoadingError:e.props.onSetErrorSymbol}))||null,g=r().createElement("hr",null),y=[h,l,u,m,d,c,p];return r().createElement(S.Grid,{fluid:!0,style:{width:"100%"},className:"ms-style",key:"grid"+n},r().createElement(_.Z,Ze({},o,{key:"switchPanel"+n}),y.reduce(((e,t,o)=>[e,e&&t&&r().createElement("span",{key:"separator"+o},g),t]))))})),Ne(this,"change",((e,t)=>{const o=F()(this.props.style);let n={...A()(o,{id:e}),...t};(0,H.isSymbolStyle)(n)?(0,H.fetchStyle)((0,H.hashAndStringify)(n))?this.updateStyles(e,(0,H.fetchStyle)((0,H.hashAndStringify)(n)),o,!0):(0,H.createSvgUrl)(n,n.symbolUrl).then((t=>{this.updateStyles(e,{...n,symbolUrlCustomized:t},o,!0)})):this.updateStyles(e,n,o,!0)})),Ne(this,"updateStyles",(function(t,o,n){(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])&&(0,H.registerStyle)((0,H.hashAndStringify)(o),o);let r=(0,W.cc)(!1,o,{id:t},n);e.props.onChangeStyle(r)})),Ne(this,"changeSymbolType",((e,t)=>{this.updateStylesAndType(e,t,this.props.defaultStyles.POINT?.[t])})),Ne(this,"updateStylesAndType",((e,t,o)=>{const n=F()(this.props.style),r=U()(n,{id:e});if(-1!==r){let e=n.map(((e,t)=>t===r?{...o,id:e.id,title:e.title,geometry:e.geometry,filtering:e.filtering}:e));this.props.onChangeStyle(e)}})),Ne(this,"checkSymbolUrl",(e=>{let{style:t,symbolErrors:o,onLoadingError:n=this.props.onSetErrorSymbol}=e;j().get(t.symbolUrl).then((()=>{if(!(0,C.ZA)(this.props.symbolErrors,"loading_symbol"+t.shape)){const e=N()(o,(e=>e!=="loading_symbol"+t.shape));n(e)}})).catch((()=>{(0,C.ZA)(this.props.symbolErrors,"loading_symbol"+t.shape)||n(o.concat(["loading_symbol"+t.shape]))}))}))}UNSAFE_componentWillMount(){const e=F()(this.props.style),t=e.map(((e,t)=>0===t||e.filtering)),o=e.map(((e,t)=>0===t));this.setState({expanded:t,locked:o}),e.filter((e=>{let{type:t}=e;return"Point"===t})).forEach((e=>{this.checkSymbolUrl({...this.props,style:e})}))}render(){const e=F()(this.props.style);return r().createElement("div",{className:"ms-style-manager"},e.map(((t,o)=>this.renderPanelStyle({...t,id:t.id||z()()},{expanded:this.state.expanded[o],locked:this.state.locked[o],onSwitch:()=>{this.setState((()=>({expanded:this.state.expanded.map(((e,t)=>o===t?!this.state.expanded[o]:this.state.expanded[t]))})));let t=e.map(((e,t)=>t===o?{...e,filtering:!this.state.expanded[o]}:e));this.props.onChangeStyle(t)},title:t.title||(0,H.getStylerTitle)(t)+" Style"},o))))}}Ne(Ie,"propTypes",{style:l().object,switchPanelOptions:l().array,lineDashOptions:l().array,onChangeStyle:l().func,pointType:l().string,onUpdateSymbols:l().func,onSetErrorSymbol:l().func,width:l().number,symbolsPath:l().string,defaultShape:l().string,defaultShapeSize:l().number,defaultShapeFillColor:l().string,defaultShapeStrokeColor:l().string,defaultStyles:l().object,symbolList:l().array,symbolErrors:l().array,defaultSymbol:l().object,defaultMarker:l().object,markersOptions:l().object,textRotationStep:l().number}),Ne(Ie,"defaultProps",{style:{},defaultShape:C.xw,symbolsPath:C.Fi,defaultShapeSize:64,defaultShapeFillColor:"#000000",defaultShapeStrokeColor:"#000000",symbolErrors:[],onChangeStyle:()=>{},onUpdateSymbols:()=>{},defaultStyles:{},switchPanelOptions:[]});const Ae=Ie;var Ge=o(798132);const Ue=Ge.Z.markers.extra.icons[0],De=Ge.Z.markers.extra.getGrid(),Be={fields:[{name:"title",type:"text",validator:e=>e,validateError:"annotations.mandatory",showLabel:!0,editable:!0},{name:"description",type:"html",showLabel:!0,editable:!0}],markers:De,markerIcon:Ue,markersConfig:Ge.Z.markers.extra,multiGeometry:!1,glyphs:Object.keys(Ge.Z.getGlyphs("fontawesome")),getGlyphClassName:e=>"fa fa-"+e.iconGlyph,getMarkerFromStyle:e=>De.filter((t=>t.name===e.iconShape))[0].markers.filter((t=>t.name===e.iconColor))[0]};var Re=o(813292),Ve=o.n(Re),Le=o(401811),ze=o(294184),We=o.n(ze),He=o(227361),_e=o.n(He);function Ye(){return Ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Ye.apply(this,arguments)}const $e=e=>{const{editing:t,onAddGeometry:o,onSetStyle:n,onStartDrawing:s,onAddText:i,onStyleGeometry:a,setTabValue:l,isMeasureEditDisabled:p,onSetAnnotationMeasurement:c,showPopupWarning:d,setPopupWarning:h,geodesic:m,defaultStyles:u,defaultPointType:g,onValidateFeature:y,validateFeatures:f}=e,{features:b=[]}=t||{},v=_e()(e,"selected.properties.isValidFeature",!0),E=f(),w=(e,t)=>{a(!1),o(e),"Text"===e&&i(),n(t),s({geodesic:m}),l("coordinates"),y()},P="symbol"===g?u.POINT?.[g]:C.z4.Point,x="symbol"===g?[{...u.POINT?.[g],highlight:!0,iconAnchor:[.5,.5],type:"Point",title:"StartPoint Style",geometry:"startPoint",filtering:!1,id:z()()},{...u.POINT?.[g],highlight:!0,iconAnchor:[.5,.5],type:"Point",title:"EndPoint Style",geometry:"endPoint",filtering:!1,id:z()()}]:(0,C.N_)();return r().createElement(r().Fragment,null,r().createElement("div",{className:"geometries-toolbar"},r().createElement(S.ControlLabel,null,r().createElement(T.Z,{msgId:"annotations.geometries"})),r().createElement(k.Z,{btnDefaultProps:{className:"square-button-md no-border"},buttons:[{glyph:t?.properties?.iconGlyph,visible:!p,disabled:!v,onClick:()=>{d?h(!0):c()},tooltip:r().createElement(T.Z,{msgId:"annotations.editMeasurement"})},{glyph:"point-plus",visible:p,disabled:!v,onClick:()=>{const e=[{...u.POINT?.[g],highlight:!0,id:z()()}];w("Point",e)},tooltip:r().createElement(T.Z,{msgId:"annotations.titles.marker"})},{glyph:"polyline-plus",visible:p,disabled:!v,onClick:()=>{const e=[{...C.z4.LineString,highlight:!0,id:z()()}].concat(x);w("LineString",e)},tooltip:r().createElement(T.Z,{msgId:"annotations.titles.line"})},{glyph:"polygon-plus",visible:p,disabled:!v,onClick:()=>{const e=[{...C.z4.Polygon,highlight:!0,id:z()()}];w("Polygon",e)},tooltip:r().createElement(T.Z,{msgId:"annotations.titles.polygon"})},{glyph:"font-add",visible:p,disabled:!v,onClick:()=>{const e=[{...C.z4.Text,highlight:!0,type:"Text",title:"Text Style",id:z()()}];w("Text",e)},tooltip:r().createElement(T.Z,{msgId:"annotations.titles.text"})},{glyph:"1-circle-add",visible:p,disabled:!v,onClick:()=>{const e=[{...C.z4.Circle,highlight:!0,type:"Circle",title:"Circle Style",id:z()()},{...P,highlight:!0,iconAnchor:[.5,.5],type:"Point",title:"Center Style",filtering:!1,geometry:"centerPoint",id:z()()}];w("Circle",e)},tooltip:r().createElement(T.Z,{msgId:"annotations.titles.circle"})}]})),b&&0===b.length&&r().createElement("div",{style:{textAlign:"center"}},r().createElement(T.Z,{msgId:"annotations.addGeometry"})),b?.map(((t,o)=>r().createElement(qe,Ye({disabled:!E,onValidateFeature:y,feature:t,key:o},e)))))},qe=e=>{let{feature:t,selected:o,disabled:n,onDeleteGeometry:s,onZoom:i,maxZoom:a,onSelectFeature:l,onUnselectFeature:p,setTabValue:c,isMeasureEditDisabled:d,onStyleGeometry:h,onGeometryHighlight:m,onValidateFeature:u}=e;const g=(0,C.q9)(t),{properties:y}=t,{glyph:f,label:b}=(0,C.XL)(g),v=o?.properties?.id===y?.id,E=_e()(o,"properties.isValidFeature",!0),w=y?.isValidFeature,P=!v&&E,x=r().createElement("div",{className:We()("geometry-card",{"ms-selected":v,"ms-disabled":n&&!v}),onMouseEnter:()=>P&&m(y.id),onMouseLeave:()=>P&&m(y.id,!1),onClick:()=>{v&&w?(p(),m(y.id)):n||(l([t]),c(d?"coordinates":"style"),h(!d)),u()}},r().createElement("div",{className:"geometry-card-preview"},r().createElement(S.Glyphicon,{glyph:f})),r().createElement("div",{className:"geometry-card-label"},r().createElement("div",null,y?.geometryTitle||b||y?.id)),r().createElement(k.Z,{btnDefaultProps:{className:"square-button-md no-border"},buttons:[{glyph:"zoom-to",visible:w,className:We()({inactive:n&&!v,"square-button-md no-border":!0}),tooltip:r().createElement(T.Z,{msgId:"annotations.zoomToGeometry"}),onClick:e=>{e.stopPropagation();const o=Ve()(t);i(o,"EPSG:4326",a)}},{glyph:"trash",className:We()({inactive:n&&!v,"square-button-md no-border":!0}),tooltip:r().createElement(T.Z,{msgId:"annotations.removeGeometry"}),onClick:e=>{e.stopPropagation(),s(y?.id)}}]}));return n&&!v?(e=>r().createElement(Le.Z,{placement:"left",overlay:r().createElement(S.Tooltip,null,r().createElement(T.Z,{msgId:"annotations.resolveAllErrors"}))},e))(x):x};$e.defaultProps={onAddGeometry:()=>{},onSetStyle:()=>{},onStartDrawing:()=>{},onAddText:()=>{},onStyleGeometry:()=>{},onSetAnnotationMeasurement:()=>{},onSelectFeature:()=>{},setTabValue:()=>{},isMeasureEditDisabled:!0,defaultPointType:"marker",defaultStyles:{},onValidateFeature:()=>{},validateFeatures:()=>!0};const Qe=$e;var Xe=o(100845);function Je(){return Je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Je.apply(this,arguments)}function Ke(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class et extends r().Component{render(){return r().createElement(Xe.Z,Je({},this.props.options,{items:[],isDraggable:!0,type:this.props.featureType,components:this.props.selected&&this.props.selected.geometry&&this.props.selected.geometry.coordinates&&this.props.selected.geometry.coordinates.length?(0,C.OQ)(this.props.selected.geometry):[],properties:this.props.selected&&this.props.selected.properties||{},onComplete:()=>{},onChangeRadius:this.props.onChangeRadius,aeronauticalOptions:this.props.aeronauticalOptions,onChangeFormat:this.props.onChangeFormat,format:this.props.format,mapProjection:this.props.mapProjection,onHighlightPoint:this.props.onHighlightPoint,onSetInvalidSelected:this.props.onSetInvalidSelected,onChangeText:this.props.onChangeText,renderer:this.props.renderer,onValidateFeature:this.props.onValidateFeature,onChange:(e,t,o,n)=>{let r=e.map((e=>[e.lon,e.lat]));this.props.onChange(r,t,o,n),this.props.onValidateFeature()}}))}}Ke(et,"propTypes",{components:l().array,options:l().object,onRemove:l().func,onChange:l().func,transitionProps:l().object,selected:l().object,featureType:l().string,format:l().string,mapProjection:l().string,onComplete:l().func,onHighlightPoint:l().func,onChangeFormat:l().func,onChangeRadius:l().func,onSetInvalidSelected:l().func,aeronauticalOptions:l().object,onChangeText:l().func,renderer:l().string,onValidateFeature:l().func}),Ke(et,"defaultProps",{selected:{},options:{},components:[],onRemove:null,onChange:()=>{},onComplete:()=>{},onChangeRadius:()=>{},onHighlightPoint:()=>{},onChangeFormat:()=>{},onSetInvalidSelected:()=>{},onChangeText:()=>{},transitionProps:{transitionName:"switch-panel-transition",transitionEnterTimeout:300,transitionLeaveTimeout:300},onValidateFeature:()=>{}});const tt=et;var ot=o(272124);function nt(){return nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},nt.apply(this,arguments)}function rt(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class st extends r().Component{constructor(){var e;super(...arguments),e=this,rt(this,"state",{editedFields:{},removing:null,textValue:"",tabValue:"coordinates",showPopupWarning:!1}),rt(this,"getConfig",(()=>({...Be,...this.props.config,onFilterMarker:this.props.onFilterMarker}))),rt(this,"getBodyItems",(e=>this.getConfig().fields.filter((t=>!e||t.editable)).map((t=>{const o=e&&this.props.errors[t.name],n=o?"field-error":"";return r().createElement("div",{key:t.name,className:"mapstore-annotations-info-viewer-item mapstore-annotations-info-viewer-"+t.name+" "+n},t.showLabel?r().createElement("label",null,r().createElement(T.Z,{msgId:"annotations.field."+t.name})):null,o?this.renderErrorOn(t.name):"",this.renderProperty(t,this.props[t.name]||t.value,e))})))),rt(this,"getValidator",(e=>f()(e)?e:(0,h.CU)({},{},"{(function(value) {return "+e+";})}"))),rt(this,"renderViewButtons",(()=>r().createElement(S.Grid,{fluid:!0,style:this.props.styling?{width:"100%",boxShadow:"none"}:{width:"100%"}},r().createElement(S.Row,{className:"noTopMargin"},r().createElement(S.Col,{xs:12,className:"text-center"},r().createElement(k.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"arrow-left",tooltipId:"annotations.back",visible:this.props.showBack,onClick:()=>{this.props.onCancelEdit(this.props?.feature?.properties),this.props.onCancel(),this.props.onCleanHighlight()}},{glyph:"pencil",tooltipId:"annotations.edit",visible:this.props.showEdit,multiGeometry:this.props.config.multiGeometry,onClick:()=>{this.props.onEdit(this.props.id)},disabled:!this.props.config.multiGeometry&&this.props.editing&&this.props.editing.features&&this.props.editing.features.length,bsStyle:this.props.drawing?"success":"primary"},{glyph:"trash",tooltipId:"annotations.remove",visible:!0,onClick:()=>{this.setState({removing:this.props.id})}},{glyph:"download",tooltip:r().createElement(T.Z,{msgId:"annotations.downloadcurrenttooltip"}),visible:!0,onClick:()=>{this.props.onDownload(this.props.features)}}]})))))),rt(this,"renderEditingCoordButtons",(()=>{const e=this.validateFeatures();return r().createElement(S.Grid,{className:"mapstore-annotations-info-viewer-buttons",fluid:!0},r().createElement(S.Row,{className:"text-center noTopMargin"},r().createElement(S.Col,{xs:12},r().createElement(k.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"arrow-left",tooltipId:"annotations.back",tooltipPosition:"bottom",visible:!0,disabled:this.props?.selected?.properties&&!this.props?.selected?.properties?.isValidFeature||!1,onClick:()=>{this.props.styling&&this.isMeasureEditDisabled()?this.props.unsavedStyle?this.props.onToggleUnsavedStyleModal():this.props.onCancelStyle():this.props.unsavedGeometry?this.props.onToggleUnsavedGeometryModal():this.props.unsavedChanges?this.props.onToggleUnsavedChangesModal():(this.props.onResetCoordEditor(),this.props.onCancelEdit(this.props.editing?.properties),this.setState({...this.state,tabValue:"coordinates"}))}},{glyph:"trash",tooltipId:"annotations.remove",tooltipPosition:"bottom",disabled:!this.props.annotations.length,visible:!this.props.selected,onClick:()=>{this.setState({removing:this.props.id})}},{glyph:"floppy-disk",tooltipPosition:"bottom",tooltipId:e?d()(this.props.selected)?"annotations.save":"annotations.saveGeometry":"annotations.annotationSaveGeometryError",disabled:this.props.selected&&this.props.selected.properties&&!this.props.selected.properties.isValidFeature||!e,onClick:()=>this.save()},{glyph:"download",tooltip:r().createElement(T.Z,{msgId:"annotations.downloadcurrenttooltip"}),tooltipPosition:"bottom",disabled:0!==Object.keys(this.validate()).length||this.props.unsavedChanges,visible:!this.props.selected,onClick:()=>{const{newFeature:e,...t}=this.props.editing;this.props.onDownload(t)}}]}))))})),rt(this,"renderButtons",(e=>{let t;return t=e?this.renderEditingCoordButtons():this.renderViewButtons(),r().createElement("div",{className:"mapstore-annotations-info-viewer-buttons"},t)})),rt(this,"renderProperty",((e,t,o)=>{const n=void 0===this.props.editedFields[e.name]?t:this.props.editedFields[e.name];if(o)switch(e.type){case"html":return r().createElement(E.Z,{value:n||"",onChange:t=>{this.change(e.name,t),this.props.unsavedChanges||this.props.onSetUnsavedChanges(!0)}});case"component":const t=n;return r().createElement("prop",{editing:!0,value:r().createElement(t,{annotation:this.props.feature}),onChange:t=>{this.change(e.name,t.target.value),this.props.unsavedChanges||this.props.onSetUnsavedChanges(!0)}});default:return r().createElement(S.FormControl,{value:n||"",onChange:t=>{this.change(e.name,t.target.value),this.props.unsavedChanges||this.props.onSetUnsavedChanges(!0)}})}switch(e.type){case"html":return r().createElement("span",{dangerouslySetInnerHTML:{__html:n}});case"component":const e=n;return r().createElement(e,{annotation:this.props.feature});default:return r().createElement("p",null,n)}})),rt(this,"renderErrorOn",(e=>r().createElement("div",{className:"annotations-edit-error"},r().createElement(T.Z,{msgId:this.props.errors[e]})))),rt(this,"renderMarkers",(function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.map((t=>t.markers?r().createElement("div",{className:"mapstore-annotations-info-viewer-marker-group mapstore-annotations-info-viewer-marker-"+o+t.name},e.renderMarkers(t.markers,t.name+"-")):r().createElement("div",{onClick:()=>e.selectStyle(t),className:"mapstore-annotations-info-viewer-marker mapstore-annotations-info-viewer-marker-"+o+t.name+(e.isCurrentStyle(t)?" mapstore-annotations-info-viewer-marker-selected":""),style:t.thumbnailStyle})))})),rt(this,"renderBody",(e=>{const t=this.getBodyItems(e);return 0===t.length?null:r().createElement("div",{className:"mapstore-annotations-info-viewer-items"+(this.props.styling?" mapstore-annotations-info-viewer-styler":"")},r().createElement("div",null,t,e&&r().createElement(Qe,{editing:this.props.editing,selected:this.props.selected,onAddGeometry:this.props.onAddGeometry,onSetStyle:this.props.onSetStyle,onStartDrawing:this.props.onStartDrawing,onAddText:this.props.onAddText,onDeleteGeometry:this.props.onDeleteGeometry,onZoom:this.props.onZoom,maxZoom:this.props.maxZoom,setTabValue:this.setTabValue,styling:this.props.styling,onStyleGeometry:this.props.onStyleGeometry,onSelectFeature:this.props.onSelectFeature,drawing:this.props.drawing,onUnselectFeature:this.props.onUnSelectFeature,onGeometryHighlight:this.props.onGeometryHighlight,isMeasureEditDisabled:this.isMeasureEditDisabled(),onSetAnnotationMeasurement:this.setAnnotationMeasurement,setPopupWarning:this.setPopupWarning,showPopupWarning:this.props.showPopupWarning,geodesic:this.props.geodesic,defaultPointType:this.getConfig().defaultPointType,defaultStyles:this.props.defaultStyles,onValidateFeature:this.props.onValidateFeature,validateFeatures:this.validateFeatures})))})),rt(this,"renderError",(e=>e?Object.keys(this.props.errors).filter((e=>0===this.getConfig().fields.filter((t=>t.name===e)).length)).map((e=>this.renderErrorOn(e))):null)),rt(this,"renderModals",(()=>this.props.closing?r().createElement(x.Z,null,r().createElement(P.Z,{show:!0,modal:!0,onClose:this.props.onCancelClose,onConfirm:()=>this.props.onConfirmClose(this.props.editing?.properties),confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:r().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:r().createElement(T.Z,{msgId:"annotations.cancel"})},r().createElement(T.Z,{msgId:"annotations.undo"}))):this.props.showUnsavedChangesModal?r().createElement(x.Z,null,r().createElement(P.Z,{show:!0,modal:!0,onClose:this.props.onToggleUnsavedChangesModal,onConfirm:()=>{this.props.selected&&this.props.onResetCoordEditor(),this.props.onCancelEdit(this.props.editing?.properties),this.props.onToggleUnsavedChangesModal()},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:r().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:r().createElement(T.Z,{msgId:"annotations.cancel"})},r().createElement(T.Z,{msgId:"annotations.undo"}))):this.props.showUnsavedGeometryModal?r().createElement(x.Z,null,r().createElement(P.Z,{show:!0,modal:!0,onClose:this.props.onToggleUnsavedGeometryModal,onConfirm:()=>{this.props.onResetCoordEditor(),this.props.onCancelEdit(this.props.editing?.properties)},confirmButtonBSStyle:"default",closeGlyph:"1-close",title:r().createElement(T.Z,{msgId:"annotations.titleUndoGeom"}),confirmButtonContent:r().createElement(T.Z,{msgId:"annotations.confirmGeom"}),closeText:r().createElement(T.Z,{msgId:"annotations.cancelModalGeom"})},r().createElement(T.Z,{msgId:"annotations.undoGeom"}))):this.props.showUnsavedStyleModal?r().createElement(x.Z,null,r().createElement(P.Z,{show:!0,modal:!0,onClose:this.props.onToggleUnsavedStyleModal,onConfirm:()=>{this.props.onCancelStyle(),this.props.onToggleUnsavedStyleModal(),this.isMeasureEditDisabled()?this.setTabValue("coordinates"):this.setTabValue("style")},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:r().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:r().createElement(T.Z,{msgId:"annotations.cancel"})},r().createElement(T.Z,{msgId:"annotations.undo"}))):this.props.showDeleteFeatureModal?r().createElement(x.Z,null,r().createElement(P.Z,{show:!0,modal:!0,onClose:this.props.onToggleDeleteFtModal,onConfirm:()=>{this.props.onConfirmDeleteFeature(),this.props.onToggleDeleteFtModal()},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:r().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:r().createElement(T.Z,{msgId:"annotations.cancel"})},r().createElement(T.Z,{msgId:"annotations.undoDeleteFeature"}))):this.state.removing||this.props.removing?r().createElement(x.Z,null,r().createElement(P.Z,{show:!0,modal:!0,onClose:()=>{this.state.removing&&this.setState({removing:null}),this.props.onCancelRemove()},focusConfirm:this.props.removing,onConfirm:()=>{this.state.removing?(this.setState({removing:null}),this.props.onConfirmRemove(this.state.removing,"features")):this.props.onConfirmRemove(this.props.removing,"geometry")},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:r().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:r().createElement(T.Z,{msgId:"annotations.cancel"})},"editing"===this.props.mode?r().createElement(T.Z,{msgId:"annotations.removegeometry"}):r().createElement(T.Z,{msgId:"annotations.removeannotation",msgParams:{title:this.props?.feature?.properties?.title}}))):this.state.showPopupWarning&&this.props.showPopupWarning?r().createElement(x.Z,null,r().createElement(P.Z,{show:!0,modal:!0,title:r().createElement(T.Z,{msgId:"annotations.warning"}),onClose:this.hideWarning,onConfirm:this.setAnnotationMeasurement,confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:r().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:r().createElement(T.Z,{msgId:"annotations.cancel"})},r().createElement("span",null,r().createElement("p",null,r().createElement(T.Z,{msgId:"annotations.measureWarningText"})),r().createElement("p",null,r().createElement(S.Checkbox,{checked:this.props.showAgain,onClick:this.props.onToggleShowAgain},r().createElement(T.Z,{msgId:"annotations.notShowAgain"})))))):null)),rt(this,"validateFeatures",(()=>{let e=!0;return Array.isArray(this.props?.editing?.features)&&(e=this.props.editing.features.every((e=>e?.properties?.isValidFeature))),e})),rt(this,"change",((e,t)=>{this.props.onChangeProperties(e,t)})),rt(this,"isCurrentStyle",(e=>this.getConfig().markersConfig.matches(this.props.editing.style.MultiPoint,e.style))),rt(this,"selectStyle",(e=>this.props.onSetStyle(i()({},{Point:{...this.getConfig().markersConfig.getStyle(e.style),iconGlyph:this.props.editing.style.Point&&this.props.editing.style.Point.iconGlyph},MultiPoint:{...this.getConfig().markersConfig.getStyle(e.style),iconGlyph:this.props.editing.style.MultiPoint&&this.props.editing.style.MultiPoint.iconGlyph}})))),rt(this,"selectGlyph",(e=>this.props.onSetStyle(i()({},this.props.editing.style,{Point:{...this.props.editing.style.Point,iconGlyph:e&&e.value||""},MultiPoint:{...this.props.editing.style.MultiPoint,iconGlyph:e&&e.value||""}})))),rt(this,"validate",(()=>i()(this.getConfig().fields.filter((e=>e.editable)).reduce(((e,t)=>{const o=void 0===this.props.editedFields[t.name]?this.props[t.name]:this.props.editedFields[t.name];return t.validator&&!this.getValidator(t.validator)(o)?i()(e,{[t.name]:t.validateError}):e}),{}),this.props.editing.features&&this.props.editing.features.length?{}:{geometry:"annotations.emptygeometry"}))),rt(this,"validateText",((e,t)=>{if(e&&e.length){const o=g()(e);return!!t&&(0,C.Tl)(o)}return!1})),rt(this,"save",(()=>{if(d()(this.props.selected)){const e=this.validate();0===Object.keys(e).length?(this.props.onError({}),this.props.onSave(this.props.id,i()({},this.props.editedFields),this.props.editing.features,this.props.editing.style,this.props.editing.newFeature||!1,{...this.props.editing.properties,visibility:v()(this.props.editing.properties.visibility)?this.props.editing.visibility:this.props.editing.properties.visibility})):this.props.onError(e)}else this.props.onAddNewFeature()})),rt(this,"setTabValue",(e=>{this.state.tabValue!==e&&this.setState({...this.state,tabValue:e})})),rt(this,"setPopupWarning",(e=>{this.setState({...this.state,showPopupWarning:e})})),rt(this,"isMeasureEditDisabled",(()=>{const e=this.props.editing?.properties?.type===w.zE||!1;return!this.props.measurementAnnotationEdit||!e})),rt(this,"setAnnotationMeasurement",(()=>{this.props.onSetAnnotationMeasurement(this.props.editing.features.filter((e=>"Point"!==e.geometry.type&&!e.properties.isCircle)),this.props.editing?.properties),this.hideWarning()})),rt(this,"hideWarning",(()=>{if(this.props.showAgain){try{(0,ot.ac)().setItem("showPopupWarning",!1)}catch(e){console.error(e)}this.props.onHideMeasureWarning()}this.setPopupWarning(!1)}))}componentDidMount(){this.props.onInitPlugin()}render(){const e=this.props.editing&&this.props.editing.properties.id===this.props.id;let t=this.props.mouseHoverEvents?{onMouseEnter:()=>{this.props.onHighlight(this.props.id)},onMouseLeave:()=>{this.props.onCleanHighlight()}}:{};const o=this.props.selected?(0,C.q9)(this.props.selected):"",{glyph:n="",label:s=""}=d()(o)?{}:(0,C.XL)(o);return r().createElement("div",nt({style:{display:"flex"},className:"mapstore-annotations-info-viewer"+(this.props.mouseHoverEvents?" hover-background":"")},t),r().createElement("div",{style:{flex:1}},this.renderButtons(e),this.renderError(e),this.renderModals(),this.renderBody(e)),!d()(this.props.selected)&&r().createElement("div",{className:"mapstore-annotations-info-viewer-expanded"},r().createElement("div",{style:{padding:8,display:"flex",alignItems:"center"}},r().createElement(S.Glyphicon,{glyph:n,style:{fontSize:20,paddingRight:8}}),r().createElement("div",{style:{flex:1}},r().createElement(S.FormControl,{value:this.props.selected?.properties?.geometryTitle||s||this.props.selected?.properties?.id,name:"text",placeholder:"Enter geometry title",onChange:e=>{const t=e.target.value.trim();this.props.onChangeGeometryTitle(t||s)},type:"text"}))),this.props.selected?.properties?.isText&&r().createElement("div",{style:{padding:8}},r().createElement(S.FormGroup,null,r().createElement(S.FormGroup,{validationState:this.props.selected?.properties.valueText?null:"error"},r().createElement(S.ControlLabel,null,r().createElement(T.Z,{msgId:"annotations.editor.text"})),r().createElement(S.FormControl,{value:this.props.selected?.properties?.valueText||"",name:"text",placeholder:"text value",onChange:e=>{const t=e.target.value,o=this.props?.selected?.geometry?.coordinates?.length?(0,C.OQ)(this.props.selected.geometry):[];this.validateText(o,t)||""!==t?this.props.onChangeText(t,o.map(C.bh)):(this.props.onChangeText("",o.map(C.bh)),this.props.onSetInvalidSelected("text",o.map(C.bh)))},type:"text"})))),r().createElement(S.Nav,{bsStyle:"tabs",activeKey:this.state.tabValue,justified:!0},this.isMeasureEditDisabled()&&r().createElement(S.NavItem,{key:"coordinates",eventKey:"coordinates",onClick:()=>{this.setTabValue("coordinates"),this.props.onStyleGeometry(!1)}},r().createElement(T.Z,{msgId:"annotations.tabCoordinates"})),r().createElement(S.NavItem,{key:"style",eventKey:"style",onClick:()=>{this.setTabValue("style"),this.props.onStyleGeometry(!0)}},r().createElement(T.Z,{msgId:"annotations.tabStyle"}))),r().createElement("div",{className:"tab-container"},"coordinates"===this.state.tabValue&&r().createElement(tt,{options:this.props.config&&this.props.config.geometryEditorOptions,drawing:this.props.drawing,aeronauticalOptions:this.props.aeronauticalOptions,selected:this.props.selected,featureType:this.props.featureType,format:this.props.format,mapProjection:this.props.mapProjection,onChange:this.props.onChangeSelected,onChangeRadius:this.props.onChangeRadius,onChangeFormat:this.props.onChangeFormat,onHighlightPoint:this.props.onHighlightPoint,onSetInvalidSelected:this.props.onSetInvalidSelected,onChangeText:this.props.onChangeText,renderer:"annotations",onValidateFeature:this.props.onValidateFeature}),"style"===this.state.tabValue&&r().createElement(Ae,{onChangeStyle:e=>{this.props.onSetStyle(e),this.props.onSetUnsavedStyle(!0),this.props.onSetUnsavedChanges(!0)},pointType:this.props.pointType,style:this.props.selected&&this.props.selected.style||this.props.editing.style,width:this.props.width,symbolsPath:this.props.symbolsPath,onSetErrorSymbol:this.props.onSetErrorSymbol,symbolErrors:this.props.symbolErrors,onUpdateSymbols:this.props.onUpdateSymbols,symbolList:this.props.symbolList,defaultShape:this.props.defaultShape,defaultShapeSize:this.props.defaultShapeSize,defaultShapeFillColor:this.props.defaultShapeFillColor,defaultShapeStrokeColor:this.props.defaultShapeStrokeColor,defaultStyles:this.props.defaultStyles,lineDashOptions:this.props.lineDashOptions,markersOptions:this.getConfig(),textRotationStep:this.props.textRotationStep}))))}}rt(st,"displayName","AnnotationsEditor"),rt(st,"propTypes",{id:l().string,onEdit:l().func,onCancelEdit:l().func,onCancelStyle:l().func,onCleanHighlight:l().func,onHighlight:l().func,onAddText:l().func,onCancel:l().func,onConfirmDeleteFeature:l().func,onRemove:l().func,onSave:l().func,onSaveStyle:l().func,onError:l().func,onAddGeometry:l().func,onToggleUnsavedChangesModal:l().func,onToggleUnsavedGeometryModal:l().func,onToggleUnsavedStyleModal:l().func,onToggleDeleteFtModal:l().func,onSetUnsavedChanges:l().func,onSetUnsavedStyle:l().func,onChangeProperties:l().func,onChangeSelected:l().func,onConfirmClose:l().func,onCancelRemove:l().func,onConfirmRemove:l().func,onChangeRadius:l().func,onChangeText:l().func,onChangeGeometryTitle:l().func,onCancelClose:l().func,onSetInvalidSelected:l().func,onDeleteGeometry:l().func,onAddNewFeature:l().func,onStyleGeometry:l().func,onResetCoordEditor:l().func,onHighlightPoint:l().func,onSetStyle:l().func,onStartDrawing:l().func,onZoom:l().func,editing:l().object,editedFields:l().object,drawingText:l().object,drawing:l().bool,unsavedChanges:l().bool,unsavedGeometry:l().bool,unsavedStyle:l().bool,mouseHoverEvents:l().bool,coordinateEditorEnabled:l().bool,styling:l().bool,closing:l().bool,removing:l().bool,errors:l().object,stylerType:l().string,featureType:l().string,showBack:l().bool,showEdit:l().bool,showUnsavedChangesModal:l().bool,showUnsavedStyleModal:l().bool,showDeleteFeatureModal:l().bool,showUnsavedGeometryModal:l().bool,config:l().object,feature:l().object,features:l().object,selected:l().object,mode:l().string,maxZoom:l().number,width:l().number,onDownload:l().func,onChangeFormat:l().func,onSelectFeature:l().func,mapProjection:l().string,format:l().string,aeronauticalOptions:l().object,onDeleteFeature:l().func,pointType:l().string,symbolsPath:l().string,onUpdateSymbols:l().func,onSetErrorSymbol:l().func,symbolErrors:l().array,lineDashOptions:l().array,symbolList:l().array,defaultShape:l().string,defaultShapeSize:l().number,defaultShapeFillColor:l().string,defaultShapeStrokeColor:l().string,defaultStyles:l().object,textRotationStep:l().number,onSetAnnotationMeasurement:l().func,onFilterMarker:l().func,annotations:l().array,measurementAnnotationEdit:l().bool,geodesic:l().bool,onHideMeasureWarning:l().func,showAgain:l().bool,showPopupWarning:l().bool,onToggleShowAgain:l().func,onInitPlugin:l().func,onGeometryHighlight:l().func,onUnSelectFeature:l().func,onValidateFeature:l().func}),rt(st,"defaultProps",{config:Be,errors:{},selected:null,editedFields:{},showBack:!1,showEdit:!0,coordinateEditorEnabled:!1,feature:{},maxZoom:18,format:"decimal",pointType:"marker",stylerType:"marker",annotations:[],measurementAnnotationEdit:!1,geodesic:!0,onInitPlugin:()=>{}});const it=st;var at=o(549995),lt=o.n(at),pt=o(3674),ct=o.n(pt),dt=o(252628),ht=o.n(dt),mt=o(756435),ut=o(768977),gt=o(89518),yt=o(882702),ft=o(855033),bt=o.n(ft),vt=o(472986),St=o.n(vt),Et=o(685476),Ct=o(283604);function wt(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class Tt extends r().Component{constructor(){super(...arguments),wt(this,"state",{override:!1,loading:!1}),wt(this,"renderError",(()=>r().createElement("div",{className:"ms-alert-center text-center"},r().createElement("div",{className:"alert alert-danger",role:"alert",style:{margin:15,flex:1}},r().createElement(T.Z,{msgId:this.state.error}))))),wt(this,"setError",(()=>{this.setState((()=>({error:this.props.errorMessage,loading:!1})))})),wt(this,"checkfile",(e=>{this.setState((()=>({loading:!0}))),yt.Promise.all(e.map((e=>(0,Et.UC)(e)))).then((e=>{this.state.error&&this.setState((()=>({error:null})));const t=e.filter((e=>{let{geoJSON:t,errors:o=[]}=e;return 0===o.length||t.type===C.Mc})).reduce(((e,t)=>{let{geoJSON:o}=t;return e.concat(o.features||o)}),[]);if(0===t.length)throw new Error;this.props.onFileChoosen(t,this.state.override),this.setState((()=>({loading:!1}))),this.props.onClose()})).catch((()=>{this.setError()}))}))}render(){return r().createElement(Ct.Z,{title:this.props.title,bodyClassName:"ms-flex",show:this.props.show,showClose:!0,onClose:this.props.onClose,size:"sm"},r().createElement("div",{className:"",style:{flexDirection:"column"}},this.state.error&&this.renderError(),r().createElement(bt(),{onDropRejected:this.checkfile,rejectClassName:"ms-alert ms-alert-center text-center alert-danger",className:"ms-alert ms-alert-center text-center",onDrop:this.checkfile},r().createElement("div",{className:"alert alert-info",role:"alert",style:{margin:15,flex:1}},this.state.loading&&r().createElement(St(),{spinnerName:"circle",overrideSpinnerClassName:"spinner"}),this.props.text)),r().createElement("div",{style:{margin:15,flex:1}},r().createElement(S.Checkbox,{disabled:this.props.disableOvveride,checked:this.state.override,onChange:()=>this.setState((()=>({override:!this.state.override})))},r().createElement(T.Z,{msgId:"annotations.loadoverride"})))))}}wt(Tt,"propTypes",{show:l().bool,text:l().oneOfType([l().string,l().element]),onFileChoosen:l().func,error:l().oneOfType([l().string,l().element]),errorMessage:l().string,onClose:l().func,title:l().node,closeGlyph:l().string,disableOvveride:l().bool}),wt(Tt,"contextTypes",{messages:l().object}),wt(Tt,"defaultProps",{show:!1,text:r().createElement(T.Z,{msgId:"annotations.selectfiletext"}),onFileChoosen:()=>{},onClose:()=>{},closeGlyph:"",errorMessage:"annotations.loaderror",title:r().createElement(T.Z,{msgId:"annotations.loadtitle"}),disableOvveride:!1});const Pt=Tt;var xt=o(23888);function kt(){return kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},kt.apply(this,arguments)}function Ot(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class jt extends r().Component{constructor(){super(...arguments),Ot(this,"state",{selectFile:!1}),Ot(this,"getConfig",(()=>i()({},Be,this.props.config))),Ot(this,"renderField",((e,t)=>r().createElement("div",{className:"mapstore-annotations-panel-card-"+e.name},this.renderFieldValue(e,t)))),Ot(this,"renderFieldValue",((e,t)=>{const o=t.properties[e.name]||"";return"html"===e.type?(new DOMParser).parseFromString(o,"text/html").documentElement.lastElementChild?.firstChild?.textContent||"":o})),Ot(this,"renderThumbnail",(e=>{let{featureType:t,geometry:o,properties:n={}}=e;return"Measure"===n?.type?r().createElement("span",{className:"mapstore-annotations-panel-card"},r().createElement(S.Glyphicon,{glyph:"1-ruler"})):"LineString"===t||"MultiLineString"===t?r().createElement("span",{className:"mapstore-annotations-panel-card"},r().createElement(S.Glyphicon,{glyph:"polyline"}),";"):"Polygon"===t||"MultiPolygon"===t?r().createElement("span",{className:"mapstore-annotations-panel-card"},r().createElement(S.Glyphicon,{glyph:"polygon"}),";"):"Circle"===t?r().createElement("span",{className:"mapstore-annotations-panel-card"},r().createElement(S.Glyphicon,{glyph:"1-circle"}),";"):"GeometryCollection"===t||"FeatureCollection"===t?r().createElement("span",{className:"mapstore-annotations-panel-card"},(!!(o.geometries||o.features||[]).filter((e=>"MultiPoint"!==e.type)).length||n.textValues&&n.textValues.length)&&this.getGeomsThumbnail(o)):r().createElement("span",{className:"mapstore-annotations-panel-card"},r().createElement(S.Glyphicon,{glyph:"point"}),";")})),Ot(this,"renderItems",(e=>{const{features:t,properties:o}=e,n={onMouseEnter:()=>{this.props.onHighlight(o.id)},onMouseLeave:this.props.onCleanHighlight,onClick:()=>this.props.onEdit(o.id)},s=!(o&&!v()(o.visibility))||o.visibility;return{...this.getConfig().fields.reduce(((t,o)=>i()({},t,{[o.name]:this.renderField(o,e)})),{}),preview:this.renderThumbnail({featureType:"FeatureCollection",geometry:{features:t},properties:o}),tools:r().createElement(k.Z,{btnDefaultProps:{className:"square-button-md no-border"},btnGroupProps:{style:{margin:10,whiteSpace:"nowrap"}},buttons:[{glyph:"zoom-to",tooltipId:"annotations.zoomTo",onClick:t=>{t.stopPropagation();const o=Ve()(e);this.props.onZoom(o,"EPSG:4326",this.props.maxZoom)}},{glyph:s?"eye-open":"eye-close",tooltipId:s?"annotations.hide":"annotations.show",onClick:e=>{e.stopPropagation(),this.props.onToggleVisibility(o?.id)}}]}),...n}})),Ot(this,"renderCards",(()=>{if(this.props.loading)return r().createElement("div",{style:{display:"flex",height:"100%",justifyContent:"center",alignItems:"center"}},r().createElement(gt.Z,{size:250}));if("list"===this.props.mode){const e=!!this.props.annotations.length;return r().createElement(r().Fragment,null,r().createElement("div",{style:{display:"flex",margin:"auto",justifyContent:"center"},className:"text-center"},r().createElement(k.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"upload",tooltip:r().createElement(T.Z,{msgId:"annotations.loadtooltip"}),visible:"list"===this.props.mode,onClick:()=>{this.setState((()=>({selectFile:!0})))}},{glyph:"plus",tooltip:r().createElement(T.Z,{msgId:"annotations.add"}),visible:"list"===this.props.mode,onClick:()=>{this.props.onAdd()}},{glyph:"download",disabled:!e,tooltip:r().createElement(T.Z,{msgId:"annotations.downloadtooltip"}),visible:"list"===this.props.mode,onClick:()=>{this.props.onDownload()}}]})),r().createElement("div",{style:{padding:"0 8px",margin:"10px 0 0"}},r().createElement(te.Z,{filterPlaceholder:(0,Oe.S$)(this.context.messages,"annotations.filter"),filterText:this.props.filter,onFilter:this.props.onFilter})),r().createElement("div",{id:"ms-annotations-panel-card",className:!e&&"annotations-empty-panel"},!e&&r().createElement(T.Z,{msgId:"annotations.empty"}),e&&r().createElement(ut.Z,{size:"sm",items:this.props.annotations&&this.props.annotations.filter(this.applyFilter).map((e=>this.renderItems(e)))})))}const e=this.props.annotations&&g()(this.props.annotations.filter((e=>e.properties.id===this.props.current))),t=this.props.editor;return"detail"===this.props.mode?r().createElement(t,kt({feature:e,geodesic:this.props.geodesic,showBack:!0,id:this.props.current,config:this.props.config,width:this.props.width},e.properties)):this.props.editing&&r().createElement(t,kt({feature:e,id:this.props.editing.properties&&this.props.editing.properties.id||z()(),width:this.props.width,config:this.props.config},this.props.editing.properties,{lineDashOptions:this.props.lineDashOptions,symbolsPath:this.props.symbolsPath,onUpdateSymbols:this.props.onUpdateSymbols,onSetErrorSymbol:this.props.onSetErrorSymbol,symbolErrors:this.props.symbolErrors,symbolList:this.props.symbolList,defaultShape:this.props.defaultShape,defaultShapeSize:this.props.defaultShapeSize,defaultShapeFillColor:this.props.defaultShapeFillColor,defaultShapeStrokeColor:this.props.defaultShapeStrokeColor,defaultStyles:this.props.defaultStyles,textRotationStep:this.props.textRotationStep,annotations:this.props.annotations,measurementAnnotationEdit:this.props.measurementAnnotationEdit,geodesic:this.props.geodesic}))})),Ot(this,"applyFilter",(e=>!this.props.filter||this.getConfig().fields.reduce(((t,o)=>-1!==(e.properties[o.name]||"").toUpperCase().indexOf(this.props.filter.toUpperCase())||t),!1)))}componentDidMount(){this.props.onLoadDefaultStyles(this.props.defaultShape,this.props.defaultShapeSize,this.props.defaultShapeFillColor,this.props.defaultShapeStrokeColor,this.props.symbolsPath)}getGeomsThumbnail(e){let t;const o=e?.features.reduce(((e,t)=>t.properties&&t.properties.isCircle?{...e,Circle:!0}:t.properties&&t.properties.isText?{...e,Text:!0}:{...e,[t.geometry.type]:!0}),{Circle:!1,Text:!1});if(lt()(ht()(o))?.true>1)t="geometry-collection";else{const e=ct()(o).find((e=>!0===o[e]));t=(0,C.XL)(e)?.glyph}return r().createElement(S.Glyphicon,{glyph:t})}renderHeader(){return r().createElement("div",{style:this.props.styling||{width:"100%"}},r().createElement("div",{style:{display:"flex",alignItems:"center"}},r().createElement("div",null,r().createElement(xt.Z,{className:"square-button no-border",onClick:this.props.toggleControl},r().createElement(S.Glyphicon,{glyph:"1-close"}))),r().createElement("div",{style:{flex:"1 1 0%",padding:8,textAlign:"center"}},r().createElement("h4",null,r().createElement(T.Z,{msgId:"annotations.title"}))),r().createElement("div",null,r().createElement(xt.Z,{className:"square-button no-events"},r().createElement(S.Glyphicon,{glyph:"comment"})))))}render(){let e;return e=this.state.selectFile?r().createElement(Pt,{text:r().createElement(T.Z,{msgId:"annotations.selectfiletext"}),onFileChoosen:this.props.onLoadAnnotations,show:this.state.selectFile,disableOvveride:!(this.props.annotations&&this.props.annotations.length>0),onClose:()=>this.setState((()=>({selectFile:!1})))}):r().createElement("span",null," ",this.renderCards()," "),r().createElement(mt.Z,{id:this.props.id,header:this.renderHeader()},e)}}Ot(jt,"propTypes",{id:l().string,styling:l().bool,toggleControl:l().func,loading:l().bool,closing:l().bool,showUnsavedChangesModal:l().bool,showUnsavedStyleModal:l().bool,editing:l().object,removing:l().object,onCancelRemove:l().func,onConfirmRemove:l().func,onCancelClose:l().func,onToggleUnsavedChangesModal:l().func,onToggleUnsavedStyleModal:l().func,onResetCoordEditor:l().func,onAddNewFeature:l().func,onToggleUnsavedGeometryModal:l().func,onConfirmClose:l().func,onCancelEdit:l().func,onCancelStyle:l().func,onAdd:l().func,onZoom:l().func,onHighlight:l().func,onCleanHighlight:l().func,onDetail:l().func,mode:l().string,editor:l().func,annotations:l().array,current:l().string,config:l().object,filter:l().string,onFilter:l().func,classNameSelector:l().func,width:l().number,onDownload:l().func,onLoadAnnotations:l().func,onUpdateSymbols:l().func,onSetErrorSymbol:l().func,onToggleVisibility:l().func,onEdit:l().func,symbolErrors:l().array,lineDashOptions:l().array,symbolList:l().array,defaultShape:l().string,symbolsPath:l().string,maxZoom:l().number,defaultShapeSize:l().number,defaultShapeFillColor:l().string,defaultShapeStrokeColor:l().string,defaultStyles:l().object,onLoadDefaultStyles:l().func,textRotationStep:l().number,measurementAnnotationEdit:l().bool,geodesic:l().bool}),Ot(jt,"contextTypes",{messages:l().object}),Ot(jt,"defaultProps",{mode:"list",config:Be,classNameSelector:()=>"",toggleControl:()=>{},onUpdateSymbols:()=>{},onSetErrorSymbol:()=>{},onLoadAnnotations:()=>{},annotations:[],maxZoom:18,onLoadDefaultStyles:()=>{}});const Mt=jt;var Ft=o(712535),Zt=o(172768),Nt=o(49977),It=o.n(Nt),At=o(178598),Gt=o(926854),Ut=o(333101),Dt=o(976719),Bt=o(504518),Rt=o(917450),Vt=o(296252),Lt=o(351546),zt=o(30206),Wt=o(274363),Ht=o(612912),_t=o(546821),Yt=o.n(_t),$t=o(502422);const qt=e=>{let t=e.features.map((e=>{let t=[];return e.geometry?("LineString"===e.geometry.type||"MultiPoint"===e.geometry.type?t=e.geometry.coordinates.filter(C.qs):"Polygon"===e.geometry.type?t=e.geometry.coordinates[0]?[e.geometry.coordinates[0].filter(C.qs)]:[[]]:(t=[e.geometry.coordinates].filter(C.qs),t=t.length?t[0]:[]),(0,W.t8)("geometry.coordinates",t,e)):e}));return(0,W.t8)("features",t,e)},Qt=e=>_e()(e.annotations,"config.geodesic",!1),Xt=e=>{let t=e.annotations.editing;const o={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!1,selectEnabled:!0,drawEnabled:!1,translateEnabled:!1,transformToFeatureCollection:!0,geodesic:Qt(e)};return t=qt(t),(0,Vt.Yf)("drawOrEdit",e.draw.drawMethod,C.jB,[t],o,i()({},t.style,{highlight:!1}))},Jt=e=>{let t=e.annotations.editing;const o={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!1,selectEnabled:!1,translateEnabled:!1,drawEnabled:!1,transformToFeatureCollection:!0,geodesic:Qt(e)};return t=qt(t),(0,Vt.Yf)("drawOrEdit",e.draw.drawMethod,C.jB,[t],o,t.style)},Kt=e=>{let t=e.annotations.editing;const o={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!0,selectEnabled:!1,drawEnabled:!1,editFilter:e=>e.getProperties().canEdit,translateEnabled:!1,addClickCallback:!0,useSelectedStyle:!0,transformToFeatureCollection:!0,geodesic:Qt(e)};return t=qt(t),(0,Vt.Yf)("drawOrEdit",e.draw.drawMethod,C.jB,[t],o,t.style)},eo=e=>"FeatureCollection"===e[0].type?e[0]:e.reduce(((e,t)=>"Empty"===e.type?"FeatureCollection"===t.type?eo(t.features):t.geometry:"Point"===e.type?{type:"MultiPoint",coordinates:[e.coordinates,t.geometry.coordinates]}:{type:"MultiPoint",coordinates:e.coordinates.concat([t.geometry.coordinates])}),{type:"Empty"}),to=e=>({type:"FeatureCollection",properties:i()({},e.properties,e.fields,{id:e.id},{visibility:!0}),features:e.geometry,style:i()({},e.style,{highlight:!1})}),oo={addAnnotationsLayerEpic:(e,t)=>e.ofType(Gt.ok).switchMap((()=>{const e=(0,zt.sB)(t.getState());if(e){const{visibility:t=!1,features:o=[]}=e;let n=o.map((e=>({...e,style:{},features:(e.features||[]).map((t=>{let o=(t.properties.isCircle?"Circle":t.properties.isText&&"Text")||t.geometry.type,n=[];return"Circle"===o&&n.push({...C.z4.Point,iconAnchor:[.5,.5],type:"Point",title:"Center Style",filtering:!1,geometry:"centerPoint"}),"LineString"===o&&n.push((0,C.N_)()),{...t,style:me()(t.style)?t.style.map((e=>{const{symbolUrlCustomized:t,...o}=e;return o})):[{...e.style[o],id:e.style[o].id||z()(),symbolUrlCustomized:void 0}].concat(n)}}))})));return It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:n,style:{},visibility:t}))}return It().Observable.empty()})),editAnnotationEpic:(e,t)=>e.ofType(Zt.A1).switchMap((()=>{const e=t.getState(),o=e.annotations.editing,n=e.annotations.featureType,r={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!1,selectEnabled:!0,drawEnabled:!1,transformToFeatureCollection:!0,geodesic:Qt(e)},s=o.properties?.type===w.zE||!1;let a=[(0,Zt.r1)(o?.properties?.id,!1),(0,Vt.Yf)("drawOrEdit",n,C.jB,[o],r,i()({},o.style,{highlight:!1})),(0,Rt.aN)()];return a=s?a.concat((0,Dt.Bd)({geomType:null})):a,It().Observable.from(a)})),newAnnotationEpic:e=>e.ofType(Zt.CD).switchMap((()=>It().Observable.from([(0,Rt.aN)()]))),addAnnotationEpic:(e,t)=>e.ofType(Zt.NV).switchMap((()=>{const e=t.getState().annotations.editing;return It().Observable.from([(0,Zt.r1)(e?.properties?.id,!1),Xt(t.getState()),(0,Rt.aN)()])})),setEditingFeatureEpic:(e,t)=>e.ofType(Zt.Ns).switchMap((e=>{const{properties:o,visibility:n}=e.feature||{};return It().Observable.of((0,Zt.r1)(o.id,n),Xt(t.getState()),(0,Rt.aN)())})),disableInteractionsEpic:(e,t)=>e.ofType(Zt.Ge).switchMap((()=>{const e=t.getState()&&t.getState().annotations&&t.getState().annotations.styling;return It().Observable.from([e?Jt(t.getState()):Kt(t.getState())])})),removeAnnotationEpic:(e,t)=>e.ofType(Zt.c4).switchMap((e=>{if("geometry"===e.attribute){let e=t.getState(),{editing:o}=(0,C.HG)(e.annotations.selected,e.annotations.editing);const n=e.annotations.featureType,r={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!0,drawEnabled:!1,selectEnabled:!0,editFilter:e=>e.getProperties().canEdit,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)};return It().Observable.from([(0,Vt.Yf)("replace",n,C.jB,[o],{}),(0,Vt.Yf)("drawOrEdit",n,C.jB,[o],r,i()({},o.style,{highlight:!1}))])}const o=(0,zt.sB)(t.getState()).features.filter((t=>t.properties.id!==e.id));return It().Observable.from([(0,Ut.tV)(C.jB,"layer",{features:o}),(0,Rt.aN)(),(0,Rt.g)(),(0,Rt.Mc)()].concat(0===o.length?[(0,Ut.$o)(C.jB)]:[]))})),openEditorEpic:e=>e.ofType(Zt.Mf).switchMap((e=>It().Observable.from([(0,Rt.Mc)(),(0,m.Xg)(C.jB,"enabled",!0),(0,Zt.MQ)(e.id),(0,Zt.VR)(e.id)]))),saveAnnotationEpic:(e,t)=>e.ofType(Zt.Lv).switchMap((e=>{const o=g()(t.getState().layers.flat.filter((e=>e.id===C.jB))),n=e.geometry;return It().Observable.from((o?[(0,Ut.tV)(C.jB,"layer",{features:(0,zt.sB)(t.getState()).features.map((t=>i()({},t,{properties:t.properties.id===e.id?i()({},t.properties,e.properties,e.fields):t.properties,features:t.properties.id===e.id?n:t.features,style:t.properties.id===e.id?e.style:t.style}))).concat(e.newFeature?[to(e)]:[]),visibility:!v()(e?.properties?.visibility)&&e.properties.visibility})]:[(0,Ut.A4)({type:"vector",visibility:!0,id:C.jB,name:"Annotations",hideLoading:!0,style:e.style,features:[to(e)],handleClickOnLayer:!0})]).concat([(0,Vt.Yf)("clean",t.getState().annotations.featureType||"",C.jB,[],{}),...e.newFeature?[(0,Zt.r1)(e.id,!0)]:[]]))})),cancelEditAnnotationEpic:(e,t)=>e.ofType(Zt.hv).switchMap((e=>{const{id:o,visibility:n}=e?.properties||{};return It().Observable.from([(0,Vt.Yf)("clean",t.getState().annotations.featureType||"",C.jB,[],{}),(0,Zt.r1)(o,n)])})),purgeMapInfoEpic:(e,t)=>e.ofType(Rt.DZ).filter((()=>_e()(t.getState(),"draw.drawOwner","")===C.jB)).switchMap((()=>It().Observable.from([(0,Vt.Yf)("clean",t.getState().annotations.featureType||"",C.jB,[],{})]))),startDrawingMultiGeomEpic:(e,t)=>e.ofType(Zt.Np).filter((()=>t.getState().annotations.editing.features&&!!t.getState().annotations.editing.features.length||"Circle"===t.getState().annotations.featureType)).switchMap((()=>{const e=t.getState(),o=e.annotations.editing,n=e.annotations.featureType,r=e.annotations.defaultTextAnnotation,s={featureProjection:"EPSG:4326",stopAfterDrawing:!zt._o,editEnabled:"Circle"!==n,translateEnabled:!1,drawEnabled:"Circle"===n,useSelectedStyle:!0,editFilter:e=>e.getProperties().canEdit,defaultTextAnnotation:r,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)};return It().Observable.of((0,Vt.Yf)("drawOrEdit",n,C.jB,[o],s,i()({},o.style,{highlight:!1})))})),endDrawGeomEpic:(e,t)=>e.ofType(Vt.DI).filter((e=>e.owner===C.jB)).switchMap((e=>It().Observable.from([(0,Zt.nY)(eo(e.features),e.textChanged,e.circleChanged)].concat(!(0,zt._o)(t.getState())&&t.getState().annotations.drawing?[(0,Zt.kg)()]:[])))),setAnnotationStyleEpic:(e,t)=>e.ofType(Zt.sL).switchMap((()=>{const e=qt(t.getState().annotations.editing).features,o=t.getState().annotations.selected;let n=A()(e,(e=>e.properties.id===o.properties.id)),r=(0,Lt.reprojectGeoJson)(n,"EPSG:4326","EPSG:3857");return It().Observable.from([(0,Vt.Yf)("updateStyle",t.getState().annotations.featureType,C.jB,[r],{},i()({},o.style,{highlight:!1}))])})),restoreStyleEpic:(e,t)=>e.ofType(Zt.B6).switchMap((()=>{const{styling:e,editing:o}=t.getState().annotations,{style:n,...r}=o;return It().Observable.from([(0,Vt.Yf)("replace",t.getState().annotations.featureType,C.jB,[r],{},n),(0,Zt.A_)(t.getState().annotations.originalStyle),Xt(t.getState()),(0,Zt.ob)(!e)])})),highlightAnnotationEpic:(e,t)=>e.ofType(Zt.X2).switchMap((e=>It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:(0,zt.sB)(t.getState()).features.map((t=>t.properties.id===e.id?i()({},t,{features:t.features&&t.features.length&&t.features.map((e=>i()({},e,{style:F()(e.style).map((e=>i()({},e,{highlight:!0})))})))||[]}):t))})))),showHideAnnotationEpic:(e,t)=>e.ofType(Zt.cM,Ut.yS).filter((e=>e.type===Ut.yS&&e.layer===C.jB&&!v()(e.newProperties.visibility)||e.type===Zt.cM)).switchMap((e=>{const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i()({},e,{properties:{...e.properties,visibility:t}})},n=t.getState();let r=e.layer===C.jB;const s=(0,zt.sB)(n),a=!d()((0,zt.cM)(n));if(!d()(s)){let t=(s.features||[]).map((e=>({...e,properties:{...e.properties,visibility:!!v()(e.properties.visibility)||e.properties.visibility}})));t=t.map((t=>r?o(t,e?.newProperties?.visibility):t.properties.id===e.id?o(t,v()(e.visibility)?!t.properties.visibility:e.visibility):t));const n=!!t?.filter((e=>e.properties.visibility))?.length;return It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:t,...!a&&{visibility:n}}))}return It().Observable.empty()})),hideAnnotationGroupEpic:(e,t)=>e.ofType(Ut.ms).filter((e=>{const o=g()(((0,Ht.Bt)(t.getState())||[]).filter((t=>t.id===e.group)));return-1!==U()(o.nodes,(e=>e.id===C.jB))&&!v()(e.newProperties.visibility)})).switchMap((e=>{const o=t.getState(),n=(0,zt.sB)(o);if(!d()(n)&&!d()(n.features)){const t=n.features.map((t=>({...t,properties:{...t.properties,visibility:e.newProperties.visibility}})));return It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:t}))}return It().Observable.empty()})),cleanHighlightAnnotationEpic:(e,t)=>e.ofType(Zt.dC).switchMap((()=>{const e=(0,zt.sB)(t.getState());return e&&e.features&&e.features.length?It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:e.features.map((e=>i()({},e,{features:e.features&&e.features.length&&e.features.map((e=>i()({},e,{style:F()(e.style).map((e=>i()({},e,{highlight:!1})))})))||[]})))})):It().Observable.empty()})),tearDownByDrawingToolsEpic:(e,t)=>(0,$t.U)(e,t,"annotations",(()=>It().Observable.of((0,Rt.g)()))),closeAnnotationsEpic:(e,t)=>e.ofType(m.kM).filter((e=>e.control===C.jB&&!t.getState().controls.annotations.enabled)).switchMap((()=>It().Observable.from([(0,Zt.Rx)(),(0,Vt.Yf)("clean",t.getState().annotations?.featureType||"",C.jB,[],{})]))),confirmCloseAnnotationsEpic:(e,t)=>e.ofType(Zt.bI).switchMap((e=>{const{id:o,visibility:n}=e?.properties||{};return It().Observable.from((t.getState().controls.annotations&&t.getState().controls.annotations.enabled?[(0,m.Xi)(C.jB),(0,Zt.r1)(o,n)]:[]).concat([(0,Rt.g)()]))})),downloadAnnotations:(e,t)=>{let{getState:o}=t;return e.ofType(Zt.HN).switchMap((e=>{let{annotation:t}=e;try{const e=t&&[t]||(0,zt.sB)(o()).features,n=(0,Wt.Zs)(o());return(0,At.saveAs)(new Blob([JSON.stringify({features:e,type:C.Mc})],{type:"application/json;charset=utf-8"}),`${n.length>0&&n||"Annotations"}.json`),It().Observable.empty()}catch(e){return It().Observable.of((0,Bt.vU)({title:"annotations.title",message:"annotations.downloadError",autoDismiss:5,position:"tr"}))}}))},onLoadAnnotations:(e,t)=>{let{getState:o}=t;return e.ofType(Zt.Bm).switchMap((e=>{let{features:t,override:n}=e;const r=(0,zt.sB)(o()),{messages:s={}}=o().locale||{},i=r&&r.features||[],a=t.map((e=>(0,C.TW)(e,s))),l=n?a:i.concat(a),p=r?(0,Ut.tV)(C.jB,"layer",{features:(0,C.be)(l)}):(0,Ut.A4)({type:"vector",visibility:!0,id:C.jB,name:"Annotations",hideLoading:!0,features:l,handleClickOnLayer:!0});return It().Observable.of(p)}))},onChangedSelectedFeatureEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Zt.Kz).switchMap((e=>{let{}=e;const t=o();let{selected:n,editing:r}=(0,C.HG)(t.annotations.selected,t.annotations.editing),s=n.geometry.type;n.properties?.isCircle&&(s="Circle"),n.properties?.isText&&(s="Text");const a=(0,zt._o)(t),l=r.style,p=(0,Vt.Yf)("drawOrEdit",s,C.jB,[r],{featureProjection:"EPSG:4326",stopAfterDrawing:!a,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,useSelectedStyle:!0,drawEnabled:!1,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(t)},i()({},l,{highlight:!1}));return It().Observable.of(p)}))},onBackToEditingFeatureEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Zt.gT,Zt.op,Zt.cv).switchMap((e=>{let{}=e;const t=o(),n=t.annotations.editing,r=(0,zt._o)(t),s=n.style,a=(0,Vt.Yf)("drawOrEdit","",C.jB,[n],{featureProjection:"EPSG:4326",stopAfterDrawing:!r,editEnabled:!1,drawEnabled:!1,selectEnabled:!0,transformToFeatureCollection:!0},i()({},s,{highlight:!1}));return It().Observable.of(a)}))},redrawOnChangeTextEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Zt.CO).switchMap((()=>{const e=o();let t=e.annotations.editing,n=e.annotations.selected;const r=(0,zt._o)(e),s=t.style;n=(0,W.t8)("geometry.coordinates",[n.geometry.coordinates].filter(C.qs)[0]||[],n),n=(0,W.t8)("geometry.type","Point",n);let a=U()(t.features,(e=>e.properties.id===n.properties.id));(0,C.qs)(n.geometry.coordinates)?t=-1===a?(0,W.t8)("features",t.features.concat([n]),t):(0,W.t8)(`features[${a}]`,n,t):(n=(0,W.t8)("geometry",null,n),t=-1!==a?(0,W.t8)(`features[${a}]`,n,t):(0,W.t8)("features",t.features.concat([n]),t));const l=(0,Vt.Yf)("drawOrEdit","Text",C.jB,[t],{featureProjection:"EPSG:4326",stopAfterDrawing:!r,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,drawEnabled:!1,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0},i()({},s,{highlight:!1}));return It().Observable.of(l)}))},redrawOnChangeRadiusEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Zt.JT).switchMap((()=>{const e=o();let t=e.annotations.editing,n=e.annotations.selected;const r=(0,zt._o)(e),s=t.style;let a=U()(t.features,(e=>e.properties.id===n.properties.id));n=n.properties.isValidFeature?(0,W.t8)("geometry",n.properties.polygonGeom,n):(0,W.t8)("geometry",{type:"Polygon",coordinates:[[]]},n),t=-1===a?(0,W.t8)("features",t.features.concat([n]),t):(0,W.t8)(`features[${a}]`,n,t);const l=(0,Vt.Yf)("drawOrEdit","Circle",C.jB,[t],{featureProjection:"EPSG:4326",stopAfterDrawing:!r,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,drawEnabled:!1,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)},i()({},s,{highlight:!1}));return It().Observable.of(l)}))},editSelectedFeatureEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Vt.iU).switchMap((()=>{const e=o(),t=e.annotations.editing,n=e.annotations.selected,r=(0,zt._o)(e),s=t.style;let a=n.geometry.type;n.properties.isCircle&&(a="Circle"),n.properties.isText&&(a="Text");const l=(0,Vt.Yf)("drawOrEdit",a,C.jB,[t],{featureProjection:"EPSG:4326",stopAfterDrawing:!r,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,drawEnabled:!1,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)},i()({},s,{highlight:!1}));return It().Observable.of((0,Vt.Yf)("clean"),l)}))},highlightGeometryEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Zt.qX).switchMap((e=>{let{id:t="",state:n=!0}=e;const r=o(),{editing:s,featureType:a}=r.annotations,l=U()(s.features,(e=>e.properties.id===t)),p=s.features[l],c=F()(p.style).map((e=>({...e,highlight:n}))),d=(0,Vt.Yf)("updateStyle",a,C.jB,[(0,W.t8)(`features[${l}]`,(0,W.t8)("style",c,p),s)],{transformToFeatureCollection:!0},i()({},s.style,{highlight:!1}));return It().Observable.of((0,Vt.Yf)("clean"),d)}))},editCircleFeatureEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Vt.W7).filter((e=>e.features[0].properties&&e.features[0].properties.isCircle)).delay(300).switchMap((()=>{const e=o(),t=e.annotations.editing,n=(0,zt._o)(e),r=t.style,s=(0,Vt.Yf)("drawOrEdit","Circle",C.jB,[t],{featureProjection:"EPSG:4326",stopAfterDrawing:!n,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,drawEnabled:!1,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)},i()({},r,{highlight:!1}));return It().Observable.of(s)}))},loadDefaultAnnotationsStylesEpic:(e,t)=>e.ofType(Zt.it).switchMap((e=>{let{shape:o=C.xw,size:n=64,fillColor:r="#000000",strokeColor:s="#000000",symbolsPath:i=C.Fi}=e;const a=(0,zt.Cq)(t.getState())||[],l={symbol:()=>{const e={...C.j5,shape:o,size:n,fillColor:r,color:s,symbolUrl:i+o+".svg"};return It().Observable.defer((()=>j().get(e.symbolUrl).then((()=>(0,H.createSvgUrl)(e,e.symbolUrlCustomized||e.symbolUrl))))).map((t=>(0,Zt.WB)("POINT.symbol",{...e,symbolUrlCustomized:t}))).catch((()=>It().Observable.of((0,Zt.Y5)(a.concat(["loading_symbol"+o])),(0,Zt.WB)("POINT.symbol",{...e,symbolUrlCustomized:Yt(),symbolUrl:i+o+".svg",shape:o}))))},marker:()=>It().Observable.of((0,Zt.WB)("POINT.marker",C.bi))};return It().Observable.merge(...ht()(l).map((e=>e()))).startWith((0,Zt.V_)(!0)).concat(It().Observable.of((0,Zt.V_)(!1)))}))};var no=o(859518),ro=o(350126),so=o(726598),io=o(908316);function ao(){return ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},ao.apply(this,arguments)}function lo(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const po={onUpdateSymbols:Zt.z_,onSetErrorSymbol:Zt.Y5,onEdit:Zt.VR,onCancelEdit:Zt.QD,onChangeFormat:Zt.Zw,onConfirmDeleteFeature:Zt.pv,onCleanHighlight:Zt.Rx,onHighlightPoint:Zt.aS,onHighlight:Zt.CH,onError:Zt.Bp,onSave:Zt.xD,onRemove:Zt._x,onAddGeometry:Zt.kg,onAddText:Zt.F4,onSetUnsavedChanges:Zt.if,onSetUnsavedStyle:Zt.tp,onChangeProperties:Zt.Om,onToggleDeleteFtModal:Zt.Ay,onToggleUnsavedChangesModal:Zt.ts,onToggleUnsavedGeometryModal:Zt.UJ,onToggleUnsavedStyleModal:Zt.yw,onAddNewFeature:Zt.TA,onResetCoordEditor:Zt.nz,onStyleGeometry:Zt.ob,onCancelStyle:Zt.nk,onChangeSelected:Zt.i9,onSaveStyle:Zt.ob,onSetStyle:Zt.A_,onStartDrawing:Zt.y$,onDeleteGeometry:Zt.dT,onZoom:no.Px,onSelectFeature:Vt.KD,onChangeRadius:Zt.om,onSetInvalidSelected:Zt.$f,onChangeText:Zt.XW,onChangeGeometryTitle:Zt.Dd,onCancelRemove:Zt.iY,onCancelClose:Zt.Hl,onConfirmClose:Zt.L0,onConfirmRemove:Zt.jw,onDownload:Zt.LR,onFilterMarker:Zt.TW,onGeometryHighlight:Zt.$,onSetAnnotationMeasurement:Dt.pO,onHideMeasureWarning:Zt.Y_,onToggleShowAgain:Zt.Ib,onInitPlugin:Zt.QT,onUnSelectFeature:Zt.RC,onValidateFeature:Zt._n},co=(0,h.$j)(zt.cQ,{onCancel:Zt.l7,...po})(it),ho=(0,h.$j)(zt.cQ,{...po,onEdit:Zt.bM})(it),mo=(0,p.P1)([zt.dm],(e=>({...e,editor:co}))),uo=(0,h.$j)(mo,{onCancelRemove:Zt.iY,onCancelStyle:Zt.nk,onCancelEdit:Zt.QD,onToggleUnsavedChangesModal:Zt.ts,onToggleUnsavedStyleModal:Zt.yw,onToggleUnsavedGeometryModal:Zt.UJ,onConfirmRemove:Zt.jw,onToggleVisibility:Zt.r1,onCancelClose:Zt.Hl,onConfirmClose:Zt.L0,onAdd:Zt.A9,onEdit:Zt.VR,onHighlight:Zt.CH,onCleanHighlight:Zt.Rx,onDetail:Zt.MQ,onFilter:Zt.VP,onDownload:Zt.LR,onZoom:no.Px,onLoadAnnotations:Zt.wP,onLoadDefaultStyles:Zt.pI})(Mt);class go extends r().Component{componentDidMount(){(0,so.j9)(C.jB,ho)}componentWillUnmount(){(0,so.j9)(C.jB,void 0)}render(){return this.props.active?r().createElement(io.Z,ao({containerId:"annotations-panel",className:"ms-annotations-panel",containerStyle:this.props.dockStyle,hideHeader:!0,style:this.props.dockStyle,open:this.props.active,size:this.props.width},this.props.dockProps),r().createElement(uo,ao({},this.props,{width:this.props.width}))):null}}lo(go,"propTypes",{id:l().string,active:l().bool,wrap:l().bool,wrapWithPanel:l().bool,panelStyle:l().object,panelClassName:l().string,toggleControl:l().func,closeGlyph:l().string,buttonStyle:l().object,style:l().object,dockProps:l().object,dockStyle:l().object,width:l().number}),lo(go,"defaultProps",{id:"mapstore-annotations-panel",active:!1,wrap:!1,modal:!0,wrapWithPanel:!1,panelStyle:{zIndex:100,overflow:"hidden",height:"100%"},panelClassName:"annotations-panel",toggleControl:()=>{},closeGlyph:"1-close",width:300,dockProps:{dimMode:"none",position:"left",zIndex:1030},dockStyle:{}});const yo=m.on.bind(null,(0,m.Xi)("annotations",null),(e=>!(e.controls&&e.controls.annotations&&e.controls.annotations.enabled&&e.annotations&&e.annotations.editing)),Zt.g),fo=(0,p.P1)([e=>e.controls&&e.controls.annotations&&e.controls.annotations.enabled||e.annotations&&e.annotations.closing||!1,e=>(0,ro.ic)(e,{height:!0}),zt.dm],((e,t,o)=>({active:e,dockStyle:t,width:d()(o?.selected)?300:600}))),bo=(0,h.$j)(fo,{toggleControl:yo})(go),vo=(0,h.rx)("Annotations",{component:i()(bo,{disablePluginIf:"{state('mapType') === 'cesium' || state('mapType') === 'leaflet' }"}),containers:{TOC:{doNotHide:!0,name:"Annotations",target:"toolbar",selector:()=>!0,Component:(0,h.$j)((()=>{}),{onClick:yo})((e=>{let{onClick:t,layers:o,selectedLayers:n,status:s}=e;return"DESELECT"===s&&0===o.filter((e=>"annotations"===e.id)).length?r().createElement(Le.Z,{key:"annotations",placement:"top",overlay:r().createElement(S.Tooltip,{id:"legend-tooltip-annotations"},r().createElement(T.Z,{msgId:"toc.addAnnotations"}))},r().createElement(xt.Z,{key:"annotations",bsStyle:"primary",className:"square-button-md",onClick:t},r().createElement(S.Glyphicon,{glyph:"comment"}))):"annotations"===n[0]?.id&&r().createElement(Le.Z,{key:"annotations-edit",placement:"top",overlay:r().createElement(S.Tooltip,{id:"legend-tooltip-annotations-edit"},r().createElement(T.Z,{msgId:"toc.editAnnotations"}))},r().createElement(xt.Z,{key:"annotations",bsStyle:"primary",className:"square-button-md",onClick:t},r().createElement(S.Glyphicon,{glyph:"pencil"})))}))},BurgerMenu:{name:"annotations",position:40,text:r().createElement(T.Z,{msgId:"annotationsbutton"}),tooltip:"annotations.tooltip",icon:r().createElement(S.Glyphicon,{glyph:"comment"}),action:yo,priority:2,doNotHide:!0}},reducers:{annotations:Ft.Z},epics:oo})},30206:(e,t,o)=>{"use strict";o.d(t,{sB:()=>g,_o:()=>y,cM:()=>P,Cq:()=>V,cQ:()=>H,dm:()=>_});var n=o(22222),r=o(612912),s=o(274363),i=o(101092),a=o(975872),l=o(91175),p=o.n(l),c=o(227361),d=o.n(c),h=o(727418),m=o.n(h),u=o(234228);const g=(0,n.P1)([r.l2],(e=>p()(e.filter((e=>"annotations"===e.id))))),y=e=>d()(e,"annotations.config.multiGeometry",!1),f=e=>d()(e,"annotations.removing"),b=e=>d()(e,"annotations.format"),v=e=>d()(e,"annotations.aeronauticalOptions"),S=e=>d()(e,"annotations.showUnsavedChangesModal",!1),E=e=>d()(e,"annotations.showUnsavedStyleModal",!1),C=e=>d()(e,"annotations.showUnsavedGeometryModal",!1),w=e=>d()(e,"annotations.showDeleteFeatureModal",!1),T=e=>!!d()(e,"annotations.closing"),P=e=>d()(e,"annotations.editing"),x=e=>d()(e,"annotations.editGeometry",!0),k=e=>d()(e,"annotations.featureType"),O=e=>d()(e,"annotations.coordinateEditorEnabled"),j=e=>!!d()(e,"annotations.drawing"),M=e=>d()(e,"annotations.stylerType"),F=e=>d()(e,"annotations.drawingText"),Z=e=>d()(e,"annotations.editedFields",{}),N=e=>!!d()(e,"annotations.styling"),I=e=>d()(e,"annotations.selected",null),A=e=>d()(e,"annotations.unsavedChanges",!1),G=e=>d()(e,"annotations.unsavedGeometry",!1),U=e=>d()(e,"annotations.unsavedStyle",!1),D=e=>d()(e,"annotations.validationErrors",{}),B=e=>d()(e,"annotations.config",{}),R=e=>d()(e,"annotations.symbolList",[]),V=e=>d()(e,"annotations.symbolErrors",[]),L=e=>(P(e)?"editing":g(e)&&(e=>d()(e,"annotations.current"))(e)&&"detail")||"list",z=e=>d()(e,"annotations.showAgain",!1),W=e=>d()(e,"annotations.showPopupWarning",!0),H=e=>m()({},{symbolErrors:V(e),showEdit:(0,i.m6)(e),canEdit:x(e),mouseHoverEvents:(0,a.Qp)(e),closing:T(e),format:b(e)||(0,u.u8)("defaultCoordinateFormat"),aeronauticalOptions:v(e),config:B(e),drawing:j(e),drawingText:F(e),errors:D(e),editing:P(e),coordinateEditorEnabled:O(e),editedFields:Z(e),mode:L(e),selected:I(e),featureType:k(e),removing:f(e),mapProjection:(0,s.uy)(e),showUnsavedChangesModal:S(e),showDeleteFeatureModal:w(e),showUnsavedGeometryModal:C(e),showUnsavedStyleModal:E(e),stylerType:M(e),styling:N(e),unsavedChanges:A(e),unsavedGeometry:G(e),unsavedStyle:U(e),symbolList:R(e),showAgain:z(e),showPopupWarning:W(e)}),_=(0,n.P1)([H,e=>({...e.annotations||{}}),g,L],((e,t,o,n)=>m()({},{format:t.format,aeronauticalOptions:t.aeronauticalOptions,removing:t.removing,showUnsavedChangesModal:t.showUnsavedChangesModal,showUnsavedGeometryModal:t.showUnsavedGeometryModal,showUnsavedStyleModal:t.showUnsavedStyleModal,showDeleteFeatureModal:t.showDeleteFeatureModal,closing:!!t.closing,mode:n,annotations:o&&o.features||[],current:t.current||null,editing:e.editing,selected:e.selected,filter:t.filter||"",defaultStyles:t.defaultStyles,loading:t.loading},e.config?{config:e.config}:{})));(0,n.P1)([_],(e=>{const t=e.current;return{annotation:p()(e.annotations.filter((e=>e.properties.id===t)))}}))},844174:e=>{e.exports=function(e,t,o,n){for(var r=-1,s=null==e?0:e.length;++r<s;){var i=e[r];t(n,i,o(i),e)}return n}},481119:(e,t,o)=>{var n=o(989881);e.exports=function(e,t,o,r){return n(e,(function(e,n,s){t(r,e,o(e),s)})),r}},555189:(e,t,o)=>{var n=o(844174),r=o(481119),s=o(267206),i=o(701469);e.exports=function(e,t){return function(o,a){var l=i(o)?n:r,p=t?t():{};return l(o,e,s(a,2),p)}}},549995:(e,t,o)=>{var n=o(789465),r=o(555189),s=Object.prototype.hasOwnProperty,i=r((function(e,t,o){s.call(e,o)?++e[o]:n(e,o,1)}));e.exports=i},264372:(e,t,o)=>{e.exports=o.p+"web/client/components/style/vector/iconNotFound.png"}}]);