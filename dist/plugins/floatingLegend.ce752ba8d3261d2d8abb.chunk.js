(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[6764],{768977:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var n=i(45697),s=i.n(n),r=i(124852),o=i.n(r),l=i(630294),a=i(222777);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},p.apply(this,arguments)}function h(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class c extends o().Component{render(){const{cardComponent:e,items:t,colProps:i,onItemClick:n,size:s}=this.props,r=e||a.Z;return o().createElement("div",{className:"msSideGrid"+(this.props.className?" "+this.props.className:"")},o().createElement(l.Row,{className:"items-list"},t.map(((e,t)=>o().createElement(l.Col,p({key:e.id||t},i),o().createElement(r,p({onClick:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return n(e,...i)},size:s},e)))))))}}h(c,"propTypes",{size:s().string,onItemClick:s().func,colProps:s().object,items:s().array,cardComponent:s().oneOfType([s().string,s().func]),className:s().string}),h(c,"defaultProps",{size:"",onItemClick:()=>{},colProps:{xs:12},className:"",items:[]});const d=c},122910:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>Y});var n=i(227361),s=i.n(n),r=i(91175),o=i.n(r),l=i(531351),a=i.n(l),p=i(727418),h=i.n(p),c=i(45697),d=i.n(c),g=i(124852),m=i.n(g),u=i(171703),f=i(22222);const y="FLOATINGLEGEND:RESIZE_LEGEND",b="FLOATINGLEGEND:EXPAND_LEGEND";var v=i(333101),E=i(180307),x=i.n(E),w=i(618446),P=i.n(w),O=i(98066),z=i.n(O),H=i(630294),N=i(496259),C=i(101706),j=i(23888),T=i(36549),L=i(768977),S=i(908956),G=i(134006);function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},I.apply(this,arguments)}function R(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Z=(0,T.Z)(j.Z);class k extends m().Component{constructor(){super(...arguments),R(this,"state",{}),R(this,"findListHeight",(()=>{const e=this.list&&x().findDOMNode(this.list),t=e&&e.clientHeight&&e.clientHeight+this.props.deltaHeight||9999;return this.setState({listHeight:t}),t}))}componentDidMount(){this.props.onExpand(this.props.expandedOnMount)}componentDidUpdate(e){z()((()=>{if(!P()(this.props.layers,e.layers)||this.props.maxHeight!==e.maxHeight||this.props.disabled!==e.disabled){const e=this.findListHeight();this.props.maxHeight<this.props.height?this.props.onResize({height:this.props.maxHeight}):e&&e<this.props.height&&this.props.onResize({height:e})}if(this.props.layers.length!==e.layers.length||this.props.expanded&&!e.expanded){const e=this.findListHeight();this.props.onResize({height:e<this.props.maxHeight?e:this.props.maxHeight})}}),100)}render(){const e=this.props.expanded&&this.props.layers&&this.props.layers.length>0;return this.props.layers&&0===this.props.layers.length&&!this.props.title&&m().createElement("div",{id:"ms-legend-action",className:"ms-legend-action"},this.props.toggleButton)||!this.props.disabled&&m().createElement(N.Z,null,(t=>{let{height:i}=t;return m().createElement(C.Resizable,{height:this.props.height,axis:"y",minConstraints:[this.props.width,this.props.minHeight],maxConstraints:[this.props.width,this.state.listHeight&&this.state.listHeight<this.props.maxHeight&&this.state.listHeight||i&&i<this.props.maxHeight&&i||this.props.maxHeight],onResize:(e,t)=>this.props.onResize({height:t.size&&t.size.height})},m().createElement(H.Panel,{id:"ms-legend-action",className:"ms-legend-action",collapsible:!0,header:m().createElement(H.Grid,{fluid:!0},m().createElement(H.Row,null,m().createElement(H.Col,{xs:12,className:"ms-legend-header"},this.props.toggleButton,m().createElement("div",null,m().createElement("h5",null,this.props.title)),this.props.layers&&this.props.layers.length>0&&m().createElement(Z,{tooltipId:this.props.expanded?"floatinglegend.hideLegend":"floatinglegend.showLegend",tooltipPosition:"bottom",className:"no-border square-button-md",onClick:()=>this.props.onExpand(!this.props.expanded)},m().createElement(H.Glyphicon,{glyph:this.props.expanded?"chevron-down":"chevron-left"}))))),expanded:e,footer:e&&m().createElement(H.Grid,{fluid:!0}),style:{width:this.props.width,...this.props.height&&e?{height:this.props.minHeight>this.props.height?this.props.minHeight:this.props.height}:{}}},m().createElement(L.Z,{ref:e=>{this.list=e},size:"sm",items:this.props.layers.map((e=>({title:e.title&&""!==e.title?e.title:e.name,preview:m().createElement(H.Glyphicon,{className:"text-primary",glyph:e.visibility?"eye-open":"eye-close",onClick:()=>this.props.onChange(e.id,"layers",{visibility:!e.visibility})}),style:{opacity:e.visibility?1:.4},body:e.visibility?m().createElement("div",null,m().createElement(H.Grid,{fluid:!0},m().createElement(H.Row,null,m().createElement(H.Col,{xs:12,className:"ms-legend-container"},m().createElement(G.Z,I({node:{...e},currentZoomLvl:this.props.currentZoomLvl,scales:this.props.scales},this.props.legendProps))))),!this.props.disableOpacitySlider&&m().createElement(S.Z,{opacity:e.opacity,disabled:!e.visibility,hideTooltip:this.props.hideOpacityTooltip,onChange:t=>this.props.onChange(e.id,"layers",{opacity:t})})):null})))})))}))}}R(k,"propTypes",{layers:d().array,expanded:d().bool,width:d().number,height:d().number,title:d().string,legendProps:d().object,onChange:d().func,onResize:d().func,onExpand:d().func,toggleButton:d().node,minHeight:d().number,maxHeight:d().number,disabled:d().bool,currentZoomLvl:d().number,scales:d().array,disableOpacitySlider:d().bool,deltaHeight:d().number,expandedOnMount:d().bool,hideOpacityTooltip:d().bool}),R(k,"defaultProps",{layers:[],expanded:!0,width:300,height:900,title:"",legendProps:{},onChange:()=>{},onResize:()=>{},onExpand:()=>{},toggleButton:m().createElement(H.Glyphicon,{glyph:"1-map",style:{margin:"0 8px"}}),minHeight:150,maxHeight:9999,deltaHeight:110,expandedOnMount:!0});const D=k;var B=i(521923);var M=i(820709),A=i(612912),F=i(707366),V=i(274363),_=i(350126),q=i(719648),U=i(835516);function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},X.apply(this,arguments)}function J(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class K extends m().Component{renderPanel(){const e=this.props.items&&o()(this.props.items.filter((e=>e&&e.name===this.props.pluginName)));return e&&e.plugin&&m().createElement(e.plugin,X({},e.cfg||{},{items:e.items||[],menuButtonStyle:{display:"none"}}))}renderToggleButton(){const e=this.props.items&&o()(this.props.items.filter((e=>e&&e.name===this.props.pluginName)));return e&&e.button&&m().createElement(e.button,X({},e.cfg||{},{tooltipId:this.props.tooltipId}))}render(){return m().createElement("div",{className:this.props.className,style:this.props.style},m().createElement(D,X({},this.props,{toggleButton:this.renderToggleButton()})),this.renderPanel())}}J(K,"propTypes",{items:d().array,pluginName:d().string,tooltipId:d().string,className:d().string,style:d().object}),J(K,"defaultProps",{items:[],pluginName:"drawer-menu",tooltipId:"floatinglegend.showTOC",className:"ms-floatinglegend-container",style:{top:0,left:0,position:"absolute",height:"100%"}});const Q=(0,f.P1)([A.l2,F.Pz,e=>e.floatinglegend&&e.floatinglegend.size||{width:0,height:0},e=>!(!e.floatinglegend||!e.floatinglegend.expanded),e=>s()(e,"controls.drawer.enabled"),V.Od,_.Nr,M.Rd],((e,t,i,n,s,r,o,l)=>({layers:l&&[]||e&&a()([...e.filter((e=>e&&"background"!==e.group&&!e.loadingError)).map((e=>{let{title:i,...n}=e;return{...n,title:(0,q.MZ)(t,i)}}))])||[],title:r&&r.info&&r.info.name||"",height:i.height||300,expanded:n,disabled:!!s,maxHeight:r&&r.size&&r.size.height-134-(o&&o.bottom&&(0,U.parseLayoutValue)(o.bottom,r&&r.size&&r.size.height)||0)||9999,currentZoomLvl:r&&r.zoom,scales:(0,U.getScales)(r&&r.projection||"EPSG:3857",r&&r.mapOptions&&r.mapOptions.view&&r.mapOptions.view.DPI||null)}))),W=(0,u.connect)(Q,{onChange:v.tV,onResize:function(e){return{type:y,size:e}},onExpand:function(e){return{type:b,expanded:e}}})(K),Y={FloatingLegendPlugin:h()(W,{disablePluginIf:"{state('featuregridmode') === 'EDIT'}"}),reducers:{floatinglegend:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return(0,B.t8)("size",{width:t.size&&t.size.width,height:t.size&&t.size.height},e);case b:return{...e,expanded:t.expanded};default:return e}}}}},138845:e=>{e.exports=function(e,t,i){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,i)}),t)}},98066:(e,t,i)=>{var n=i(138845),s=i(105976),r=i(14841),o=s((function(e,t,i){return n(e,r(t)||0,i)}));e.exports=o}}]);