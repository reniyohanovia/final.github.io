(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[531],{570531:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>Re});var r=i(237001),n=i(288487),o=i(470326),a=i(234228),s=i(331655);function l(e){this.proxy=e}function c(){}l.prototype.getURL=function(e){let{url:t,queryString:i}=function(e){let t=e,i="";return-1!==e.indexOf("?")&&(t=e.substring(0,e.indexOf("?")+1),-1!==e.indexOf("%")&&(t=decodeURIComponent(t)),i=e.substring(e.indexOf("?")+1)),{url:t,queryString:i}}(e);return 0===t.indexOf("//")&&(t=location.protocol+t),(0,s.b)()+encodeURIComponent(t+i)},c.prototype.getURL=e=>e,r.default.registerType("tileprovider",(e=>{let t,[i,r]=o.Z.getLayerConfig(e.provider,e),h=a.ZP.getProxyUrl({});h&&(t=r.noCors||(0,s.$)(i));const u=r.credits,p=u?new n.Credit(u.text,u.imageUrl,u.link):r.attribution;return new n.UrlTemplateImageryProvider({url:(d=i,y=r,d.replace(/{([^{}]+)}/g,(function(e,t){if(["x","y","z","s"].includes(t))return e;let i=y[t];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(y)),i}))),enablePickFeatures:!1,subdomains:r.subdomains,maximumLevel:r.maxZoom,minimumLevel:r.minZoom,credit:p,proxy:t?new l(h):new c});var d,y}));var h=i(399790);const{defined:u,defaultValue:p,DeveloperError:d,Credit:y,Resource:m,Ellipsoid:f,GeographicTilingScheme:g,WebMercatorTilingScheme:v,TerrainProvider:w,HeightmapTerrainData:S,Event:b,Request:_,when:x}=n;let C={};const M={CRS:[{name:"CRS:84",ellipsoid:f.WGS84,firstAxeIsLatitude:!1,tilingScheme:g,supportedCRS:"urn:ogc:def:crs:OGC:2:84"},{name:"EPSG:4326",ellipsoid:f.WGS84,firstAxeIsLatitude:!0,tilingScheme:g,SupportedCRS:"urn:ogc:def:crs:EPSG::4326"},{name:"EPSG:3857",ellipsoid:f.WGS84,firstAxeIsLatitude:!1,tilingScheme:v,SupportedCRS:"urn:ogc:def:crs:EPSG::3857"},{name:"OSGEO:41001",ellipsoid:f.WGS84,firstAxeIsLatitude:!1,tilingScheme:v,SupportedCRS:"urn:ogc:def:crs:EPSG::3857"}],FormatArray:[{format:"image/bil",postProcessArray:function(e,t,i,r,n,o){let a,s=new DataView(e),l=new ArrayBuffer(t.height*t.width*2),c=new DataView(l);if(l.byteLength===e.byteLength){let e;for(let t=0;t<l.byteLength;t+=2)e=s.getInt16(t,o)-n,e>r&&e<i?c.setInt16(t,e,!0):c.setInt16(t,0,!0);a=new Int16Array(l)}return a}}]},P=M.CRS.map((e=>{let{name:t}=e;return t}));function T(e){if(!u(e.layerName))throw new d("options.layerName is required.");let t=e.url;const i=e.layerName,r=e.version||"1.3.0",n=e.crs;let o,a,s,l=e.fixedHeight,c=e.fixedWidth;const h={};h.proxy=e.proxy,h.sampleTerrainZoomLevel=p(e.sampleTerrainZoomLevel,18),h.heightMapWidth=p(e.heightMapWidth,65),h.heightMapHeight=p(e.heightMapHeight,h.heightMapWidth),h.littleEndian=e.littleEndian,h.tilingScheme=void 0,h.ready=!1,h.waterMask=p(e.waterMask,!1),h.offset=p(e.offset,0),h.highest=p(e.highest,12e3),h.lowest=p(e.lowest,-500),"boolean"!=typeof h.waterMask&&(h.waterMask=!1),null!==r&&(s=/^1\.[3-9]\./.test(r));const y=t.indexOf("?");y>-1&&(t=t.substring(0,y));const m=M.FormatArray.filter((function(e){return"image/bil"===e.format}));if(m.length>0&&(h.formatArray=m[0]),!u(h.formatArray)||"string"!=typeof h.formatArray.format||"function"!=typeof h.formatArray.postProcessArray)throw h.formatArray=void 0,new d("format not supported.");if(h.formatArray.terrainDataStructure={heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1},u(l)&&u(c)&&(l=parseFloat(l),h.heightMapHeight=l>0&&l<h.heightMapHeight?l:h.heightMapHeight,c=parseFloat(c),h.heightMapWidth=c>0&&c<h.heightMapWidth?c:h.heightMapWidth),u(n)&&u(r)){let e=!1;for(let t=0;t<M.CRS.length&&!e;t++){const i=M.CRS[t];let r=i.name;if(r===n){o=r,a=i.firstAxeIsLatitude;const t=i.tilingScheme;h.tilingScheme=new t({ellipsoid:i.ellipsoid}),h.getTileDataAvailable=function(){return!0},e=!0}}h.ready=e&&u(h.formatArray)&&u(r)}if(h.ready){let e=t+"?SERVICE=WMS&REQUEST=GetMap&layers="+i+"&version="+r+"&bbox=";if(e+=s&&a?"{south},{west},{north},{east}":"{west},{south},{east},{north}",e+="&crs="+o+"&srs="+o,h.formatArray){let t=e+"&format="+h.formatArray.format+"&width="+h.heightMapWidth+"&height="+h.heightMapHeight;h.getURLtemplateArray=function(){return t}}}return h.levelZeroMaximumGeometricError=w.getEstimatedLevelZeroGeometricErrorForAHeightmap(h.tilingScheme.ellipsoid,h.heightMapWidth,h.tilingScheme.getNumberOfXTilesAtLevel(0)),{...e,...h}}function A(e){this._errorEvent=new b;let t=e.credit;"string"==typeof t&&(t=new y(t)),this._credit=t,this._availability=void 0,this._ready=!1,this._tileCredits=void 0,this._readyPromise=Promise.resolve(!0).then((()=>function(e){if(function(e){return u(e.url)&&u(e.layerName)&&u(e.crs)}(e))return Promise.resolve(T(e));if(u(e.url)){let t=e.url;const i=t.lastIndexOf("?");i>-1&&(t=t.substring(0,i));const r=`${t}?SERVICE=WMS&REQUEST=GetCapabilities&tiled=true`;let n=(0,h.Fh)({url:r,name:e.layerName});const o=n!==r;return m.fetchXML({url:n,proxy:e.proxy,queryParameters:e.params}).then((t=>T(function(e,t){let{isWorkSpaceCapabilities:i,...r}=t;if(!(e instanceof XMLDocument))throw new d("xml must be a XMLDocument");if(!u(r.layerName))throw new d("description.layerName is required.");let n="1.3.0";const o=e.querySelector("[version]");if(null!==o&&(n=o.getAttribute("version")),![...e.querySelectorAll("Request>GetMap>Format")].map((e=>e.textContent)).find((e=>"image/bil"===e)))throw new d("image/bil format is not supported");const a=[...e.querySelectorAll("Layer[queryable='1'],Layer[queryable='true']")].find((e=>{const t=e.querySelector("Name").textContent;return i?r.layerName.split(":")[1]===t:r.layerName===t})),s=[...a.querySelectorAll("CRS")].map((e=>e.textContent)).find((e=>P.includes(e)));if(!s)throw new d("available crs are not supported");const l=a.getAttribute("fixedHeight"),c=a.getAttribute("fixedWidth");return{...r,fixedHeight:l,fixedWidth:c,crs:s,version:n}}(t,{...e,isWorkSpaceCapabilities:o}))))}return Promise.reject(new d("either options.url or options.layerName are required."))}(e).then((e=>{this._options=e,this._ready=!0}))))}A.prototype.getHeightmapTerrainDataArray=function(e,t,i){let r;if(!isNaN(e+t+i)){const n=function(e,t,i,r,n){const o=n.tilingScheme.tileXYToNativeRectangle(t,i,r),a=(o.east-o.west)/(n.heightMapWidth-1),s=(o.north-o.south)/(n.heightMapHeight-1);o.west-=.5*a,o.east+=.5*a,o.south-=.5*s,o.north+=.5*s;const l=n.tilingScheme.getNumberOfYTilesAtLevel(r)-i-1;return e.replace("{south}",o.south).replace("{north}",o.north).replace("{west}",o.west).replace("{east}",o.east).replace("{x}",t).replace("{y}",i).replace("{tmsY}",l)}(this._options.getURLtemplateArray(e,t,i),e,t,i,this._options),o={highest:this._options.highest,lowest:this._options.lowest,offset:this._options.offset},a=function(e,t,i,r){let n=0;const o=i+1;return n|=r.getTileDataAvailable(2*e,2*t,o)?1:0,n|=r.getTileDataAvailable(2*e+1,2*t,o)?2:0,n|=r.getTileDataAvailable(2*e,2*t+1,o)?4:0,n|=r.getTileDataAvailable(2*e+1,2*t+1,o)?8:0,n}(e,t,i,this._options);if(C[n])return x(Promise.resolve(new S(C[n])));const s=this._options.proxy||{getURL:e=>e};if(r=m.fetchArrayBuffer({url:n,proxy:s,headers:this._options.headers,queryParameters:this._options.params,request:new _({throttleByServer:this._options.sampleTerrainZoomLevel!==i})}),u(r))return r.then((e=>(C[n]=this.arrayToHeightmapTerrainDataOptions(e,o,{width:this._options.heightMapWidth,height:this._options.heightMapHeight},this._options.formatArray,this._options.waterMask,this._options.littleEndian,a),new S(C[n])))).otherwise((()=>new S({buffer:new Uint16Array(this._options.heightMapWidth*this._options.heightMapHeight),width:this._options.heightMapWidth,height:this._options.heightMapHeight,childTileMask:a,waterMask:new Uint8Array(this._options.heightMapWidth*this._options.heightMapHeight),structure:this._options.formatArray.terrainDataStructure})))}return r},A.prototype.arrayToHeightmapTerrainDataOptions=function(e,t,i,r,n,o,a){let s=i;"number"==typeof s&&(s={width:s,height:s});const l=r.postProcessArray(e,s,t.highest,t.lowest,t.offset,o);if(!u(l))throw new d("no good size");const c={buffer:l,width:s.width,height:s.height,childTileMask:a,structure:r.terrainDataStructure};if(n){const e=new Uint8Array(l.length);for(let t=0;t<l.length;t++)l[t]<=0&&(e[t]=255);c.waterMask=e}return c},A.prototype.requestTileGeometry=function(e,t,i){if(!this._ready)throw new d("requestTileGeometry must not be called before the terrain provider is ready.");if(!u(this._options.getURLtemplateArray))throw new d("getURLtemplateArray function is not available.");return this.getHeightmapTerrainDataArray(e,t,i)},A.prototype.getLevelMaximumGeometricError=function(e){return this._options.levelZeroMaximumGeometricError/(1<<e)},A.prototype.getTileDataAvailable=function(e,t,i){return this._options.getTileDataAvailable(e,t,i)},Object.defineProperties(A.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){if(!this._ready)throw new d("credit must not be called before the terrain provider is ready.");return this._credit}},tilingScheme:{get:function(){if(!this._ready)throw new d("tilingScheme must not be called before the terrain provider is ready.");return this._options.tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){if(!this._ready)throw new d("hasWaterMask must not be called before the terrain provider is ready.");return this._options.waterMask}},hasVertexNormals:{get:function(){return!1}},hasMetadata:{get:function(){return!1}},availability:{get:function(){return!1}},sampleTerrainZoomLevel:{get:function(){if(!this._ready)throw new d("sampleTerrainZoomLevel must not be called before the terrain provider is ready.");return this._options.sampleTerrainZoomLevel}}});const E=A;var L=i(727418),k=i.n(L),R=i(701469),O=i.n(R),I=i(618446),W=i.n(I),D=i(555363);function G(e){let t=e,i="";return-1!==e.indexOf("?")&&(t=e.substring(0,e.indexOf("?")+1),-1!==e.indexOf("%")&&(t=decodeURIComponent(t)),i=e.substring(e.indexOf("?")+1)),{url:t,queryString:i}}function q(e){this.proxy=e}function H(){}q.prototype.getURL=function(e){let{url:t,queryString:i}=G(e);return(0,s.b)()+encodeURIComponent(t+i)},H.prototype.getURL=function(e){const{url:t,queryString:i}=G(e);return t+i};const U=e=>{let t,i=a.ZP.getProxyUrl({});return i&&(t=e.noCors||(0,s.$)(e.url)),t?new q(i):new H},N={PARAM_OPTIONS:["layers","styles","style","format","transparent","version","tiled","opacity","zindex","srs","singletile","_v_","filterobj"],wmsToCesiumOptionsBIL:e=>{let t=e.url;const i=(0,D.getAuthenticationHeaders)(t,e.securityToken),r=(0,h.QW)(e);return{url:t,headers:i,proxy:U(e),littleEndian:e.littleEndian||e.littleendian||!1,layerName:e.name,version:e.version,crs:e.crs,sampleTerrainZoomLevel:e.sampleTerrainZoomLevel,heightMapWidth:e.heightMapWidth,heightMapHeight:e.heightMapHeight,waterMask:e.waterMask,offset:e.offset,highest:e.highest,lowest:e.lowest,params:r}},getProxy:U};var V=i(676794),F=i(40649);const z=e=>{let t;return e.useForElevation?new E(N.wmsToCesiumOptionsBIL(e)):(t=e.singleTile?new n.SingleTileImageryProvider(function(e){const t=void 0!==e.opacity?e.opacity:1,i=(0,V.v)(e),r=k()({styles:e.style||"",format:((0,F.z)(e.format)?"image/png":e.format)||"image/png",transparent:void 0===e.transparent||e.transparent,opacity:t,...(0,h._6)(e),layers:e.name,width:e.size||2e3,height:e.size||2e3,bbox:"-180.0,-90,180.0,90",srs:"EPSG:4326"},i||{},(0,h.QW)(e)),o=(O()(e.url)?e.url[Math.round(Math.random()*(e.url.length-1))]:e.url)+"?service=WMS&version=1.1.0&request=GetMap&"+function(e){return Object.keys(e).map((t=>t+"="+encodeURIComponent(e[t]))).join("&")}((0,D.addAuthenticationToSLD)(r,e)),a=(0,D.getAuthenticationHeaders)(o,e.securityToken);return{url:new n.Resource({url:o,headers:a,proxy:N.getProxy(e)})}}(e)):new n.WebMapServiceImageryProvider(function(e){var t=void 0!==e.opacity?e.opacity:1;const i=(0,V.v)(e),r=e.credits,o=r?new n.Credit(r.text||r.title,r.imageUrl,r.link):e.attribution,a=(0,h.D$)(O()(e.url)?e.url:[e.url]),s=(0,D.getAuthenticationHeaders)(a[0],e.securityToken);return k()({url:new n.Resource({url:"{s}",headers:s,proxy:N.getProxy(e)}),tileDiscardPolicy:"none"===e.tileDiscardPolicy?void 0:e.tileDiscardPolicy??new n.NeverTileDiscardPolicy,credit:o,subdomains:a,layers:e.name,enablePickFeatures:!1,parameters:k()({styles:e.style||"",format:((0,F.z)(e.format)?"image/png":e.format)||"image/png",transparent:void 0===e.transparent||e.transparent,opacity:t,tiled:void 0===e.tiled||e.tiled,width:e.tileSize||256,height:e.tileSize||256},k()({},e._v_?{_v_:e._v_}:{},i||{},(0,h.QW)(e)))})}(e)),t.updateParams=t=>{const i=k()({},e,{params:k()({},e.params||{},t)});return z(i)},t)};r.default.registerType("wms",{create:z,update:(e,t,i)=>{const r=t&&t.params,n=i&&i.params,o={...r,...n};return Object.keys({...t,...i,...o}).filter((e=>N.PARAM_OPTIONS.indexOf(e.toLowerCase())>=0)).filter((e=>{const o=void 0===i[e]?n&&n[e]:i[e],a=void 0===t[e]?r&&r[e]:t[e];return!W()(o,a)})).length>0||t.securityToken!==i.securityToken||!W()(t.layerFilter,i.layerFilter)||t.tileSize!==i.tileSize?z(t):null}});var Z=i(276570),B=i(513218),j=i.n(B),$=i(512571),Q=i.n($),X=i(227361),J=i.n(X),Y=i(91175),K=i.n(Y),ee=i(472500),te=i.n(ee);function ie(e){let t=e,i="";return-1!==e.indexOf("?")&&(t=e.substring(0,e.indexOf("?")+1),-1!==e.indexOf("%")&&(t=decodeURIComponent(t)),i=e.substring(e.indexOf("?")+1)),{url:t,queryString:i}}function re(e){this.proxy=e}function ne(){}re.prototype.getURL=function(e){let{url:t,queryString:i}=ie(e);return(0,s.b)()+encodeURIComponent(t+i)},ne.prototype.getURL=function(e){let{url:t,queryString:i}=ie(e);return t+i};const oe=e=>e.indexOf("EPSG:4326")>=0?new n.GeographicTilingScheme:e.indexOf("EPSG:3857")>=0?new n.WebMercatorTilingScheme:null,ae=(e,t)=>{const i=Z.C2(e.tileMatrixSet,t,e.allowedSRS,e.matrixIds),r=(n=e.matrixIds&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return(j()(e)&&e[t]||O()(e)&&e||[]).map((e=>e.identifier))}(e.matrixIds,i)||function(e){let t=new Array(30);for(let i=0;i<30;++i)t[i]=e.tileMatrixPrefix+i;return t}(e),n.length>o?Q()(n,0,o):n.length<o?n.concat(new Array(o-n.length)):n);var n,o;return{tileMatrixSet:i,matrixIds:r}};const se=e=>{let t;const i=function(e){const t=Z.nJ(e);let i="EPSG:4326",{tileMatrixSet:r,matrixIds:o}=ae(t,i);if(0===o.length){i="EPSG:3857";const e=ae(t,i);r=e.tileMatrixSet,o=e.matrixIds}let l,c=a.ZP.getProxyUrl({});c&&(l=(0,s.$)(t.url)&&c);const u=(p=t.matrixIds&&t.matrixIds[r],(e,t,i)=>p&&p[i]&&!p[i].ranges||e<=parseInt(J()(p[i],"ranges.cols.max"),10)&&e>=parseInt(J()(p[i],"ranges.cols.min"),10)&&t<=parseInt(J()(p[i],"ranges.rows.max"),10)&&t>=parseInt(J()(p[i],"ranges.rows.min"),10));var p;const d=te().format({query:{...(0,h.QW)(t)}}),y=t.credits,m=y?new n.Credit(y.text||y.title,y.imageUrl,y.link):"";return k()({url:new n.Resource({url:K()((0,h.D$)(O()(t.url)?t.url:[t.url],d)),proxy:l&&new re(l)||new ne}),format:((0,F.z)(t.format)?"image/png":t.format)||"image/png",isValid:u,credit:m,layer:t.name,style:t.style||"",tileMatrixLabels:o,tilingScheme:oe(i,t.matrixIds[r]),enablePickFeatures:!1,tileWidth:t.tileWidth||t.tileSize||256,tileHeight:t.tileHeight||t.tileSize||256,tileMatrixSetID:r,maximumLevel:30,parameters:{...(0,h.QW)(t)}})}(e);t=new n.WebMapTileServiceImageryProvider(i);const r=t.requestImage;return t.requestImage=(e,n,o)=>i.isValid(e,n,o)?r.bind(t)(e,n,o):new Promise((()=>{})),t.updateParams=t=>{const i=k()({},e,{params:k()({},e.params||{},t)});return se(i)},t};function le(){let{color:e="#ffffff"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._tilingScheme=new n.GeographicTilingScheme,this._readyPromise=n.when.resolve(!0),this._canvas=document.createElement("canvas"),this._canvas.width=1,this._canvas.height=1;const t=this._canvas.getContext("2d");t.fillStyle=e,t.fillRect(0,0,this._canvas.width,this._canvas.height)}r.default.registerType("wmts",{create:se,update:(e,t,i)=>t.securityToken!==i.securityToken||i.format!==t.format||i.credits!==t.credits?se(t):null}),r.default.registerType("marker",{create:(e,t)=>{const i={point:{pixelSize:5,color:n.Color.RED,outlineColor:n.Color.WHITE,outlineWidth:2},...e.style},r=t.entities.add({position:n.Cartesian3.fromDegrees(e.point.lng,e.point.lat),...i});return{detached:!0,point:r,remove:()=>{t.entities.remove(r)}}},update:function(e,t,i,r){return W()(t.point,i.point)&&t.visibility===i.visibility?null:(e.remove(),t.visibility?this.create(t,r):null)}}),Object.defineProperties(le.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){}},tileHeight:{get:function(){}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),le.prototype.getTileCredits=function(){},le.prototype.requestImage=function(){return this._canvas},le.prototype.pickFeatures=function(){},r.default.registerType("empty",(()=>new le({color:"#ffffff"}))),r.default.registerType("bing",(e=>{const t=e.apiKey;return new n.BingMapsImageryProvider({url:"//dev.virtualearth.net",key:t,mapStyle:n.BingMapsStyle[e.name.toUpperCase()]})}));const ce=function(){let e=[n.Math.toRadians(.05),n.Math.toRadians(.1),n.Math.toRadians(.2),n.Math.toRadians(.5),n.Math.toRadians(1),n.Math.toRadians(2),n.Math.toRadians(5),n.Math.toRadians(10)];function t(e,t){let i=e||{};this._tilingScheme=i.tilingScheme||new n.GeographicTilingScheme,this._color=i.color&&new n.Color(i.color[0],i.color[1],i.color[2],i.color[3])||new n.Color(1,1,1,.4),this._tileWidth=i.tileWidth||256,this._tileHeight=i.tileHeight||256,this._ready=!0,this._sexagesimal=i.sexagesimal||!1,this._numLines=i.numLines||50,this._scene=t,this._labels=new n.LabelCollection,t.primitives.add(this._labels),this._polylines=new n.PolylineCollection,t.primitives.add(this._polylines),this._ellipsoid=t.globe.ellipsoid;let r=document.createElement("canvas");r.width=256,r.height=256,this._canvas=r}let i=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),r=Object.defineProperties;function o(e){return e<.01?3:e<.1?2:e<1?1:0}return i&&r||(r=function(e){return e}),r(t.prototype,{url:{get:function(){}},proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 18}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),t.prototype.makeLabel=function(e,t,i,r){this._labels.add({position:this._ellipsoid.cartographicToCartesian(new n.Cartographic(e,t,10)),text:i,font:"normal",fillColor:this._color,outlineColor:this._color,style:n.LabelStyle.FILL,pixelOffset:new n.Cartesian2(5,r?5:-5),eyeOffset:n.Cartesian3.ZERO,horizontalOrigin:n.HorizontalOrigin.LEFT,verticalOrigin:r?n.VerticalOrigin.BOTTOM:n.VerticalOrigin.TOP,scale:1})},t.prototype._drawGrid=function(t){if(this._currentExtent&&this._currentExtent.equals(t))return;this._currentExtent=t,this._polylines.removeAll(),this._labels.removeAll();let i=0,r=0;for(let r=0;r<e.length&&i<(t.north-t.south)/10;r++)i=e[r];for(let i=0;i<e.length&&r<(t.east-t.west)/10;i++)r=e[i];let a=(t.west<0?Math.ceil(t.west/r):Math.floor(t.west/r))*r,s=(t.south<0?Math.ceil(t.south/i):Math.floor(t.south/i))*i,l=(t.east<0?Math.ceil(t.east/i):Math.floor(t.east/i))*i,c=(t.north<0?Math.ceil(t.north/r):Math.floor(t.north/r))*r;a=Math.max(a-2*r,-Math.PI),l=Math.min(l+2*r,Math.PI),s=Math.max(s-2*i,-Math.PI/2),c=Math.min(c+2*r,Math.PI/2);let h=this._ellipsoid,u=n.Math.toRadians(1),p=s+Math.floor((c-s)/i/2)*i;for(let e=a;e<l;e+=r){let t=[];for(let i=s;i<c;i+=u)t.push(new n.Cartographic(e,i));t.push(new n.Cartographic(e,c)),this._polylines.add({positions:h.cartographicArrayToCartesianArray(t),width:.75,material:new n.Material({fabric:{type:"Color",uniforms:{color:this._color}}})});let i=n.Math.toDegrees(e);this.makeLabel(e,p,this._sexagesimal?this._decToSex(i):i.toFixed(o(r)),!1)}let d=a+Math.floor((l-a)/r/2)*r;for(let e=s;e<c;e+=i){let t=[];for(let i=a;i<l;i+=u)t.push(new n.Cartographic(i,e));t.push(new n.Cartographic(l,e)),this._polylines.add({positions:h.cartographicArrayToCartesianArray(t),width:1,material:new n.Material({fabric:{type:"Color",uniforms:{color:this._color}}})});let r=n.Math.toDegrees(e);this.makeLabel(d,e,this._sexagesimal?this._decToSex(r):r.toFixed(o(i)),!0)}},t.prototype.requestImage=function(){return this._show&&this._drawGrid(this._getExtentView()),this._canvas},t.prototype.setVisible=function(e){this._show=e,e?(this._currentExtent=null,this._drawGrid(this._getExtentView())):(this._polylines.removeAll(),this._labels.removeAll())},t.prototype.isVisible=function(){return this._show},t.prototype._decToSex=function(t){let i=Math.floor(t),r=(60*(Math.abs(t)-i)).toFixed(2);return"60.00"===r&&(i+=1,e="0.00"),[i,":",r].join("")},t.prototype._getExtentView=function(){const e=this._scene.camera,t=this._scene.canvas,i=[e.pickEllipsoid(new n.Cartesian2(0,0),this._ellipsoid),e.pickEllipsoid(new n.Cartesian2(t.width,0),this._ellipsoid),e.pickEllipsoid(new n.Cartesian2(0,t.height),this._ellipsoid),e.pickEllipsoid(new n.Cartesian2(t.width,t.height),this._ellipsoid)];for(let e=0;e<4;e++)if(void 0===i[e])return n.Rectangle.MAX_VALUE;return n.Rectangle.fromCartographicArray(this._ellipsoid.cartesianArrayToCartographicArray(i))},t.prototype.destroy=function(){this._show=!1,this._polylines&&this._scene.primitives.remove(this._polylines),this._labels&&this._scene.primitives.remove(this._labels)},t}(),he=(e,t)=>{const i=t.scene,r=new ce({tileWidth:512,tileHeight:512,numLines:10,...e},i);return e.visibility&&r.setVisible(!0),r};r.default.registerType("graticule",{create:he,update:(e,t,i,r)=>t.visibility!==i.visibility&&(e.setVisible(!1),t.visibility)?he(t,r):null}),r.default.registerType("osm",(()=>new n.OpenStreetMapImageryProvider({url:"//a.tile.openstreetmap.org/"})));var ue=i(798143),pe=i.n(ue);const de=function(){function e(e){this._scene=e.scene;let t=document.createElement("div");t.className="infoWindow",this._div=t;let i=document.createElement("div");i.className="frame",this._div.appendChild(i);let r=document.createElement("div");r.className="content",i.appendChild(r),e.container.appendChild(t),this._content=r,this.setVisible(!0),this._div.style.position="absolute"}return e.prototype.setVisible=function(e){this._visible=e,this._div.style.display=e?"block":"none"},e.prototype.setContent=function(e){if("string"==typeof e)this._content.innerHTML=e;else{for(;this._content.firstChild;)this._content.removeChild(this._content.firstChild);this._content.appendChild(e)}},e.prototype.setPosition=function(e,t){this._position=this._scene.globe.ellipsoid.cartographicToCartesian(n.Cartographic.fromDegrees(t,e,0))},e.prototype.showAt=function(e,t,i){this.setPosition(e,t),this.setContent(i),this.setVisible(!0)},e.prototype.hide=function(){this.setVisible(!1)},e.prototype.computeVisible=function(){const e=6378137,t=6378137,i=6356752.314245179,r=this._scene.camera.position,n=r.x/e,o=r.y/t,a=r.z/i,s=n*n+o*o+a*a-1,l=this._position,c=l.x/e-n,h=l.y/t-o,u=l.z/i-a,p=-(c*n+h*o+u*a);p>s&&p*p/(c*c+h*h+u*u)>s?this.setVisible(!1):this.setVisible(!0)},e.prototype.update=function(){if(this.computeVisible(),!this._visible||!this._position)return;let e=n.SceneTransforms.wgs84ToWindowCoordinates(this._scene,this._position);if(e){let t=Math.floor(e.x)-this._div.clientWidth/2+"px",i=Math.floor(e.y)-this._div.clientHeight+"px";this._div.tabIndex=5,this._div.style.left=t,this._div.style.top=i}},e.prototype.destroy=function(){this._div.parentNode.removeChild(this._div)},e}(),ye=e=>{if(0!==e.length)for(let t=0;t<e.length;t++){let i=e.item(t);i.removeAttribute("data-reactid"),ye(i.children||[])}};r.default.registerType("overlay",{create:(e,t)=>{const i=((e,t)=>{let i=e.cloneNode(!0);i.id=t.id+"-overlay",i.className=(t.className||e.className)+"-overlay",i.removeAttribute("data-reactid"),ye(i.children||[]);const r=t.closeClass||"close";if(t.onClose&&1===i.getElementsByClassName(r).length){const e=i.getElementsByClassName(r)[0],n=e=>{t.onClose(e.target.getAttribute("data-overlayid"))};pe().add(e,"click",n)}return i})(document.getElementById(e.id),e);let r=new de(t);r.showAt(e.position.y,e.position.x,i),r.setVisible(!0);let n=t.scene.primitives.add(r);return{detached:!0,info:n,remove:()=>{t.scene.primitives.remove(n)}}},update:function(e,t,i,r){return W()(t.position,i.position)&&t.visibility===i.visibility?null:(e.remove(),t.visibility?this.create(t,r):null)}});var me=i(281763),fe=i.n(me),ge=i(807654),ve=i.n(ge),we=i(119950),Se=i(594397);function be(e){let{style:t}=e;const{format:i,body:r}=t||{};return i&&r?"3dtiles"===i?Promise.resolve(r):"geostyler"===i?(0,we.getStyleParser)("3dtiles").then((e=>e.writeStyle(r))):Promise.all([(0,we.getStyleParser)(i),(0,we.getStyleParser)("3dtiles")]).then((e=>{let[t,i]=e;return t.readStyle(r).then((e=>i.writeStyle(e)))})):Promise.resolve(null)}function _e(e,t){let{heightOffset:i}=t;if(!ve()(i)&&fe()(i)){const t=e.boundingSphere,r=n.Cartographic.fromCartesian(t.center),o=n.Cartesian3.fromRadians(r.longitude,r.latitude,0),a=n.Cartesian3.fromRadians(r.longitude,r.latitude,i),s=n.Cartesian3.subtract(a,o,new n.Cartesian3);e.modelMatrix=n.Matrix4.fromTranslation(s)}}function xe(e,t,i){t.clippingPolygon?(0,Se.ir)(t.clippingPolygon,!!t.clippingPolygonUnion,t.clipOriginalGeometry).then((r=>{e.clippingPlanes=new n.ClippingPlaneCollection({modelMatrix:n.Matrix4.inverse(n.Matrix4.multiply(e.root.computedTransform,e._initialClippingPlanesOriginMatrix,new n.Matrix4),new n.Matrix4),planes:r,edgeWidth:1,edgeColor:n.Color.WHITE,unionClippingRegions:!!t.clippingPolygonUnion}),i.scene.requestRender()})):(e.clippingPlanes=new n.ClippingPlaneCollection({planes:[]}),i.scene.requestRender())}function Ce(e,t){e.ready?t():e.readyPromise.then((()=>{t()}))}r.default.registerType("3dtiles",{create:(e,t)=>{if(e.visibility&&e.url){const i=t.scene.primitives.add(new n.Cesium3DTileset({url:new n.Resource({url:e.url,proxy:(0,s.$)(e.url)?new n.DefaultProxy((0,s.b)()):void 0})}));return i.msId=e.id,Ce(i,(()=>{_e(i,e),xe(i,e,t),be(e).then((e=>{e&&(i.style=new n.Cesium3DTileStyle(e))}))})),{detached:!0,tileSet:i,remove:()=>{t.scene.primitives.remove(i)},setVisible:e=>{i.show=!!e}}}return{detached:!0,remove:()=>{},setVisible:()=>{}}},update:function(e,t,i,r){return t.visibility&&!i.visibility?this.create(t,r):!t.visibility&&i.visibility&&e?.remove?(e.remove(),null):(W()(t.clippingPolygon,i.clippingPolygon)&&t.clippingPolygonUnion===i.clippingPolygonUnion&&t.clipOriginalGeometry===i.clipOriginalGeometry||!e?.tileSet||Ce(e.tileSet,(()=>{xe(e.tileSet,t,r)})),!W()(t.style,i.style)&&e?.tileSet&&Ce(e.tileSet,(()=>{be(t).then((t=>{t&&e?.tileSet&&(e.tileSet.makeStyleDirty(),e.tileSet.style=new n.Cesium3DTileStyle(t))}))})),e?.tileSet&&t.heightOffset!==i.heightOffset&&Ce(e.tileSet,(()=>{_e(e.tileSet,t)})),null)}});const Me=(e,t)=>{let i=new n.GeoJsonDataSource(e?.id);const r={type:"FeatureCollection",features:(0,we.flattenFeatures)(e?.features||[],(e=>{let{style:t,...i}=e;return i}))};return e.visibility&&i.load(r,{stroke:new n.Color(0,0,0,0),fill:new n.Color(0,0,0,0),markerColor:new n.Color(0,0,0,0),strokeWidth:0,markerSize:0}).then((()=>{t.dataSources.add(i),(0,we.layerToGeoStylerStyle)(e).then((r=>{(0,we.getStyle)((0,we.applyDefaultStyleToLayer)({...e,style:r}),"cesium").then((r=>{r&&r({entities:i?.entities?.values,map:t,opacity:e.opacity??1}).then((()=>{t.scene.requestRender()}))}))}))})),i.show=!!e.visibility,i.queryable=void 0===e.queryable||e.queryable,{detached:!0,dataSource:i,remove:()=>{i&&t&&(t.dataSources.remove(i),i=void 0)},setVisible:()=>{}}};r.default.registerType("vector",{create:Me,update:(e,t,i,r)=>W()(t.features,i.features)&&t.visibility===i.visibility?(!e?.dataSource?.entities?.values||W()(t.style,i.style)&&t.opacity===i.opacity||(0,we.layerToGeoStylerStyle)(t).then((i=>{(0,we.getStyle)((0,we.applyDefaultStyleToLayer)({...t,style:i}),"cesium").then((i=>{i&&i({entities:e.dataSource.entities.values,map:r,opacity:t.opacity??1}).then((()=>{r.scene.requestRender()}))}))})),null):Me(t,r)});var Pe=i(470509),Te=i.n(Pe),Ae=i(487758),Ee=i(988594);const Le=(e,t)=>{let i=new n.GeoJsonDataSource(e?.id);const r=(0,V.v)(e),o=Te().CancelToken.source();return e.visibility&&((e,t,i)=>(0,Ae.Bm)(e.url,e.name,{outputFormat:"application/json",srsname:"EPSG:4326",...t},{cancelToken:i}))(e,r,o.token).then((r=>{let{data:o}=r;i.load(o,{stroke:new n.Color(0,0,0,0),fill:new n.Color(0,0,0,0),markerColor:new n.Color(0,0,0,0),strokeWidth:0,markerSize:0}).then((()=>{t.dataSources.add(i),(0,we.layerToGeoStylerStyle)(e).then((r=>{(0,we.getStyle)((0,we.applyDefaultStyleToLayer)({...e,style:r}),"cesium").then((r=>{r&&r({entities:i?.entities?.values,map:t,opacity:e.opacity??1}).then((()=>{t.scene.requestRender()}))}))}))}))})),i.show=!!e.visibility,i.queryable=void 0===e.queryable||e.queryable,{detached:!0,dataSource:i,remove:()=>{o?.cancel&&o.cancel(),i&&t&&(t.dataSources.remove(i),i=void 0)},setVisible:()=>{}}};r.default.registerType("wfs",{create:Le,update:(e,t,i,r)=>(0,Ee.Es)(i,t)||t.visibility!==i.visibility?Le(t,r):(!e?.dataSource?.entities?.values||W()(t.style,i.style)&&t.opacity===i.opacity||(0,we.layerToGeoStylerStyle)(t).then((i=>{(0,we.getStyle)((0,we.applyDefaultStyleToLayer)({...t,style:i}),"cesium").then((i=>{i&&i({entities:e.dataSource.entities.values,map:r,opacity:t.opacity??1}).then((()=>{r.scene.requestRender()}))}))})),null)});const ke=(e,t)=>{let i;switch(t.terrainProvider=void 0,e.provider){case"wms":i=new E(N.wmsToCesiumOptionsBIL(e));break;case"cesium":i=new n.CesiumTerrainProvider(function(e){return{url:e.url,credit:e?.options?.credit,ellipsoid:e?.options?.ellipsoid,requestMetadata:e?.options?.requestMetadata,requestWaterMask:e?.options?.requestWaterMask,requestVertexNormals:e?.options?.requestVertexNormals}}(e));break;default:i=new n.EllipsoidTerrainProvider}return t.terrainProvider=i,{detached:!0,terrainProvider:i,remove:()=>{t.terrainProvider=new n.EllipsoidTerrainProvider},setVisible:()=>{}}};r.default.registerType("terrain",{create:ke,update:(e,t,i,r)=>t.securityToken!==i.securityToken||i.credits!==t.credits||i.provider!==t.provider?ke(t,r):null});const Re={}},331655:(e,t,i)=>{"use strict";i.d(t,{$:()=>l,b:()=>c});var r=i(234228),n=i(701469),o=i.n(n),a=i(513218),s=i.n(a);const l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o()(e))return e.reduce(((e,t)=>l(t)&&e),!0);let i=!1,n=!(0===e.indexOf("http")),a=!n&&e.match(/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/);if(a){let e=window.location;n=a[1]===e.protocol&&a[3]===e.hostname;let t=a[4],i=e.port;(80!==t&&""!==t||"80"!==i&&""!==i)&&(n=n&&t===i)}if(!n){let n=r.ZP.getProxyUrl(t);if(n){let t=[];s()(n)&&(t=n.useCORS||[],n=n.url),t.reduce(((t,i)=>t||0===e.indexOf(i)),!1)||(i=!0)}}return i},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.ZP.getProxyUrl(e);return t&&s()(t)&&(t=t.url),t}},40649:(e,t,i)=>{"use strict";i.d(t,{z:()=>n});const r=["application/vnd.mapbox-vector-tile","application/json;type=geojson","application/json;type=topojson"],n=e=>-1!==r.indexOf(e)},594397:(e,t,i)=>{"use strict";i.d(t,{KF:()=>l,c4:()=>c,XI:()=>h,U2:()=>u,xB:()=>p,ir:()=>d});var r=i(288487),n=i(65792),o=i.n(n),a=i(545578),s=i.n(a);const l=e=>{let{color:t,opacity:i}=e;const[n,a,s,l]=o()(t).gl();return void 0!==i?new r.Color(n,a,s,i):new r.Color(n,a,s,l)},c=e=>{let{coordinates:t,width:i=4,color:n="#ff00ff",opacity:o=1,depthFailColor:a,depthFailOpacity:s,dashLength:c,clampToGround:h}=e;return new r[h?"GroundPolylinePrimitive":"Primitive"]({geometryInstances:new r.GeometryInstance({geometry:h?new r.GroundPolylineGeometry({positions:[...t],width:i}):new r.PolylineGeometry({positions:[...t],width:i,arcType:r.ArcType.NONE})}),appearance:new r.PolylineMaterialAppearance({material:c?r.Material.fromType("PolylineDash",{color:l({color:n,opacity:o}),dashLength:c}):r.Material.fromType("Color",{color:l({color:n,opacity:o})})}),...a&&{depthFailAppearance:new r.PolylineMaterialAppearance({material:c?r.Material.fromType("PolylineDash",{color:l({color:a,opacity:s}),dashLength:c}):r.Material.fromType("Color",{color:l({color:a,opacity:s})})})},allowPicking:!1,asynchronous:!1})},h=e=>{let{coordinates:t,color:i="#ff00ffAA",opacity:n=1,depthFailColor:o,depthFailOpacity:a}=e;return new r.Primitive({geometryInstances:new r.GeometryInstance({geometry:new r.PolygonGeometry({polygonHierarchy:new r.PolygonHierarchy([...t]),perPositionHeight:!0})}),appearance:new r.MaterialAppearance({material:r.Material.fromType("Color",{color:l({color:i,opacity:n})}),faceForward:!0}),...o&&{depthFailAppearance:new r.MaterialAppearance({material:r.Material.fromType("Color",{color:l({color:o,opacity:a})}),faceForward:!0})},allowPicking:!1,asynchronous:!1})},u=(e,t)=>{e?.scene?.primitives&&t&&!t.isDestroyed()&&(t.removeAll(),e.scene.primitives.remove(t))},p=function(e){let{stroke:t,strokeWidth:i=1,fill:r="#ffffff"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t?e+2*i:e,o=document.createElement("canvas");o.setAttribute("width",n),o.setAttribute("height",n);const a=o.getContext("2d");return a.beginPath(),r&&(a.fillStyle="#ffffff"),t&&(a.strokeStyle=t,a.lineWidth=i),a.arc(n/2,n/2,e/2,0,2*Math.PI),r&&a.fill(),t&&a.stroke(),o},d=(e,t,n)=>i.e(9706).then(i.bind(i,979706)).then((o=>{const a=o.default,l=n?e:a(e),{geometry:c}=l;return(h=[...c?.coordinates?.[0]||[]],i.e(4220).then(i.bind(i,574220)).then((e=>(0,e.default)({type:"Feature",geometry:{type:"LineString",coordinates:h},properties:{}})?h:[...h].reverse()))).then((e=>{const i=s()(t?e:e.reverse(),(e=>`${e[0]}${e[1]}`)).map((e=>{let[t,i,n=0]=e;return r.Cartesian3.fromDegrees(t,i,n)})),n=i.length,o=[];for(let e=0;e<n;++e){const t=(e+1)%n;let a=r.Cartesian3.add(i[e],i[t],new r.Cartesian3);a=r.Cartesian3.multiplyByScalar(a,.5,a);const s=r.Cartesian3.normalize(a,new r.Cartesian3);let l=r.Cartesian3.subtract(i[t],a,new r.Cartesian3);l=r.Cartesian3.normalize(l,l);let c=r.Cartesian3.cross(l,s,new r.Cartesian3);c=r.Cartesian3.normalize(c,c);const h=new r.Plane(c,0),u=r.Plane.getPointDistance(h,a);o.push(new r.ClippingPlane(c,u))}return o}));var h}))},798143:function(e,t,i){var r,n;void 0===(n="function"==typeof(r=function(){function e(e,t){return function(i,r,n,o){i[e]?i[e](r,n,o):i[t]&&i[t]("on"+r,n)}}return{add:e("addEventListener","attachEvent"),remove:e("removeEventListener","detachEvent")}})?r.call(t,i,t,e):r)||(e.exports=n)}}]);