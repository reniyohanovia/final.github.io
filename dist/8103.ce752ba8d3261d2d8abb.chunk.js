(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[8103],{148103:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var i=r(323113),s=r(877758),n=r(278426),o=r(904101),a=r(37525),l=r(926202),c=r(45697),p=r.n(c),u=r(124852),h=r.n(u),d=r(51273),g=r(436403),f=r(120767),m=r(898185),y=r(831219),w=r(409371);function b(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class I extends h().Component{constructor(){super(...arguments),b(this,"getLayer",(()=>{let e;return this.props.map.getLayers().forEach((t=>{this.layersFilter(t)&&(e=t)}),this),e})),b(this,"setSelectInteraction",(()=>{this._selectInteraction.getActive()||this._selectInteraction.setActive(!0)})),b(this,"createSelectInteraction",(()=>{this.createStyle(),this._selectInteraction=new d.Z({layers:this.layersFilter,style:this._style,toggleCondition:g.QC}),this._selectInteraction.on("select",this.selectionChange,this),this.props.map.addInteraction(this._selectInteraction)})),b(this,"selectionChange",(()=>{let e=[];this._selectInteraction.getFeatures().forEach((t=>{e.push(t.getId())})),this.props.updateHighlighted(e,"")})),b(this,"cleanSupport",(()=>{this._selectInteraction&&this._selectInteraction.getActive()&&(this._selectInteraction.getFeatures().clear(),this.props.updateHighlighted([],""),this._selectInteraction.setActive(!1))})),b(this,"layersFilter",(e=>this.props.layer&&e.get("msId")===this.props.layer)),b(this,"createStyle",(()=>{let e=this.props.selectedStyle,t={stroke:new f.default(e.stroke?e.stroke:{color:"blue",width:1}),fill:new m.default(e.fill?e.fill:{color:"blue"})};"Point"===e.type&&(t={image:new w.default({...t,radius:e.radius||5})}),this._style=new y.default(t)})),b(this,"highlightFeatures",(e=>{let t=this.getLayer(),r=this._selectInteraction.getFeatures();r.clear(),t&&t.getSource().getFeatures().map((t=>{-1!==e.indexOf(t.getId())&&r.push(t)}),this)}))}componentDidMount(){this.createSelectInteraction(),"enabled"===this.props.status?this._selectInteraction.setActive(!0):this._selectInteraction.setActive(!1),this.props.features&&this.highlightFeatures(this.props.features)}shouldComponentUpdate(e){let t=this.props;return e.status!==t.status||e.layer!==t.layer||"update"===e.status&&e.features.toString()!==t.features.toString()}UNSAFE_componentWillUpdate(e){switch(e.status){case"enabled":this.setSelectInteraction(e);break;case"disabled":this.cleanSupport();break;case"update":this.highlightFeatures(e.features);break;default:return}}componentWillUnmount(){this._selectInteraction&&(this.cleanSupport(),this._selectInteraction.un("select",this.selectionChange,this),this.props.map.removeInteraction(this._selectInteraction),this._selectInteraction=null,this._style=null)}render(){return null}}b(I,"propTypes",{map:p().object,layer:p().string.isRequired,status:p().oneOf(["disabled","enabled","update"]),updateHighlighted:p().func,selectedStyle:p().object,features:p().array}),b(I,"contextTypes",{messages:p().object}),b(I,"defaultProps",{status:"disabled",updateHighlighted:()=>{},selectedStyle:{type:"Point",radius:12,stroke:{width:4,color:"yellow"},fill:{color:"red"}}});var S=r(973410),v=r(429902),k=r(372445),_=r(718369);function F(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class T extends h().Component{constructor(){super(...arguments),F(this,"addDrawInteraction",(e=>{this.drawInteraction&&this.removeDrawInteraction();let t=new S.Z,r=new v.Z({source:t,zIndex:1e6,style:new y.default({fill:new m.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new f.default({color:"#ffcc33",width:2}),image:new w.default({radius:7,fill:new m.default({color:"#ffcc33"})})})});this.props.map.addLayer(r);let i=new k.ZP({source:t,type:e.selection.geomType,style:new y.default({fill:new m.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new f.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new w.default({radius:5,stroke:new f.default({color:"rgba(0, 0, 0, 0.7)"}),fill:new m.default({color:"rgba(255, 255, 255, 0.2)"})})})});i.on("drawstart",(e=>{this.sketchFeature=e.feature,t.clear()})),i.on("drawend",(()=>{this.updateSelectionState()})),this.props.map.addInteraction(i),this.drawInteraction=i,this.selectionLayer=r,this.setDoubleClickZoomEnabled(!1)})),F(this,"removeDrawInteraction",(()=>{null!==this.drawInteraction&&(this.props.map.removeInteraction(this.drawInteraction),this.drawInteraction=null,this.props.map.removeLayer(this.selectionLayer),this.sketchFeature=null,setTimeout((()=>this.setDoubleClickZoomEnabled(!0)),251))})),F(this,"updateSelectionState",(()=>{if(!this.sketchFeature)return;const e=this.sketchFeature.getGeometry().getCoordinates();let t={geomType:this.props.selection.geomType,point:"Point"===this.props.selection.geomType?[e[0],e[1]]:null,line:"LineString"===this.props.selection.geomType?e.map((e=>[e[0],e[1]])):null,polygon:"Polygon"===this.props.selection.geomType?this.sketchFeature.getGeometry().getLinearRing(0).getCoordinates().map((e=>[e[0],e[1]])):null};this.props.changeSelectionState(t)})),F(this,"setDoubleClickZoomEnabled",(e=>{let t=this.props.map.getInteractions();for(let r=0;r<t.getLength();r++){let i=t.item(r);if(i instanceof _.Z){i.setActive(e);break}}}))}UNSAFE_componentWillReceiveProps(e){e.selection.geomType&&e.selection.geomType!==this.props.selection.geomType&&this.addDrawInteraction(e),e.selection.geomType||this.removeDrawInteraction()}render(){return null}}F(T,"propTypes",{map:p().object,projection:p().string,selection:p().object,changeSelectionState:p().func}),F(T,"defaultProps",{selection:{}});var Z=r(993847),C=r(227556);const P={LMap:i.Z,Layer:s.Z,Feature:n.Z,Overview:o.Z,ScaleBar:a.Z,DrawSupport:l.Z,HighlightFeatureSupport:I,SelectionSupport:T,PopupSupport:Z.Z,BoxSelectionSupport:C.Z}}}]);