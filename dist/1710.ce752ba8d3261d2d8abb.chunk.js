(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[1710],{564864:(e,r,t)=>{"use strict";t.d(r,{y6:()=>l,g$:()=>i,Xk:()=>a,H1:()=>s,MY:()=>o,Xs:()=>u,no:()=>n,Nd:()=>d,Zq:()=>p,Xr:()=>c,Rb:()=>F,HH:()=>f});const l="LAYER_FILTER:INIT_LAYER_FILTER",i="LAYER_FILTER:APPLIED_FILTER",a="LAYER_FILTER:STORE_CURRENT_APPLIED_FILTER",s="LAYER_FILTER:DISCARD_CURRENT_FILTER",o="LAYER_FILTER:APPLY_FILTER",u="LAYER_FILTER:OPEN_QUERY_BUILDER";function n(){return{type:a}}function d(){return{type:s}}function p(){return{type:u}}function c(e){return{type:i,filter:e}}function F(){return{type:o}}function f(e){return{type:l,filter:e}}},698183:(e,r,t)=>{"use strict";t.d(r,{Z:()=>d});var l=t(612132),i=t(306692),a=t(884757),s=t(687753),o=t(727418),u=t.n(o);const n={featureTypes:{},data:{},result:null,resultError:null,syncWmsFilter:!1,isLayerFilter:!1},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case l.S0:return u()({},e,{typeName:r.typeName,url:r.url});case l.u7:return u()({},e,{featureTypes:u()({},e.featureTypes,{[r.typeName]:r.featureType})});case l.lN:return u()({},e,{featureTypes:u()({},e.featureTypes,{[r.typeName]:{error:r.error}})});case l.yz:return u()({},e,{featureLoading:r.isLoading});case l.lj:return u()({},e,{featureLoading:!1,data:u()({},e.data,{[r.typeName]:(t=r.feature,["STATE_NAME","STATE_ABBR","SUB_REGION","STATE_FIPS"].map((e=>({attribute:e,values:t.features.reduce(((r,t)=>-1===r.indexOf(t.properties[e])?[...r,t.properties[e]].sort():r),[])}))).reduce(((e,r)=>u()(e,{[r.attribute]:r.values.map((e=>({id:e,name:e})))})),{}))})});case l.zW:return u()({},e,{featureLoading:!1,featureTypes:u()({},e.data,{[r.typeName]:{error:r.error}})});case l.Yx:return u()({},e,{isNew:!0,searchUrl:r.searchUrl,filterObj:r.filterObj});case l.VN:return u()({},e,{filterObj:u()({},e.filterObj,r.updates)});case l.Hu:return u()({},e,{isNew:!1,result:r.result,searchUrl:r.searchUrl,filterObj:r.filterObj,resultError:null});case l.VT:return u()({},e,{isNew:!1,result:null,resultError:r.error});case s.l:case a.Eg:return r.skip&&r.skip.indexOf("query")>=0?e:u()({},e,{isNew:!1,result:null,filterObj:null,searchUrl:null,filters:null});case l.RD:return u()({},e,{result:null,resultError:null});case l._T:return u()({},e,{syncWmsFilter:!e.syncWmsFilter});case i.WB:return u()({},e,{syncWmsFilter:r.syncWmsFilter});case l.vO:return u()({},e,{isLayerFilter:!e.isLayerFilter});default:return e}var t}},13316:(e,r,t)=>{"use strict";t.d(r,{Z:()=>m});var l=t(884757),i=t(296252),a=t(727418),s=t.n(a),o=t(819412),u=t.n(o),n=t(294707),d=t.n(n),p=t(227361),c=t.n(p),F=t(521923);const f={searchUrl:null,featureTypeConfigUrl:null,showGeneratedFilter:!1,attributePanelExpanded:!0,spatialPanelExpanded:!0,crossLayerExpanded:!0,showDetailsPanel:!1,groupLevels:5,useMapProjection:!1,toolbarEnabled:!0,groupFields:[{id:1,logic:"OR",index:0}],maxFeaturesWPS:5,filterFields:[],spatialField:{method:null,attribute:"the_geom",operation:"INTERSECTS",geometry:null},simpleFilterFields:[]},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=s()({},e,{[r.fieldName]:r.fieldValue,type:r.fieldType},{fieldOptions:s()({},{...e.fieldOptions},{currentPage:void 0===r.fieldOptions.currentPage?1:r.fieldOptions.currentPage})});return"attribute"===r.fieldName&&(t.value="string"===r.fieldType?"":null,t.operator="="),"operator"===r.fieldName&&(t.value=null),t},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case l.E6:{const t={rowId:(new Date).getTime(),groupId:r.groupId,attribute:null,operator:"=",value:null,type:null,fieldOptions:{valuesCount:0,currentPage:1},exception:null};return s()({},e,{filterFields:e.filterFields?[...e.filterFields,t]:[t]})}case l.vo:return s()({},e,{filterFields:e.filterFields.filter((e=>e.rowId!==r.rowId))});case l.l1:return s()({},e,{filterFields:e.filterFields.map((e=>e.rowId===r.rowId?y(e,r):e))});case l.o7:return s()({},e,{filterFields:e.filterFields.map((e=>e.rowId===r.filterField.rowId?s()({},e,{options:s()({},{...e.options},{[e.attribute]:r.options})},{fieldOptions:s()({},{...e.fieldOptions},{valuesCount:r.valuesCount})}):e))});case l.Sm:return"filterField"===r.layerFilterType?s()({},e,{filterFields:e.filterFields.map((e=>e.rowId===r.rowId?s()({},e,{openAutocompleteMenu:r.status}):e))}):(0,F.t8)("crossLayerFilter.collectGeometries.queryCollection.filterFields",(c()(e,"crossLayerFilter.collectGeometries.queryCollection.filterFields")||[]).map((e=>e.rowId===r.rowId?{...e,openAutocompleteMenu:r.status}:e)),e);case l.D6:return s()({},e,{autocompleteEnabled:r.status});case l.Nr:return"filterField"===r.layerFilterType?s()({},e,{filterFields:e.filterFields.map((e=>e.rowId===r.filterField.rowId?s()({},e,{loading:r.status}):e))}):(0,F.t8)("crossLayerFilter.collectGeometries.queryCollection.filterFields",(c()(e,"crossLayerFilter.collectGeometries.queryCollection.filterFields")||[]).map((e=>e.rowId===r.filterField.rowId?{...e,loading:r.status}:e)),e);case l.J9:return s()({},e,{filterFields:e.filterFields.map((e=>e.rowId===r.rowId?s()({},e,{exception:r.exceptionMessage}):e))});case l.U:{const t={id:(new Date).getTime(),logic:"OR",groupId:r.groupId,index:r.index+1};return s()({},e,{groupFields:e.groupFields?[...e.groupFields,t]:[t]})}case l.z8:return s()({},e,{groupFields:e.groupFields.map((e=>e.id===r.groupId?s()({},e,{logic:r.logic}):e))});case l.ql:return s()({},e,{filterFields:e.filterFields.filter((e=>e.groupId!==r.groupId)),groupFields:e.groupFields.filter((e=>e.id!==r.groupId))});case l.O_:return s()({},e,{filterFields:e.filterFields.map((e=>{for(let t=0;t<r.attributes.length;t++)if(e.attribute===r.attributes[t].id)return s()({},e,{value:null});return e}))});case l.M$:return s()({},e,{attributePanelExpanded:r.expand});case l.Ug:return s()({},e,{spatialPanelExpanded:r.expand});case l.p5:return s()({},e,{crossLayerExpanded:r.expand});case l.Fz:return s()({},e,{crossLayerFilter:(0,F.t8)(r.key,r.value,e.crossLayerFilter)});case l.Gf:return(0,F.vy)("crossLayerFilter.collectGeometries.queryCollection.filterFields",{rowId:r.rowId,groupId:r.groupId,attribute:null,operator:"=",value:null,type:null,fieldOptions:{valuesCount:0,currentPage:1},exception:null},{rowId:r.rowId},e);case l.nh:return(0,F.t8)("crossLayerFilter.collectGeometries.queryCollection.filterFields",(c()(e,"crossLayerFilter.collectGeometries.queryCollection.filterFields")||[]).map((e=>e.rowId===r.rowId?y(e,r):e)),e);case l.Rf:return(0,F.z6)("crossLayerFilter.collectGeometries.queryCollection.filterFields",{rowId:r.rowId},e);case l.WZ:return s()({},e,{crossLayerFilter:{attribute:e.crossLayerFilter&&e.crossLayerFilter.attribute}});case l.Xp:return(0,F.t8)("crossLayerFilter.collectGeometries.queryCollection.filterFields",(c()(e,"crossLayerFilter.collectGeometries.queryCollection.filterFields")||[]).map((e=>e.rowId===r.filterField.rowId?{...e,options:{...e.options,[e.attribute]:r.options},fieldOptions:{...e.fieldOptions,valuesCount:r.valuesCount}}:e)),e);case l.bP:return s()({},e,{spatialField:s()({},e.spatialField,{[r.fieldName]:r.method,geometry:null})});case l.d_:return s()({},e,{spatialField:s()({},e.spatialField,{geometry:r.geometry})},{toolbarEnabled:!0});case l.xM:return s()({},e,{spatialField:s()({},e.spatialField,{[r.fieldName]:r.operation})});case l.bl:return s()({},e,{spatialField:s()({},e.spatialField,{attribute:r.attribute}),crossLayerFilter:s()({},e.crossLayerFilter,{attribute:r.attribute})});case i.hZ:return"queryform"===r.owner&&"start"===r.status?s()({},e,{toolbarEnabled:!1}):e;case l.Wi:return s()({},e,{toolbarEnabled:!0,spatialField:s()({},e.spatialField,{value:r.value,collectGeometries:r.collectGeometries,geometry:r.srsName?{...r.geometry,projection:r.srsName}:r.geometry})});case i.pb:{let t;return t="queryform"===r.owner?s()({},e,{toolbarEnabled:!0,spatialField:s()({},e.spatialField,{collectGeometries:r.collectGeometries,geometry:r.geometry})}):e,t}case l.PN:{let r=s()({},f.spatialField,{attribute:e.spatialField.attribute,value:void 0});return s()({},e,{spatialField:s()({},e.spatialField,r)})}case l._M:return s()({},e,{showDetailsPanel:r.show});case l.Eg:{let r=s()({},f.spatialField,{attribute:e.spatialField.attribute,value:void 0}),t={attribute:e.crossLayerFilter&&e.crossLayerFilter.attribute};return s()({},e,f,{spatialField:r,crossLayerFilter:t,filters:[]})}case l.V1:return s()({},e,{showGeneratedFilter:r.data});case l.cY:return s()({},e,{spatialField:s()({},e.spatialField,{geometry:s()({},e.spatialField.geometry,{distance:r.distance})})});case l.co:return s()({},e,{spatialField:s()({},e.spatialField,{zoneFields:e.spatialField.zoneFields.map((e=>e.id===r.id&&r.data.features&&r.data.features.length>0?s()({},e,{values:r.data.features,open:!0,error:null}):e))})});case l.RD:return s()({},e,{spatialField:s()({},e.spatialField,{zoneFields:e.spatialField.zoneFields.map((e=>e.id===r.id?s()({},e,{busy:r.active}):e))})});case l.uY:{let t,l;const i=e.spatialField.zoneFields.map((e=>{if(e.id===r.id){if(t=e.multivalue?r.value.value:r.value.value[0],r.value.feature[0]){let t=r.value.feature[0],i=t.geometry_name;if(e.multivalue&&r.value.feature.length>1){for(let e=1;e<r.value.feature.length;e++){let l=r.value.feature[e];l&&(t=u()(t,l))}l={coordinates:t.geometry.coordinates,geometryName:i,geometryType:t.geometry.type}}else l={coordinates:t.geometry.coordinates,geometryName:i,geometryType:t.geometry.type}}return s()({},e,{value:t,open:!1,geometryName:l?l.geometryName:null})}return e.dependson&&r.id===e.dependson.id?s()({},e,{disabled:!1,values:null,value:null,open:!1,dependson:s()({},e.dependson,{value:t})}):e}));let a=d()({type:"FeatureCollection",features:r.value.feature});return s()({},e,{spatialField:s()({},e.spatialField,{zoneFields:i,geometry:a&&l?{extent:a,type:l.geometryType,coordinates:l.coordinates}:null})})}case l.H8:return s()({},e,{spatialField:s()({},e.spatialField,{zoneFields:e.spatialField.zoneFields.map((e=>{let r=s()({},e,{values:null,value:null,open:!1,error:null});return e.dependson?s()({},r,{disabled:!0,open:!1,value:null,dependson:s()({},e.dependson,{value:null})}):r})),geometry:null})});case l.Hl:{let t;return s()({},e,{spatialField:s()({},e.spatialField,{zoneFields:e.spatialField.zoneFields.map((e=>e.id===r.id?(t="object"!=typeof r.error?r.error.status&&r.error.statusText&&r.error.data?{status:r.error.status,statusText:r.error.statusText,data:r.error.data}:{message:r.error.message||"unknown error"}:r.error,s()({},e,{error:t,busy:!1})):e))})})}case l.je:{const t=e.simpleFilterFields.reduce(((e,t)=>(t.fieldId===r.id?e.push({...t,...r.properties}):e.push(t),e)),[]);return{...e,simpleFilterFields:t}}case l.qu:{const t=(e.filters??[]).reduce(((e,t)=>{const l=r.filters.find((e=>e.id===t.id));return l?e.push(l):e.push(t),e}),[]);return r.filters.forEach((e=>{t.find((r=>r.id===e.id))||t.push(e)})),{...e,filters:t}}case l.LY:{const t=(e.filters??[]).reduce(((e,t)=>(r.filters.find((e=>e.id===t.id))||e.push(t),e)),[]);return{...e,filters:t}}case l.go:{const t=r.properties.fieldId?r.properties:{...r.properties,fieldId:(new Date).getTime()},l=e.simpleFilterFields?[...e.simpleFilterFields,t]:[t];return{...e,simpleFilterFields:l}}case l._8:return{...e,simpleFilterFields:e.simpleFilterFields.filter((e=>e.fieldId!==r.id))};case l.xd:return{...e,simpleFilterFields:[]};case l.Ef:const{attribute:t,...a}=f.spatialField,o=s()({},f,{spatialField:{...a}}),{spatialField:n,filterFields:p,groupFields:m,crossLayerFilter:g,attributePanelExpanded:b,spatialPanelExpanded:I,crossLayerExpanded:E,filters:L}=r.filter||o;return{...e,attributePanelExpanded:b,spatialPanelExpanded:I,crossLayerExpanded:E,spatialField:{...n,attribute:n&&n.attribute||e.spatialField&&e.spatialField.attribute},filters:L??[],filterFields:p,groupFields:m,crossLayerFilter:{...g,attribute:g&&g.attribute||e.crossLayerFilter&&e.crossLayerFilter.attribute}};default:return e}}}}]);