(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[1195],{52855:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(124852),o=a.n(n),r=a(630294);const l=(0,a(486234).Z)("placeholder")(r.FormControl),s=e=>{let{onSearchTextChange:t=(()=>{}),searchText:a,title:n,subTitle:s=null}=e;return o().createElement(r.Grid,{className:"catalog-form",fluid:!0},o().createElement(r.Row,null,o().createElement(r.Col,{xs:12},n&&o().createElement("h4",{className:"text-center"},n),s,o().createElement(r.FormGroup,{controlId:"catalog-form"},o().createElement(l,{type:"text",placeholder:"catalog.textSearchPlaceholder",value:a,onChange:e=>t(e.currentTarget.value)})))))}},768977:(e,t,a)=>{"use strict";a.d(t,{Z:()=>m});var n=a(45697),o=a.n(n),r=a(124852),l=a.n(r),s=a(630294),i=a(222777);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},c.apply(this,arguments)}function d(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class p extends l().Component{render(){const{cardComponent:e,items:t,colProps:a,onItemClick:n,size:o}=this.props,r=e||i.Z;return l().createElement("div",{className:"msSideGrid"+(this.props.className?" "+this.props.className:"")},l().createElement(s.Row,{className:"items-list"},t.map(((e,t)=>l().createElement(s.Col,c({key:e.id||t},a),l().createElement(r,c({onClick:function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return n(e,...a)},size:o},e)))))))}}d(p,"propTypes",{size:o().string,onItemClick:o().func,colProps:o().object,items:o().array,cardComponent:o().oneOfType([o().string,o().func]),className:o().string}),d(p,"defaultProps",{size:"",onItemClick:()=>{},colProps:{xs:12},className:"",items:[]});const m=p},890032:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(867076);const o=a(49977),r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>o.Observable.empty(),t=arguments.length>1?arguments[1]:void 0;return(0,n.mapPropsStream)((a=>{const{handler:r,stream:l}=(0,n.createEventHandler)(),{handler:s,stream:i}=(0,n.createEventHandler)();return a.combineLatest(function(e,t,a){let{dataProp:n="items",initialStreamDebounce:r=0,throttleTime:l=500}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e.take(1).concat(e.debounceTime(r)).switchMap((e=>a(e,0).startWith({loading:!0}).concat(o.Observable.of({loading:!1})).concat(t.throttleTime(l).distinct().exhaustMap((t=>a(e,t).startWith({loading:!0}).concat(o.Observable.of({loading:!1}))))).scan(((e,t)=>{let{[n]:a,...o}=e,{[n]:r,...l}=t;return{[n]:r?[...a||[],...r]:a||[],...o,...l}})).map((e=>({...e}))))).catch((e=>o.Observable.of({loading:!1,error:e})))}(i,l,e,t).startWith({}),((e,t)=>({...e,...t,onLoadMore:r,loadFirst:s})))}))}},185936:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(890032),o=a(867076),r=a(274335);const l=e=>{let{loadPage:t,scrollSpyOptions:a,loadStreamOptions:l,loadMoreStreamOptions:s,hasMore:i,isScrolled:c}=e;return(0,o.compose)((0,n.Z)(t,s),(0,o.defaultProps)({hasMore:i,isScrolled:c}),(0,r.Z)(a,l))}},274335:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var n=a(124852),o=a.n(n),r=a(45697),l=a.n(r),s=a(180307),i=a.n(s);function c(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a(49977);const d=function(){let{dataProp:e="items",querySelector:t,closest:a=!1,loadingProp:n="loading",skip:r=0,pageSize:s=10,offsetSize:d=200}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p=>{var m;return m=class extends o().Component{constructor(){super(...arguments),c(this,"findScrollDomNode",(()=>{if(!this.isMounded)return null;let e=i().findDOMNode(this);return e&&a&&t?e.closest(t||"*"):e&&(t?e.querySelector(t):e)})),c(this,"onScroll",(()=>{const t={skip:r,pageSize:s,offsetSize:d,...this.props.scrollOptions},a=this.findScrollDomNode();a&&this.props.isScrolled({div:a,offset:t.offsetSize})&&(!e||this.props[e]&&this.props[e].length)&&(!n||!this.props[n])&&this.props.hasMore(this.props)&&this.props.onLoadMore(e?Math.ceil((this.props[e].length-t.skip)/t.pageSize):null)}))}componentDidMount(){this.isMounded=!0;const e=this.findScrollDomNode();e&&(this.listenerAdded=!0,e.addEventListener("scroll",this.onScroll,!1),this.onScroll())}componentDidUpdate(t){const a=this.findScrollDomNode();a&&!this.listenerAdded&&(a.addEventListener("scroll",this.onScroll,!1),this.listenerAdded=!0),!a||e&&this.props[e]&&this.props[e]===t[e]||setTimeout((()=>this.onScroll()),300)}componentWillUnmount(){this.isMounded=!1,this.listenerAdded=!1;const e=this.findScrollDomNode();e&&e.removeEventListener("scroll",this.onScroll,!1)}render(){return o().createElement(p,this.props)}},c(m,"propTypes",{hasMore:l().func,onLoadMore:l().func,isScrolled:l().func,scrollOptions:l().object}),c(m,"defaultProps",{onLoadMore:()=>{},hasMore:()=>!0,isScrolled:e=>{let{div:t,offset:a}=e;return t.scrollTop+t.clientHeight>=t.scrollHeight-a}}),m}}},77665:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(124852),o=a.n(n),r=a(630294);const l=e=>{let{title:t,description:a}=e;return o().createElement(r.Row,null,o().createElement(r.Col,{xs:12,className:"text-center"},o().createElement("div",{className:"mapstore-step-title"},t),o().createElement("div",{className:"mapstore-step-description"},a)))}},657579:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(124852),o=a.n(n),r=a(804504),l=a(141919);const s=e=>(0,l.Z)(e,{title:o().createElement(r.Z,{msgId:"widgets.builder.errors.noAttributesTitle"}),description:o().createElement(r.Z,{msgId:"widgets.builder.errors.noAttributesDescription"}),glyph:"warning-sign"})},500023:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(740292),o=a(867076);const r=(0,o.compose)((0,o.withHandlers)({onMapViewChanges:e=>{let{onChange:t=(()=>{})}=e;return e=>{t("maps",e),t("mapStateSource",e.mapStateSource)}}}))(n.Z)},81674:(e,t,a)=>{"use strict";a.d(t,{l:()=>i});var n=a(49977),o=a(470509),r=a.n(o),l=a(510810),s=a(474810);const i=(e,t)=>n.Observable.defer((()=>r().get((0,s.Jy)(e,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:t}),{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}}))).let(l.oB)},21195:(e,t,a)=>{"use strict";a.d(t,{Z:()=>Qo});var n=a(124852),o=a.n(n),r=a(171703),l=a(22222),s=a(867076),i=a(952273),c=a(756435),d=a(492838),p=a(554155),m=a(141919),g=a(509978),u=a(227361),h=a.n(u),y=a(49977),b=a.n(y),v=a(141520),C=a(81674);function f(e){return(0,C.l)(e.url,"gs:Aggregate")}var E=a(131400),w=a(452341);const S=function(){let{needsWPS:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.compose)((0,s.defaultProps)({dataStreamFactory:function(t){let{onEditorChange:a=(()=>{}),onConfigurationError:n=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.distinctUntilChanged((function(){let{layer:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{layer:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.name===t.name})).switchMap((function(){let{layer:t,editorData:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y.Observable.forkJoin((0,v.v$)({layer:t}),...e?[f(t)]:[f(t).catch((()=>y.Observable.of(!1)))]).do((e=>{let[t]=e;const o=h()((0,w.findGeometryProperty)(t.data||{}),"name");o&&function(){let{onEditorChange:e,geomProp:t,editorData:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n="geomProp";a?.selectedChartId&&(n=`charts[${a?.selectedChartId}].geomProp`),e(n,t)}({onEditorChange:a,editorData:n,geomProp:o})})).map((e=>{let[t,a]=e;return{hasAggregateProcess:!!a,loading:!1,types:"ALL",featureTypeProperties:h()(t,"data.featureTypes[0].properties")||[]}}))})).catch((e=>(n(e),y.Observable.of({errorObj:e,loading:!1,featureTypeProperties:[]})))).startWith({loading:!0})}}),g.Z,(0,p.Z)(),(0,m.Z)((e=>{let{featureTypeProperties:t=[],types:a=[]}=e;return 0===t.length||0===a.length}),(()=>({title:o().createElement(E.v0,{msgId:"widgets.builder.errors.noWidgetsAvailableTitle"}),description:o().createElement(E.k9,{msgId:"widgets.builder.errors.noWidgetsAvailableDescription"})}))))},x=(0,s.withProps)((e=>{let{onResetChange:t=(()=>{})}=e;return{stepButtons:[{glyph:"arrow-left",tooltipId:"widgets.builder.wizard.backToWidgetTypeSelection",onClick:()=>{t("options",void 0),t("widgetType",void 0)}}]}}));var P=a(352353),Z=a.n(P),T=a(943650),A=a(964091);const I=(e,t)=>["tms","wfs"].includes(t?.type)?e:A.Z[t?.type||"wms"].getLayerFromRecord(e,{service:t}),k=(e,t)=>["tms","wmts"].includes(t?.type)?b().Observable.of(I(e,t)):(0,T.HI)(I(e,t)),O=(0,s.compose)((0,s.withState)("selected","setSelected",null),(0,s.withState)("layer","setLayer",null),(0,s.mapPropsStream)((e=>e.distinctUntilKeyChanged("selected").filter((function(){let{selected:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).switchMap((function(){let{selected:e,layerValidationStream:t=(e=>e),setLayer:a=(()=>{}),dashboardSelectedService:n,dashboardServices:o,defaultSelectedService:r,defaultServices:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return b().Observable.of(I(e,o?o[n]:l[r])).let(t).switchMap((()=>k(e,o?o[n]:l[r]))).do((e=>a({...e,visibility:!!Z()(e.visibility)||e.visibility}))).mapTo({canProceed:!0}).catch((e=>b().Observable.of({error:e,canProceed:!1})))})).startWith({canProceed:!0}).combineLatest(e,(function(){let{canProceed:e,error:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{error:t,canProceed:e,...arguments.length>1?arguments[1]:void 0}}))))),L=e=>y.Observable.forkJoin((0,v.v$)({layer:e}));var N=a(984596),M=a.n(N),z=a(441609),F=a.n(z),D=a(988618);const R=(0,r.connect)((()=>({})),{onLayerChoice:function(){return(0,d.Rz)(...arguments)},onResetChange:d.Rz}),B=(0,s.compose)((0,s.withState)("selected","setSelected",null),(0,s.withState)("layer","setLayer",null),(0,s.mapPropsStream)((e=>e.distinctUntilKeyChanged("selected").filter((function(){let{selected:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).switchMap((function(){let{selected:e,layerValidationStream:t=(e=>e),setLayer:a=(()=>{}),dashboardSelectedService:n,dashboardServices:o,defaultSelectedService:r,defaultServices:l,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return b().Observable.of(M()(e)?.map((e=>I(e,o?o[n]:l[r])))).let((e=>t(e,s))).switchMap((()=>b().Observable.forkJoin(e.map((e=>k(e,o?o[n]:l[r])))))).do((e=>a(e?.map((e=>({...e,visibility:!!Z()(e.visibility)||e.visibility})))))).mapTo({canProceed:!0}).catch((e=>b().Observable.of({layerError:`widgets.builder.errors.${e?.code?"noWidgetsAvailableDescription":e?.message}`,canProceed:!1})))})).startWith({canProceed:!0}).combineLatest(e,(function(){let{canProceed:e,layerError:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{layerError:t,canProceed:e,...arguments.length>1?arguments[1]:void 0}})))),(0,s.withProps)((e=>{let{selected:t,setSelected:a}=e;return{getItems:e=>e.map((e=>!F()(t)&&e&&e.record&&t.some((t=>t.identifier===e.record.identifier))?{...e,selected:!0}:e)),onItemClick:function(){let{record:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((arguments.length>2?arguments[2]:void 0).ctrlKey){const n=M()(t);if(F()(t))return a(M()(e));const o=n.find((t=>t?.identifier===e?.identifier));return a(o?n.filter((t=>t?.identifier!==e?.identifier)):n.concat(e))}return a(M()(e))}}}))),W=(0,s.compose)((0,s.setDisplayName)("ChartLayerSelector"),R,(0,s.defaultProps)({layerValidationStream:(e,t)=>e.switchMap((e=>b().Observable.forkJoin(e.map((e=>L(e)))).switchMap((a=>{let n=b().Observable.of(e);const o=(0,D.YE)({widgets:t?.widgets,dependenciesMap:h()(t,"editorData.dependenciesMap",{})});if(a.length&&"table"===o.widgetType){const e=a.map((e=>h()(e[0],"data.featureTypes[0].properties")?.map((e=>e.name)))),t=h()(o,"options.propertyName",[]);t.length&&e?.length&&(n=e.every((e=>t.every((t=>e.includes(t)))))?n:b().Observable.throw(new Error("attributesNotMatchingDescription")))}return n}))))}),x,B),j=e=>(0,s.withHandlers)({toggleConnection:t=>{let{toggleConnection:a=(()=>{}),editorData:n={}}=t;return function(){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((e=>{const[,a,n]=d.jB.exec(e)||[];return a&&n?t.some((e=>e.id===a&&e.selectedMapId===n)):e}));return a(!n.mapSync,o,{dependenciesMap:n.dependenciesMap,mappings:e,sourceWidgetType:n.widgetType})}}}),G=(e,t,a)=>"table"===t&&0===e.filter((e=>Object.keys(e).filter((t=>e[t]&&-1!==e[t].indexOf(a.id))).length>0)).length,U=(0,s.compose)((0,s.withProps)((e=>{let{editorData:t={},widgets:a=[]}=e;const n="chart"===t.widgetType&&t?.selectedChartId?t?.charts?.find((e=>e.chartId===t?.selectedChartId))?.geomProp:t.geomProp,o=a.filter((e=>{let{mapSync:t,dependenciesMap:a}=e;return t&&a})).map((e=>{let{dependenciesMap:t}=e;return t}));return{canConnect:n&&"table"!==t.widgetType||G(o,t.widgetType,t),connected:t.mapSync}})),j({viewport:"viewport",layers:"layers",filter:"filter",quickFilters:"quickFilters",layer:"layer",options:"options",mapSync:"mapSync",dependenciesMap:"dependenciesMap"}));var V=a(715828),q=a(804504);const Y=(0,s.compose)((0,r.connect)((0,l.P1)(i.xI,(e=>({widgetSelectionActive:e})))),(0,V.Z)((e=>{let{widgetSelectionActive:t}=e;return t}),(()=>o().createElement("div",{style:{margin:"auto"}},o().createElement(q.Z,{msgId:"widgets.builder.wizard.selectMapToConnect"}))),{alwaysWrap:!0})),$=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>!0;return(0,s.compose)((0,s.withProps)((t=>{let{disableMultiDependencySupport:a,stepButtons:n=[],toggleConnection:o=(()=>{}),availableDependencies:r=[],canConnect:l,connected:s,...i}=t;return{stepButtons:[...n,{onClick:()=>o(r,i.widgets),disabled:a,visible:!!e(i)&&r.length>0,bsStyle:!a&&s?"success":"primary",glyph:s?"plug":"unplug",tooltipId:a||!l?"widgets.builder.wizard.disableConnectToMap":s?"widgets.builder.wizard.clearConnection":1===r.length?"widgets.builder.wizard.connectToTheMap":"widgets.builder.wizard.connectToAMap"}]}})))};var H=a(366907),K=a(618446),Q=a.n(K),_=a(478718),J=a.n(_),X=a(45697),ee=a.n(X),te=a(630294),ae=a(23888);function ne(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class oe extends o().Component{constructor(){super(...arguments),ne(this,"renderButtons",(()=>{let e=[];const{isStepValid:t,children:a=[]}=this.props,n=a.length>=0?a.length:1;return this.props.hideButtons?null:(this.props.step>0&&e.push(o().createElement(ae.Z,{key:"prev",className:"ms-wizard-prev",onClick:()=>this.props.onPrevPage()},o().createElement(q.Z,{msgId:"wizard.prev"}))),this.props.step>=n-1?e.push(o().createElement(ae.Z,{key:"finish",className:"ms-wizard-finish",onClick:()=>this.props.onFinish()},o().createElement(q.Z,{msgId:"wizard.finish"}))):this.props.step<n-1&&n>1&&e.push(o().createElement(ae.Z,{key:"next",className:"ms-wizard-next",disabled:!t(this.props.step),onClick:()=>this.props.onNextPage()},o().createElement(q.Z,{msgId:"wizard.next"}))),e)}))}render(){const e=this.props.children||[],t=e.length>=0?e.length:1;return o().createElement("div",{key:"wizard-pages",className:`ms-wizard ${this.props.className||""}`},o().Children.map(e,((e,a)=>a===this.props.step?o().cloneElement(e,{key:`wizard-component-${a}`,onNextPage:this.props.step===t-1?this.props.onFinish:this.props.onNextPage,onPrevPage:this.props.onPrevPage}):null)),o().createElement(te.Row,{key:"wizard-buttons",className:"ms-wizard-buttons"},this.renderButtons()))}}ne(oe,"propTypes",{step:ee().number,hideButtons:ee().bool,onNextPage:ee().func,onPrevPage:ee().func,buttonType:ee().node,onFinish:ee().func,isStepValid:ee().func,className:ee().string}),ne(oe,"defaultProps",{step:0,isStepValid:()=>!0,hideButtons:!1,onNextPage:()=>{},onPrevPage:()=>{},onFinish:()=>{}});const re=oe,le=(0,s.compose)((0,s.withPropsOnChange)(["step"],(function(){let{skipButtonsOnSteps:e=[],step:t,hideButtons:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e&&e.indexOf(t)>=0?{hideButtons:!0}:{hideButtons:a}})),(0,s.withHandlers)({onNextPage:e=>{let{step:t,setPage:a=(()=>{})}=e;return()=>{a(t+1)}},onPrevPage:e=>{let{step:t,setPage:a=(()=>{})}=e;return()=>{a(Math.max(t-1,0))}}}));(0,s.compose)((0,s.withState)("step","setPage",0),le);var se=a(657579),ie=a(743129),ce=a(486234);const de=(0,ce.Z)(["noResultsText"])(ie.ZP),pe=[{type:"bar",glyph:"stats"},{type:"pie",glyph:"pie-chart"},{type:"line",glyph:"line"}],me=e=>{let{value:t,glyph:a}=e;return o().createElement("span",null,o().createElement(te.Glyphicon,{glyph:a})," ",`${t.charAt(0).toUpperCase()+t.slice(1)} Chart`)};var ge=a(313311),ue=a.n(ge);const he=e=>e.filter((function(){let{type:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0!==e.indexOf("gml:")})).map((function(){let{name:e,localType:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,value:e,type:t}})).filter((e=>"string"===e.type||"number"===e.type)),ye=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const a=ue()(t,{name:e});return!a||"number"!==a.localType&&"int"!==a.localType?[{value:"Count",label:"widgets.operations.COUNT"}]:(0,D.Mt)()},be=(0,s.compose)((0,s.withProps)((function(){let{featureTypeProperties:e=[],data:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{options:(a=e,a.filter((function(){let{type:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0!==e.indexOf("gml:")})).map((function(){let{name:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,value:e}}))),typedOptions:he(e),aggregationOptions:("counter"!==t?.widgetType?[{value:"None",label:"widgets.operations.NONE"}]:[]).concat(ye(t.options&&t.options.aggregationAttribute,e))};var a})),(0,ce.Z)("aggregationOptions"));var ve=a(91175),Ce=a.n(ve),fe=a(894449),Ee=a(209756),we=a(584202),Se=a(77665),xe=a(594239),Pe=a(414293),Ze=a.n(Pe),Te=a(867517),Ae=a(981537),Ie=a(423214),ke=a(118438);function Oe(e){let{showOnRender:t,placement:a,id:r,left:l,top:s,title:i,text:c,bsStyle:d="info",glyph:p="question-sign",popoverClassName:m}=e;const[g,u]=(0,n.useState)(t);let h=(0,n.useRef)(null);return o().createElement(o().Fragment,null,o().createElement(te.Glyphicon,{onClick:()=>u(!g),ref:e=>h.current=e,style:{cursor:"pointer"},className:`text-${d}`,glyph:p}),o().createElement(ke.Z,{target:h.current,show:g,placement:a},o().createElement(te.Popover,{id:r,placement:a,positionLeft:l,positionTop:s,title:i,className:m},o().createElement(te.Glyphicon,{glyph:"1-close",style:{position:"absolute",right:0,top:0,margin:8},onClick:()=>u(!1)}),c)))}var Le=a(807654),Ne=a.n(Le),Me=a(664647),ze=a.n(Me),Fe=a(379785);function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},De.apply(this,arguments)}const Re={value:1};function Be(e){try{if(!e)return[!0];const t=(0,Fe.B)(e,Re);return[!Ze()(t)&&!Ne()(t)&&!ze()(t),t]}catch(e){return[!1,e]}}function We(e,t){return e?null:Ze()(t)?"the expression returns no value":Ne()(t)?"the expression returned NaN":ze()(t)?t.message:null}function je(e,t){return t?e?"success":"error":null}function Ge(e){let{onChange:t,value:a,...r}=e;const[l,s]=Be(a),[i,c]=(0,n.useState)(l),[d,p]=(0,n.useState)(s),[m,g]=(0,n.useState)(a);return o().createElement(te.FormGroup,{validationState:je(i,m)},o().createElement(te.Col,{xs:12},o().createElement(te.ControlLabel,null,o().createElement(q.Z,{msgId:"widgets.advanced.formula"})),o().createElement(Oe,{placement:"top",title:o().createElement(q.Z,{msgId:"widgets.advanced.formula"}),text:o().createElement(Te.Z,{msgId:"widgets.advanced.formulaExamples"})}),o().createElement(te.FormControl,De({placeholder:"e.g. value / 100",feedback:We(i,d)},r,{type:"text",value:m,onChange:e=>{const[a,n]=Be(e.target.value);a?(c(!0),p(void 0),t(e)):(c(!1),p(n)),g(e.target.value)}}))))}var Ue=a(569291);const Ve=(0,ce.Z)("options")(ie.ZP),qe=[{value:"-",label:"widgets.advanced.axisTypes.auto"},{value:"linear",label:"widgets.advanced.axisTypes.linear"},{value:"category",label:"widgets.advanced.axisTypes.category"},{value:"log",label:"widgets.advanced.axisTypes.log"},{value:"date",label:"widgets.advanced.axisTypes.date"}],Ye=[{id:"stacked",value:"stack",label:"widgets.advanced.stackedBarChart"},{id:"grouped",value:"group",label:"widgets.advanced.groupedBarChart"}];function $e(e){let{}=e;return o().createElement("span",null,o().createElement("span",{style:{cursor:"pointer"}},o().createElement(q.Z,{msgId:"widgets.advanced.title"})))}function He(e){let{classificationAttribute:t,data:a,onChange:r=(()=>{})}=e;const[l,s]=(0,n.useState)(a.barChartType||"stack");return o().createElement(Ue.Z,{id:"displayCartesian",header:o().createElement($e,{data:a}),collapsible:!0,expanded:a.panel,onSwitch:e=>{r("panel",e)}},o().createElement(te.FormGroup,{controlId:"AdvancedOptions"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.displayCartesian"})),o().createElement(te.Col,{sm:6},o().createElement(xe.Z,{checked:!(!a.cartesian&&!1!==a.cartesian||a.cartesian),onChange:e=>{r("cartesian",!e)}})),"bar"===a.type&&t&&o().createElement("div",{className:"bar-chart-type"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.barChartType"})),Ye.map((e=>o().createElement(te.Col,{xs:3,className:"radio-btn",key:e.value},o().createElement("input",{type:"radio",id:e.id,value:e.value,name:"barChartType",checked:l===e.value,onChange:e=>{const{value:t}=e.target;s(t),r("barChartType",t)}}),o().createElement(q.Z,{msgId:e.label}))))),o().createElement(te.Col,{componentClass:"label",sm:12},o().createElement(q.Z,{msgId:"widgets.advanced.yAxis"})),o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.xAxisType"})),o().createElement(te.Col,{sm:6},o().createElement(Ve,{value:a.yAxisOpts&&a.yAxisOpts.type||"-",options:qe,onChange:e=>{r("yAxisOpts.type",e&&e.value)}})),o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.hideLabels"})),o().createElement(te.Col,{sm:6},o().createElement(xe.Z,{checked:!a.yAxis&&!1!==a.yAxis||!a.yAxis,onChange:e=>{r("yAxis",!e)}})),o().createElement(te.Col,{componentClass:te.ControlLabel,sm:12},o().createElement(q.Z,{msgId:"widgets.advanced.format"})),o().createElement(te.Col,{sm:4},o().createElement(te.ControlLabel,null,o().createElement(q.Z,{msgId:"widgets.advanced.prefix"}),o().createElement(te.FormControl,{placeholder:"e.g.: ~",disabled:!1===a.yAxis,value:a?.yAxisOpts?.tickPrefix,type:"text",onChange:e=>r("yAxisOpts.tickPrefix",e.target.value)}))),o().createElement(te.Col,{sm:4},o().createElement(te.ControlLabel,null,o().createElement(q.Z,{msgId:"widgets.advanced.format"})),o().createElement(Oe,{placement:"top",title:o().createElement(q.Z,{msgId:"widgets.advanced.examples"}),text:o().createElement(Te.Z,{msgId:"widgets.advanced.formatExamples"})}),o().createElement(te.FormControl,{placeholder:"e.g.: .2s",disabled:!1===a.yAxis,value:a?.yAxisOpts?.format,type:"text",onChange:e=>r("yAxisOpts.format",e.target.value)})),o().createElement(te.Col,{sm:4},o().createElement(te.ControlLabel,null,o().createElement(q.Z,{msgId:"widgets.advanced.suffix"})),o().createElement(te.FormControl,{placeholder:"e.g.: W",disabled:!1===a.yAxis,value:a?.yAxisOpts?.tickSuffix,type:"text",onChange:e=>r("yAxisOpts.tickSuffix",e.target.value)})),o().createElement(te.Col,{sm:12},o().createElement(Ge,{disabled:!1===a.yAxis,value:a.formula,type:"text",onChange:e=>r("formula",e.target.value)})),o().createElement(te.Col,{componentClass:"label",sm:12},o().createElement(q.Z,{msgId:"widgets.advanced.xAxis"})),o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.xAxisType"})),o().createElement(te.Col,{sm:6},o().createElement(Ve,{value:a?.xAxisOpts?.type??"-",options:qe,onChange:e=>{r("xAxisOpts.type",e&&e.value)}})),o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.hideLabels"})),o().createElement(te.Col,{sm:6},o().createElement(xe.Z,{checked:a?.xAxisOpts?.hide??!1,onChange:e=>{r("xAxisOpts.hide",e)}})),o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.forceTicks"})),o().createElement(te.Col,{sm:6},o().createElement(xe.Z,{disabled:a?.xAxisOpts?.hide??!1,checked:!!a?.xAxisOpts?.nTicks,onChange:e=>{r("xAxisOpts.nTicks",e?200:void 0)}}),o().createElement("span",{style:{position:"relative",top:-5,margin:10}},o().createElement(Ie.Z,{bsStyle:"info",text:o().createElement(q.Z,{msgId:"widgets.advanced.maxXAxisLabels",msgParams:{max:200}})}))),o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.xAxisAngle"})),o().createElement(te.Col,{sm:6,style:{display:"flex"}},o().createElement(xe.Z,{disabled:a?.xAxisOpts?.hide??!1,checked:void 0!==a.xAxisAngle,onChange:e=>{r("xAxisAngle",e?0:void 0)}}),o().createElement("div",{style:{flexGrow:1,padding:5}},void 0!==a.xAxisAngle?o().createElement("div",{className:"mapstore-slider with-tooltip",onClick:e=>{e.stopPropagation()}},o().createElement(Ae.Z,{disabled:!!a?.xAxisOpts?.hide,key:"priority",format:{to:e=>`${parseInt(e,10)}°`,from:e=>Number(e)},onSlide:e=>{r("xAxisAngle",parseInt(e[0],10))},range:{min:-90,max:90},start:[Ze()(a.xAxisAngle)?0:a.xAxisAngle],step:15,tooltips:[!0]})):o().createElement("div",{style:{textAlign:"center"}},"Auto")))),o().createElement(te.FormGroup,{controlId:"yAxisLabel"},o().createElement(te.Col,{componentClass:"label",sm:12},o().createElement(q.Z,{msgId:"widgets.advanced.legend"})),o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.advanced.yAxisLabel"})),o().createElement(te.Col,{sm:6},o().createElement(te.FormControl,{value:a.yAxisLabel,type:"text",onChange:e=>r("yAxisLabel",e.target.value)}))))}var Ke=a(294184),Qe=a.n(Ke),_e=a(147814),Je=a(466737),Xe=a(283604),et=a(317723);const tt=(e,t)=>o().createElement(Oe,{popoverClassName:"chart-color-class-popover",placement:e,title:o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.customLabels"}),text:o().createElement(Te.Z,{msgId:`widgets.builder.wizard.classAttributes.${t}ChartCustomLabelsExample`})}),at=e=>{let{onUpdateClasses:t,classification:a,defaultClassLabel:n,onChangeDefaultClassLabel:r,layer:l,chartType:s,classificationAttribute:i,classificationAttributeType:c}=e;return o().createElement(o().Fragment,null,o().createElement(te.Row,{xs:12},o().createElement(te.Col,{componentClass:te.ControlLabel,xs:6},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.defaultClassLabel"}),tt("top",s)),o().createElement(te.Col,{xs:6},o().createElement(te.FormControl,{value:n,type:"text",onChange:e=>r(e.target.value)}))),o().createElement(te.Row,{xs:12},o().createElement(te.Col,{xs:12},o().createElement(o().Fragment,null,o().createElement(te.Row,{xs:12},o().createElement(te.Col,{xs:4},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.classColor"})),o().createElement(te.Col,{xs:4},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.classValue"})),o().createElement(te.Col,{xs:4},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.classLabel"}),tt("right",s))),o().createElement(et.Z,{noEmptyIndex:!0,classification:a,onUpdateClasses:e=>t(e,c),allowEmpty:!1,customLabels:!0,uniqueValuesClasses:!0,autoCompleteOptions:{classificationAttribute:i,dropUpAutoComplete:!0,layer:l},dropUpMenu:!0,usePresetColors:!0})))))};at.PropTypes={onUpdateClasses:ee().func,classification:ee().array,defaultClassLabel:ee().string,onChangeDefaultClassLabel:ee().func,layer:ee().object,chartType:ee().string,classificationAttribute:ee().string,classificationAttributeType:ee().string};const nt=at,ot=(e,t,a,n)=>o().createElement(Oe,{popoverClassName:"chart-color-class-popover",placement:e,title:o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.customLabels"}),text:o().createElement(Te.Z,{msgId:`widgets.builder.wizard.classAttributes.${t}${a}${n}ChartCustomLabelsExample`})}),rt=e=>{let{onUpdateClasses:t,rangeClassification:a,defaultClassLabel:n,onChangeDefaultClassLabel:r,chartType:l,classificationAttributeType:s}=e;return o().createElement(o().Fragment,null,o().createElement(te.Row,{xs:12},o().createElement(te.Col,{componentClass:te.ControlLabel,xs:6},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.defaultClassLabel"}),ot("top",l,"Range","Default")),o().createElement(te.Col,{xs:6},o().createElement(te.FormControl,{value:n,type:"text",onChange:e=>r(e.target.value)}))),o().createElement(te.Row,null,o().createElement(te.Col,{xs:12},o().createElement(te.Col,{xs:3},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.classColor"})),o().createElement(te.Col,{xs:3},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.minValue"})),o().createElement(te.Col,{xs:3},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.maxValue"})),o().createElement(te.Col,{xs:3},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.classLabel"}),ot("right",l,"Range","Class")))),o().createElement(et.Z,{noEmptyIndex:!0,classification:a,onUpdateClasses:e=>t(e,s),allowEmpty:!1,customLabels:!0,usePresetColors:!0,dropUpMenu:!0}))};rt.PropTypes={onUpdateClasses:ee().func,rangeClassification:ee().array,defaultClassLabel:ee().string,onChangeDefaultClassLabel:ee().function,chartType:ee().string,classificationAttributeType:ee().string};const lt=rt;var st=a(455877),it=a.n(st);const ct=e=>{let{modalClassName:t,show:a,onClose:r,onSaveClassification:l,onChangeClassAttribute:s,classificationAttribute:i,classificationAttributeType:c,onUpdateClasses:d,options:p,placeHolder:m,classification:g,rangeClassification:u,defaultCustomColor:h,defaultClassLabel:y,onChangeColor:b,onChangeDefaultClassLabel:v,layer:C,chartType:f}=e;const[E,w]=(0,n.useState)(!1);return o().createElement(Je.Z,null,o().createElement(Xe.Z,{modalClassName:Qe()(t,{"menu-open":E||i},{"text-class":"string"===c},{"range-class":"number"===c}),title:o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.title"}),show:a,clickOutEnabled:!1,showClose:!1,onClose:()=>r(),buttons:[{className:"btn-cancel",text:o().createElement(q.Z,{msgId:"close"}),bsSize:"sm",onClick:()=>r()},{className:"btn-save",text:o().createElement(q.Z,{msgId:"save"}),bsSize:"sm",onClick:()=>l()}]},o().createElement(te.Row,{xs:12},o().createElement(te.Col,{componentClass:te.ControlLabel,xs:6},o().createElement(q.Z,{msgId:i?"widgets.builder.wizard.classAttributes.defaultColor":"widgets.builder.wizard.classAttributes.color"})),o().createElement(te.Col,{xs:6},o().createElement(_e.Z,{key:0,color:h,disableAlpha:!0,format:"hex",onChangeColor:e=>b(e)}))),o().createElement(te.Row,{xs:12},o().createElement(te.Form,{id:"chart-color-class-form",horizontal:!0},o().createElement(te.FormGroup,{controlId:"classificationAttribute",className:"chart-color-class-form-group"},o().createElement(te.Col,{componentClass:te.ControlLabel,xs:6},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.classificationAttribute"})),o().createElement(te.Col,{xs:6},o().createElement(ie.ZP,{value:i,options:p,placeholder:m,onChange:e=>{const t=e&&e.value||void 0,a=e&&e.type||void 0;s(t,a)},onOpen:()=>w(!E),onClose:()=>w(!E)}))))),i&&"string"===c?o().createElement(nt,{onUpdateClasses:d,classification:g,defaultClassLabel:y,onChangeDefaultClassLabel:v,layer:C,chartType:f,classificationAttribute:i,classificationAttributeType:c}):i&&"number"===c?o().createElement(lt,{onUpdateClasses:d,chartType:f,onChangeDefaultClassLabel:v,defaultClassLabel:y,rangeClassification:u,classificationAttributeType:c}):null))};ct.propTypes={modalClassName:ee().string,show:ee().boolean,onClose:ee().func,onSaveClassification:ee().func,onChangeClassAttribute:ee().func,classificationAttribute:ee().string,onUpdateClasses:ee().func,options:ee().array,placeHolder:ee().string,classification:ee().array,rangeClassification:ee().array,defaultCustomColor:ee().string,defaultClassLabel:ee().string,onChangeColor:ee().func,onChangeDefaultClassLabel:ee().func},ct.defaultProps={modalClassName:"chart-color-class-modal",onClose:()=>{},onSaveClassification:()=>{},onChangeClassAttribute:()=>{},classificationAttribute:"",onUpdateClasses:()=>{},options:[],classification:[{uuid:it().v1(),title:"",color:(0,Ee.TM)(),type:"Polygon",unique:""}],rangeClassification:[{uuid:it().v1(),title:"",color:(0,Ee.TM)(),type:"Polygon",min:0,max:0}],defaultCustomColor:"#0888A1",defaultClassLabel:"",onChangeColor:()=>{},onChangeDefaultClassLabel:()=>{}};const dt=ct;var pt=a(116988);const mt={base:190,range:0,s:.95,v:.63},gt=[{showWhen:e=>"pie"===e,name:"global.colors.random",schema:"qualitative",options:{base:190,range:360,options:{}}},{name:"global.colors.blue",schema:"sequencial",options:{base:190,range:20}},{name:"global.colors.red",schema:"sequencial",options:{base:10,range:4}},{name:"global.colors.green",schema:"sequencial",options:{base:120,range:4}},{name:"global.colors.brown",schema:"sequencial",options:{base:30,range:4}},{name:"global.colors.purple",schema:"sequencial",options:{base:300,range:4}},{showWhen:e=>"bar"===e||"pie"===e,name:"global.colors.custom",schema:"sequencial",options:mt,ramp:"#fff",custom:!0}],ut=[{id:it().v1(),title:"",color:(0,Ee.TM)(),type:"Polygon",unique:""}],ht=[{id:it().v1(),title:"",color:(0,Ee.TM)(),type:"Polygon",min:0,max:0}],yt=(e,t,a,n)=>(gt.filter((e=>e.custom))[0].ramp=a?[...t.map((e=>e.color)),n]:n,gt.filter((t=>t.showWhen?t.showWhen(e):t))),bt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`widgets.${e}.${t.type||t.widgetType||"default"}`},vt=o().createElement(q.Z,{msgId:bt("placeHolder")}),Ct=(e,t)=>e.map((e=>({id:e.id||it().v1(),title:e.title??e.unique,color:e.color,..."string"===t&&{value:e.unique,unique:e.unique},..."number"===t&&{max:e.max??0,min:e.min??0}}))),ft=e=>{let{hasAggregateProcess:t,data:a={options:{},autoColorOptions:{}},onChange:r=(()=>{}),options:l=[],typedOptions:s=[],showTitle:i=!0,formOptions:c={showGroupBy:!0,showUom:!1,showColorRampSelector:!0,showLegend:!0,advancedOptions:!0},aggregationOptions:d=[],sampleChart:p,layer:m}=e;const[g,u]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),v="global.colors.custom"===a.autoColorOptions?.name,{classificationAttribute:C}=a?.options||{},{classificationAttributeType:f}=a?.options||{},{classification:E=ut}=a?.autoColorOptions||{},{rangeClassification:w=ht}=a?.autoColorOptions||{},S="number"===f?w:E,{defaultClassLabel:x=""}=a?.autoColorOptions||{},P=a?.autoColorOptions?.defaultCustomColor||(0,pt.HC)(1,mt)[0]||"#0888A1",Z=(e,t,a,n,o)=>{const l="number"===n?"autoColorOptions.rangeClassification":"autoColorOptions.classification",s="number"===n?ht:ut;e.length===a.length?(r(l,s),o===n&&(r("options.classificationAttribute",void 0),r("options.classificationAttributeType",void 0))):r(l,t||[])};return(0,n.useEffect)((()=>{"line"!==a.type||a?.autoColorOptions?.name&&!v||r("autoColorOptions",{name:"global.colors.blue",base:190,range:20})}),[a.type]),o().createElement(te.Row,null,i&&o().createElement(Se.Z,{title:o().createElement(q.Z,{msgId:"widgets.chartOptionsTitle"})}),o().createElement(te.Col,{xs:12,style:{position:"sticky",top:0,zIndex:1}},o().createElement("div",{style:{marginBottom:"30px"}},p)),o().createElement(te.Col,{xs:12},o().createElement(te.Form,{className:"chart-options-form",horizontal:!0},c.showGroupBy?o().createElement(te.FormGroup,{controlId:"groupByAttributes",className:"mapstore-block-width"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:bt("groupByAttributes",a)})),o().createElement(te.Col,{sm:6},o().createElement(ie.ZP,{value:a.options&&a.options.groupByAttributes,options:l,placeholder:vt,onChange:e=>{r("options.groupByAttributes",e&&e.value)}}))):null,o().createElement(te.FormGroup,{controlId:"aggregationAttribute",className:"mapstore-block-width"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:bt("aggregationAttribute",a)})),o().createElement(te.Col,{sm:6},o().createElement(ie.ZP,{value:a.options&&a.options.aggregationAttribute,options:l,placeholder:vt,onChange:e=>{r("options.aggregationAttribute",e&&e.value)}}))),t?o().createElement(te.FormGroup,{controlId:"aggregateFunction",className:"mapstore-block-width"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:bt("aggregateFunction",a)})),o().createElement(te.Col,{sm:6},o().createElement(ie.ZP,{value:a.options&&a.options.aggregateFunction,options:d,placeholder:vt,onChange:e=>{r("options.aggregateFunction",e&&e.value)}}))):null,c.showUom?o().createElement(te.FormGroup,{controlId:"uom"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:bt("uom",a)})),o().createElement(te.Col,{sm:6},o().createElement(te.FormControl,{value:h()(a,"options.seriesOptions[0].uom"),type:"text",onChange:e=>r("options.seriesOptions.[0].uom",e.target.value)}))):null,c.showColorRampSelector?o().createElement(te.FormGroup,{controlId:"colorRamp",className:"mapstore-block-width"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:v?5:6},o().createElement(q.Z,{msgId:bt("colorRamp",a)})),o().createElement(te.Col,{sm:v?7:6},o().createElement(te.FormGroup,null,v&&o().createElement(te.Col,{xs:2},o().createElement(te.OverlayTrigger,{key:"customColors",placement:"top",overlay:o().createElement(te.Tooltip,{id:"wizard-tooltip-customColors"},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.editCustomColors"}))},o().createElement(ae.Z,{bsSize:"sm",className:`custom-color-btn btn btn-default ${a.type}`,onClick:()=>u(!0)},o().createElement(te.Glyphicon,{glyph:"pencil"})))),o().createElement(te.Col,{xs:v?10:12,className:Qe()({"custom-color":v})},o().createElement(fe.Z,{items:yt(a.type,S,C,P),value:Ce()(yt(a.type,S,C,P).filter((e=>a.autoColorOptions&&e.name===a.autoColorOptions.name))),samples:"pie"===a.type?5:1,onChange:e=>{r("autoColorOptions",{...e.options,name:e.name,...E?{classification:Ct(E,"string")}:{},...w?{rangeClassification:Ct(w,"number")}:{},defaultCustomColor:P??"#0888A1"}),e.custom||(r("options.classificationAttribute",void 0),r("options.classificationAttributeType",void 0))}}))))):null,o().createElement(dt,{modalClassName:"chart-color-class-modal",show:g,onClose:()=>{const e=E.filter((e=>!e.unique||!e.value)),t=w.filter((e=>!e.title));(e.length>0&&"string"===f||t.length>0&&"number"===f)&&C?b(!0):u(!1)},onSaveClassification:()=>{u(!1),r("autoColorOptions.defaultCustomColor",P),r("options.classificationAttribute",C),r("options.classificationAttributeType",f),C&&r("autoColorOptions",{...a.autoColorOptions,defaultClassLabel:x||"",classification:E?Ct(E,"string"):[],rangeClassification:w?Ct(w,"number"):[]})},onChangeClassAttribute:(e,t)=>{r("options.classificationAttribute",e),r("options.classificationAttributeType",t)},classificationAttribute:C,classificationAttributeType:f,onUpdateClasses:(e,t)=>{r("number"===t?"autoColorOptions.rangeClassification":"autoColorOptions.classification",Ct(e,t)||[])},options:s,placeHolder:vt,classification:E,rangeClassification:w,defaultCustomColor:P,onChangeColor:e=>r("autoColorOptions.defaultCustomColor",e),defaultClassLabel:x,onChangeDefaultClassLabel:e=>r("autoColorOptions.defaultClassLabel",e),layer:m,chartType:a.type}),(T=y,A=()=>{b(!1)},I=()=>{const[e,t]=[(a=E).filter((e=>!e.unique&&!e.value)),a.filter((e=>e.unique&&e.value))];var a;const[n,o]=(e=>[e.filter((e=>!e.title.trim())),e.filter((e=>e.title))])(w);Z(e,t,E,"string",f),Z(n,o,w,"number",f),b(!1),u(!1)},o().createElement(we.Z,{show:T,onClose:A,onConfirm:I},o().createElement(q.Z,{msgId:"widgets.builder.wizard.classAttributes.confirmModalMessage"}))),c.showLegend?o().createElement(te.FormGroup,{controlId:"displayLegend"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:bt("displayLegend",a)})),o().createElement(te.Col,{sm:6},o().createElement(xe.Z,{checked:a.legend,onChange:e=>{r("legend",e)}}))):null,!c.advancedOptions||"chart"!==a.widgetType||"bar"!==a.type&&"line"!==a.type?null:o().createElement(He,{data:a,classificationAttribute:C,onChange:r}))));var T,A,I},Et=e=>{let{data:t={},onChange:a=(()=>{}),sampleChart:n,showTitle:r=!0}=e;return o().createElement(te.Row,null,r&&o().createElement(Se.Z,{title:o().createElement(q.Z,{msgId:"widgets.widgetOptionsTitle"})}),o().createElement(te.Col,{key:"sample",xs:12},o().createElement("div",{style:{marginBottom:"30px"}},n)),o().createElement(te.Col,{key:"form",xs:12},o().createElement(te.Form,{className:"widget-options-form",horizontal:!0},o().createElement(te.FormGroup,{controlId:"groupByAttributes"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.title"})),o().createElement(te.Col,{sm:6},o().createElement(te.FormControl,{value:t.title,type:"text",onChange:e=>a("title",e.target.value)}))),o().createElement(te.FormGroup,{controlId:"aggregationAttribute"},o().createElement(te.Col,{componentClass:te.ControlLabel,sm:6},o().createElement(q.Z,{msgId:"widgets.description"})),o().createElement(te.Col,{sm:6},o().createElement(te.FormControl,{value:t.description,type:"text",onChange:e=>a("description",e.target.value)}))))))};var wt=a(353710),St=a(30333);const xt=(0,s.defaultProps)({data:[{name:"A",variable:2,pv:2,amt:2},{name:"B",variable:.5,pv:.5,amt:.5},{name:"C",variable:3,pv:3,amt:3},{name:"D",variable:1,pv:1,amt:2}],series:[{dataKey:"variable",color:"#078aa3"}],xAxis:{dataKey:"name",show:!1}});var Pt=a(107319),Zt=a(281673),Tt=a(719573),At=a(179635),It=a(92723),kt=a(706020);function Ot(){return Ot=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Ot.apply(this,arguments)}const Lt=(0,p.Z)((e=>{let{loading:t,data:a}=e;return t||!a}),{width:500,height:200}),Nt=e=>{let{featureTypeProperties:t=[]}=e;return 0===t.filter((function(){let{type:e=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0!==e.indexOf("gml:")})).length},Mt=(0,se.Z)(Nt)((function(){let{onSelect:e=(()=>{}),types:t=pe,type:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement("div",{className:"chart-type"},o().createElement("strong",null,o().createElement(q.Z,{msgId:"widgets.selectChartType.title"})),o().createElement("div",{style:{marginTop:4}},o().createElement(de,{noResultsText:"widgets.selectChartType.noResults",optionRenderer:me,valueRenderer:me,options:t.map((e=>{let{type:t,glyph:a}=e;return{value:t,label:t,glyph:a}})),onChange:t=>t.value&&e(t.value),value:a,clearable:!1})))})),zt=be(ft),Ft=(0,s.compose)(Zt.Z,Tt.Z,At.Z,Pt.Z,Lt,kt.Z,It.Z)(wt.Z),Dt=xt(wt.Z),Rt={width:430,height:200},Bt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{hasAggregateProcess:t}=arguments.length>1?arguments[1]:void 0;return e.aggregationAttribute&&e.groupByAttributes&&(!t||t&&e.aggregateFunction)||e.classificationAttribute},Wt=le(re),jt=(0,s.compose)((0,s.withState)("selectedChart","setSelectedChart",{}),(0,s.lifecycle)({componentDidMount(){const e=this.props?.data||{},t={...e,...e?.charts?.find((t=>t.chartId===e?.selectedChartId))};this.props?.setSelectedChart({...t})},UNSAFE_componentWillReceiveProps(){let{data:e={},valid:t,setValid:a=(()=>{}),hasAggregateProcess:n,selectedChart:o,setSelectedChart:r,setErrors:l=(()=>{}),errors:s,featureTypeProperties:i,setNoAttributes:c=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const d={...e,...e?.charts?.find((t=>t.chartId===e?.selectedChartId))};if(t&&e?.charts?.some((e=>!Bt(e.options,{hasAggregateProcess:n})))&&a(!1),F()(o)&&!F()(d)||!Q()(o,d)){const e=d?.charts?.map((function(){let{layer:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?.name}));l(F()(e)?{}:J()(s,[...e])),r({...d})}const p=Nt({featureTypeProperties:i});Q()(i,this.props.featureTypeProperties)||c(p)}}),(0,s.setDisplayName)("ChartWizard")),Gt=function(){let{step:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement("div",{className:"chart-option-title"},o().createElement(q.Z,{msgId:"widgets."+(0===e?"chartOptionsTitle":"widgetOptionsTitle")}))},Ut=jt((e=>{let{onChange:t=(()=>{}),onFinish:a=(()=>{}),setPage:n=(()=>{}),setValid:r=(()=>{}),data:l={},setErrors:s=(()=>{}),errors:i,selectedChart:c={},setSelectedChart:d=(()=>{}),layer:p={},step:m=0,types:g,featureTypeProperties:u,dependencies:h,hasAggregateProcess:y,noAttributes:b=!1,withContainer:v=!0,widgets:C=[]}=e;const f=(e=>{let{data:t={},layer:a,dependencies:n={},setValid:r=(()=>{}),hasAggregateProcess:l,setErrors:s=(()=>{}),errors:i,widgets:c=[]}=e;return Bt(t.options,{hasAggregateProcess:l})?o().createElement(Ft,Ot({},Rt,{key:"preview-chart",onLoad:()=>{r(!0),s({...i,[a.name]:!1})},onLoadError:()=>{r(!1),s({...i,[a.name]:!0})},isAnimationActive:!1,dependencies:n,dependenciesMap:t.dependenciesMap,type:t.type,xAxisOpts:t.xAxisOpts,yAxisOpts:t.yAxisOpts,barChartType:t.barChartType,formula:t.formula,legend:t.legend,cartesian:t.cartesian,layer:t.layer||a,charts:t.charts||[],selectedChartId:t.selectedChartId,filter:t.filter||{},geomProp:t.geomProp,mapSync:t.mapSync,autoColorOptions:t.autoColorOptions,options:t.options||[],yAxis:t.yAxis,xAxisAngle:t.xAxisAngle,yAxisLabel:t.yAxisLabel,widgets:c})):o().createElement(Dt,Ot({hasAggregateProcess:l,key:"sample-chart",isAnimationActive:!1},Rt,{type:t.type,autoColorOptions:t.autoColorOptions,legend:t.legend,cartesian:t.cartesian,layer:t.layer||a,yAxis:t.yAxis}))})({hasAggregateProcess:y,data:c,layer:c?.layer||p,dependencies:h,setErrors:s,errors:i,setValid:r,widgets:C}),E=o().createElement(o().Fragment,null,o().createElement(Mt,{key:"type",featureTypeProperties:u,type:c?.type,onSelect:e=>t(`charts[${c?.chartId}].type`,e)}),!b&&o().createElement(zt,{hasAggregateProcess:y,dependencies:h,key:"chart-options",featureTypeProperties:u,types:g,data:c,onChange:(e,a)=>t(`charts[${c?.chartId}].${e}`,a),layer:c?.layer||p,sampleChart:f,showTitle:!1})),w=b?null:o().createElement(Et,{key:"widget-options",data:l,onChange:t,layer:c?.layer||p,sampleChart:f,showTitle:!1});return o().createElement(Wt,{step:m,setPage:n,onFinish:a,isStepValid:e=>0===e?l.chartType:1!==e||Bt(l.options,{hasAggregateProcess:y}),hideButtons:!0,className:"chart-options"},[E,w].map((e=>o().createElement(o().Fragment,null,o().createElement(Gt,{step:m}),o().createElement(St.Z,{key:"chart-switcher",editorData:l,onChange:t,value:l?.selectedChartId,setSelectedChart:d,selectedChart:c,featureTypeProperties:u,withContainer:v},e)))))}));var Vt=a(8204);const qt=function(){let{canProceed:e,selected:t,stepButtons:a=[],onProceed:n=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(Vt.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary",bsSize:"sm"},buttons:[...a,{onClick:n,disabled:!e,tooltipId:"widgets.builder.wizard.useTheSelectedLayer",visible:t,glyph:"arrow-right"}]})};var Yt=a(36549),$t=a(134479);const Ht=function(){let{onClose:e=(()=>{}),children:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement("div",{className:"mapstore-flex-container"},o().createElement("div",{className:"m-header bg-body widgets-builder-header"},o().createElement(te.Row,null,o().createElement(te.Col,{md:12,className:"text-center",style:{overflow:"hidden",lineHeight:"52px"}},o().createElement(ae.Z,{onClick:()=>e(),className:"pull-left on-close-btn square-button no-border "},o().createElement(te.Glyphicon,{glyph:"1-close"})),o().createElement("span",{style:{padding:"50px 0 0 0",fontSize:16}},o().createElement(q.Z,{msgId:"widgets.builder.header.title"})),o().createElement("div",{style:{display:"flex"},className:"square-button pull-right no-border"},o().createElement(te.Glyphicon,{glyph:"stats",className:"text-primary"})))),o().createElement(te.Row,{className:"text-center"},o().createElement("div",{className:"m-padding-md"},t))))},Kt=Ht;var Qt=a(513218),_t=a.n(Qt),Jt=a(768977),Xt=a(185936),ea=a(274869),ta=a(281563),aa=a(52713);const na=(0,ce.Z)(["placeholder","clearValueText","noResultsText"])(a(743129).ZP),oa=e=>{let{services:t,selectedService:a,onChangeSelectedService:n=(()=>{}),onChangeCatalogMode:r=(()=>{}),isValidServiceSelected:l}=e;return o().createElement(te.InputGroup,null,o().createElement(na,{clearValueText:"catalog.clearValueText",noResultsText:"catalog.noResultsText",clearable:!0,options:t,value:a,onChange:e=>n(e&&e.value?e.value:""),placeholder:"catalog.servicePlaceholder"}),l?o().createElement(te.InputGroup.Addon,{className:"btn",onClick:()=>r("edit",!1)},o().createElement(te.Glyphicon,{glyph:"pencil"})):null,o().createElement(te.InputGroup.Addon,{className:"btn",onClick:()=>r("edit",!0)},o().createElement(te.Glyphicon,{glyph:"plus"})))},ra=(0,ce.Z)("placeholder")(te.FormControl),la=e=>{let{onSearchTextChange:t=(()=>{}),onChangeSelectedService:a=(()=>{}),searchText:n,title:r=o().createElement(q.Z,{msgId:"catalog.title"}),services:l,showCatalogSelector:s,selectedService:i,onChangeCatalogMode:c}=e;return o().createElement(te.Grid,{className:"catalog-form",fluid:!0},o().createElement(te.Row,null,o().createElement(te.Col,{xs:12},o().createElement("h4",{className:"text-center"},r),s?o().createElement(te.FormGroup,null,o().createElement(oa,{onChangeCatalogMode:c,services:l,onChangeSelectedService:a,selectedService:{label:i?.title??"",value:i??{}},isValidServiceSelected:i})):null,o().createElement(te.FormGroup,{controlId:"catalog-form"},o().createElement(ra,{type:"text",placeholder:"catalog.textSearchPlaceholder",value:n,onChange:e=>t(e.currentTarget.value)})))))},sa=o().createElement(ta.Z,{glyph:"geoserver",padding:20}),ia=(0,s.compose)((0,p.Z)((e=>{let{loading:t,items:a=[]}=e;return 0===a.length&&t})),(0,m.Z)((e=>{let{loading:t,error:a}=e;return!t&&a}),{title:o().createElement(q.Z,{msgId:"catalog.error"}),style:{transform:"translateY(50%)"}}),(0,m.Z)((e=>{let{loading:t,items:a=[]}=e;return 0===a.length&&!t}),{title:o().createElement(q.Z,{msgId:"catalog.noRecordsMatched"}),style:{transform:"translateY(50%)"}}))(Jt.Z),ca=e=>e.identifier?e.identifier:e.provider?e.provider+(e.variant??""):e.tileMapUrl||e.url+it()(),da=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((t=>t===e||e&&t&&t.record&&e.identifier===t.record?.identifier?{...t,selected:!0}:t))},pa=(0,s.compose)((0,ea.Z)("searchText","setSearchText",""),(0,Xt.Z)({loadPage:function(e){let{text:t,catalog:a={}}=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=a.type,l={options:{service:a}};let s={};return"csw"===r?s={...l,filter:a.filter}:"tms"===r&&(s=l),b().Observable.fromPromise(A.Z[r].textSearch(a.url,10*n+("csw"===r?1:0),10,t,s)).map((e=>({result:e,records:A.Z[r].getCatalogRecords(e||[],{url:a&&a.url,service:a})}))).map((e=>{let{records:t,result:n}=e;return(e=>{let{records:t,result:a={},catalog:n={}}=e;return{items:(t||[]).map((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{title:e.title&&_t()(e.title)&&e.title.default||e.title,caption:ca(e),description:e.description,preview:n.hideThumbnail?null:e.thumbnail?o().createElement("img",{src:e.thumbnail}):sa,record:{...e,identifier:ca(e)}}})),total:a&&a.numberOfRecordsMatched}})({records:t,result:n,catalog:a})}))},scrollSpyOptions:{querySelector:".ms2-border-layout-body .ms2-border-layout-content",pageSize:10}}),(0,s.mapPropsStream)((e=>e.merge(e.take(1).switchMap((t=>{let{loadFirst:a=(()=>{}),services:n}=t;return e.debounceTime(500).startWith({searchText:""}).distinctUntilKeyChanged("searchText").do((function(){let{searchText:e,selectedService:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!F()(n[t])&&a({text:e,catalog:n[t]})})).ignoreElements()}))))),(0,s.withPropsOnChange)(["selectedService"],(e=>{const t=e.services?.[e.selectedService];F()(t)||e.loadFirst({text:e.searchText||"",catalog:t})})))((e=>{let{setSearchText:t=(()=>{}),selected:a,onRecordSelected:n,loading:r,searchText:l,items:s=[],total:i,catalog:d,services:p={},title:m,showCatalogSelector:g=!0,error:u,onChangeSelectedService:h=(()=>{}),selectedService:y,onChangeCatalogMode:b=(()=>{}),getItems:v=(e=>da(e,a)),onItemClick:C=function(){let{record:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(e,d)}}=e;return o().createElement(c.Z,{className:"compat-catalog",header:o().createElement(la,{onChangeCatalogMode:b,onChangeSelectedService:h,services:Object.keys(p).map((e=>({label:p[e]?.title,value:{...p[e],key:e}}))),selectedService:p[y],showCatalogSelector:g,title:m,searchText:l,onSearchTextChange:t}),footer:o().createElement("div",{className:"catalog-footer"},r?o().createElement(aa.Z,null):null,Ze()(i)?null:o().createElement("span",{className:"res-info"},o().createElement(q.Z,{msgId:"catalog.pageInfoInfinite",msgParams:{loaded:s.length,total:i}})))},o().createElement(ia,{items:v(s),loading:r,error:u,onItemClick:C}))})),ma=(0,s.defaultProps)({title:o().createElement(q.Z,{msgId:"widgets.builder.wizard.selectALayer"})})(pa),ga=(0,Yt.Z)(ae.Z),ua=(0,r.connect)((e=>({selectedCatalog:(0,$t.R7)(e)})))((e=>{let{onClose:t=(()=>{}),setSelected:a=(()=>{}),onLayerChoice:n=(()=>{}),stepButtons:r,selected:l,layerError:s,canProceed:i,layer:d,layers:p,catalog:m,defaultServices:g,onChangeSelectedService:u,defaultSelectedService:h,onChangeCatalogMode:y,dashboardServices:b,dashboardSelectedService:v,getItems:C,onItemClick:f,showLayers:w,toggleLayerSelector:S,selectedCatalog:x}=e;const P=w?i&&!F()(d):i&&l&&d&&M()(l).length===M()(d).length,Z=w?function(){let{toggleLayerSelector:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{glyph:"arrow-left",tooltipId:"widgets.builder.wizard.backToChartOptionConfiguration",onClick:()=>e(!1)}]}({toggleLayerSelector:S}):r;return o().createElement(c.Z,{className:"bg-body layer-selector",header:o().createElement(Kt,{onClose:t},o().createElement(qt,{stepButtons:Z,canProceed:P,onProceed:()=>{const e=w&&!F()(p);n(e?"chart-add":"chart-layers",d),S(!1)}}),l&&!i&&s?o().createElement(Ie.Z,{trigger:!1,glyph:"warning-sign",bsStyle:"warning",title:o().createElement(E.v0,{msgId:"widgets.builder.errors.noWidgetsAvailableTitle"}),text:o().createElement(E.k9,{msgId:s})}):null)},o().createElement(ma,{onChangeCatalogMode:y,selectedService:""===v?v:void 0===v?h:v,onChangeSelectedService:e=>u(e,b||g),services:b||g,selected:l,catalog:m||x,onRecordSelected:e=>a(e),getItems:C,onItemClick:f,title:o().createElement(o().Fragment,null,o().createElement(E.v0,{msgId:"widgets.builder.wizard.selectLayers"}),o().createElement(ga,{style:{marginLeft:4},tooltipPosition:"right",tooltip:o().createElement(E.k9,{msgId:"widgets.chartSwitcher.subTitle"}),className:"maps-subtitle square-button-md no-border",key:"info-sign"},o().createElement(te.Glyphicon,{glyph:"info-sign"})))}))})),ha=e=>1===e?"widgets.builder.wizard.backToChartOptions":"back",ya=(e,t)=>t?"widgets.builder.wizard.errorChart":0===e?"widgets.builder.wizard.configureWidgetOptions":"next",ba=function(e){let{id:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?"widgets.builder.wizard.updateWidget":"widgets.builder.wizard.addTheWidget"};var va=a(851719),Ca=a(641259),fa=a(504518),Ea=a(522296),wa=a(723027);function Sa(){return Sa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Sa.apply(this,arguments)}const xa={url:"",type:"wms",title:"",isNew:!0,showAdvancedSettings:!1,showTemplate:!1,hideThumbnail:!1,metadataTemplate:"<p>${description}</p>",excludeShowTemplate:!0},Pa=(0,s.compose)((0,s.defaultProps)({id:"dashboard-catalog-selector",buttonStyle:{marginBottom:"10px",marginRight:"5px"}}),(0,r.connect)((e=>({mode:(0,Ca.Yl)(e),dashboardServices:(0,Ca.CN)(e),dashboardSelectedService:(0,Ca.fd)(e),isNew:(0,Ca.Ip)(e)})),{onChangeSelectedService:va.tH,onChangeCatalogMode:va.ak,onDeleteService:va.qY,onAddService:va.kk,error:fa.vU}),(0,s.branch)((function(){let{mode:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"edit"===e}),(0,s.renderComponent)((e=>{let{service:t,catalogServices:a,error:r=(()=>{}),onAddService:l=(()=>{}),isNew:s,dashboardServices:i,defaultServices:c,defaultSelectedService:d,dashboardSelectedService:p,...m}=e;const[g,u]=(0,n.useState)(s?xa:F()(p)?{...c[d],old:c[d],key:d,excludeShowTemplate:!0}:{...i[p],old:i[p],key:p,excludeShowTemplate:!0}),h=F()(i)?c:i;return o().createElement("div",{style:{padding:"1rem",height:"100%"}},o().createElement(Ea.Z,Sa({onChangeUrl:e=>u({...g,url:e}),onChangeType:e=>u({...g,type:e}),onChangeTitle:e=>u({...g,title:e}),service:g,onChangeServiceFormat:e=>u({...g,format:e}),onToggleAdvancedSettings:()=>u({...g,showAdvancedSettings:!g.showAdvancedSettings}),onAddService:()=>{if(!("tms"===g.type||g.title&&g.url))return void r({title:"catalog.notification.errorTitle",message:"catalog.notification.warningAddCatalogService"});const e=s?g.title+it()():g.key,t={...g,key:e};l(t,h,s)},onChangeServiceProperty:(e,t)=>{u({...g,[e]:t})},onToggleTemplate:()=>u({...g,showTemplate:!g.showTemplate}),onToggleThumbnail:()=>u({...g,hideThumbnail:!g.hideThumbnail}),serviceTypes:[{name:"csw",label:"CSW"},{name:"wms",label:"WMS"},{name:"wmts",label:"WMTS"},{name:"tms",label:"TMS",allowedProviders:wa.DEFAULT_ALLOWED_PROVIDERS},{name:"wfs",label:"WFS"}],onChangeMetadataTemplate:e=>u({...g,metadataTemplate:e}),services:h},m)))}))));function Za(){return Za=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Za.apply(this,arguments)}const Ta=(0,r.connect)(H.e3,{setPage:d.YA,setValid:e=>(0,d.t4)("valid",e),onEditorChange:d.Rz,insertWidget:d.Qe},H.eF)((0,s.compose)(S({needWPS:!1}),(0,s.renameProps)({editorData:"data",onEditorChange:"onChange"}))(Ut)),Aa=(0,s.compose)((0,r.connect)(H.e3,{openFilterEditor:d.fy,setPage:d.YA,onChange:d.Rz,insertWidget:d.Qe},H.eF),U,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>{let{step:t}=e;return 0===t};return(0,s.withProps)((t=>{let{stepButtons:a=[],exitButton:n,onChange:o,editorData:r,dashBoardEditing:l,...s}=t;return{stepButtons:[{...n,visible:e({stepButtons:a,exitButton:n,...s}),...l&&{onClick:()=>o("chart-layers",void 0)}},...a]}}))}(),(0,s.withProps)((e=>function(){let{editorData:e={},disableMultiDependencySupport:t,widgets:a=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t||e?.charts?.some((e=>!e.geomProp));const o=(0,D.YE)({widgets:a,dependenciesMap:e?.dependenciesMap});return"table"===o?.widgetType&&(n=n||e?.charts?.some((e=>e.layer.name!==o?.layer?.name))),{disableMultiDependencySupport:n}}(e))),$((e=>{let{step:t}=e;return 0===t})))((function(){let{step:e=0,editorData:t={},valid:a,setPage:n=(()=>{}),onFinish:r=(()=>{}),onChange:l=(()=>{}),stepButtons:s=[],openFilterEditor:i=(()=>{}),toggleLayerSelector:c=(()=>{}),errors:d,noAttributes:p=!1,dashBoardEditing:m=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const g=!a||t?.mapSync&&Object.values(d).some((e=>e));return o().createElement(Vt.Z,{btnDefaultProps:{bsStyle:"primary",bsSize:"sm"},buttons:[{onClick:()=>n(Math.max(0,e-1)),visible:e>0,glyph:"arrow-left",tooltipId:ha(e)},...s,{onClick:i,disabled:p,glyph:"filter",tooltipId:"widgets.builder.setupFilter"},{onClick:()=>c(!0),visible:m&&0===e,glyph:"plus",tooltipId:"widgets.builder.addNewLayers"},{onClick:()=>((e,t)=>{const a=e?.charts?.filter((t=>t.chartId!==e?.selectedChartId));t("chart-delete",a.length?a:void 0)})(t,l),visible:m&&0===e,glyph:"trash",tooltipId:"widgets.builder.deleteChart"},{onClick:()=>n(Math.min(e+1,1)),visible:0===e,disabled:0===e&&g,glyph:"arrow-right",tooltipId:ya(e,g)},{onClick:()=>r(Math.min(e-1,1)),visible:1===e,glyph:"floppy-disk",tooltipId:ba(e,t)}]})})),Ia=(0,s.compose)((0,s.withState)("showLayers","toggleLayerSelector",!1),(0,s.withState)("errors","setErrors",{}),(0,s.withState)("noAttributes","setNoAttributes",!1),(0,r.connect)(H.e3,null,H.eF),Y,Pa,(0,s.branch)((function(){let{layer:e,showLayers:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e||t}),(0,s.renderComponent)(W(ua))))((function(){let{enabled:e,onClose:t=(()=>{}),exitButton:a,editorData:n,toggleConnection:r,availableDependencies:l=[],dependencies:s,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement("div",{className:"mapstore-chart-advance-options"},o().createElement(c.Z,{header:o().createElement(Kt,{onClose:t},o().createElement(Aa,{exitButton:a,editorData:n,toggleConnection:r,availableDependencies:l,onClose:t,toggleLayerSelector:i.toggleLayerSelector,errors:i.errors,noAttributes:i.noAttributes,dashboardEditing:i.dashboardEditing}))},e?o().createElement(Ta,Za({dependencies:s},i)):null))})),ka=function(e){let{id:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?"widgets.builder.wizard.updateWidget":"widgets.builder.wizard.addTheWidget"};var Oa=a(173581);const La=(0,ce.Z)("placeholder")(te.FormControl),Na=(0,ce.Z)("placeholder")(Oa.Z),Ma=e=>{let{data:t={},onChange:a=(()=>{})}=e;return o().createElement("div",null,o().createElement(te.Col,{key:"form",xs:12},o().createElement(te.Form,null,o().createElement(te.FormGroup,{controlId:"title"},o().createElement(te.Col,{sm:12},o().createElement(La,{style:{marginBottom:10},placeholder:"widgets.builder.wizard.titlePlaceholder",value:t.title,type:"text",onChange:e=>a("title",e.target.value)}))))),o().createElement(Na,{modules:{toolbar:[[{size:["small",!1,"large","huge"]},"bold","italic","underline","blockquote"],[{list:"bullet"},{align:[]}],[{color:[]},{background:[]},"clean"],["image","link"]]},placeholder:"widgets.builder.wizard.textPlaceholder",value:t&&t.text||"",onChange:e=>a("text",e)}))},za=le(re),Fa=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>{let{step:t}=e;return 0===t},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.withProps)((a=>{let{stepButtons:n=[],exitButton:o,...r}=a;return{stepButtons:[{...o,visible:e({stepButtons:n,exitButton:o,...r}),...t},...n]}}))},Da=(0,s.compose)((0,r.connect)(H.e3,{setPage:d.YA,insertWidget:d.Qe,onResetChange:d.Rz},H.eF),(0,s.withProps)((e=>{let{onResetChange:t=(()=>{})}=e;return{exitButton:{glyph:"arrow-left",tooltipId:"widgets.builder.wizard.backToWidgetTypeSelection",onClick:()=>t("widgetType",void 0)}}})),Fa())((function(){let{step:e=0,editorData:t={},stepButtons:a=[],onFinish:n=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(Vt.Z,{btnDefaultProps:{bsStyle:"primary",bsSize:"sm"},buttons:[...a,{onClick:()=>n(Math.min(e+1,1)),visible:0===e,glyph:"floppy-disk",tooltipId:ka(e,t)}]})})),Ra=(0,r.connect)(H.e3,{onChange:d.Rz},H.eF)((function(){let{onChange:e=(()=>{}),onFinish:t=(()=>{}),setPage:a=(()=>{}),step:n=0,editorData:r={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(za,{step:n,setPage:a,onFinish:t,hideButtons:!0},o().createElement(Ma,{key:"widget-options",data:r,onChange:e}))})),Ba=(0,r.connect)((()=>({})),{onLayerChoice:e=>(0,d.Rz)("layer",e),onResetChange:d.Rz}),Wa=(0,s.compose)((0,s.setDisplayName)("ChartLayerSelector"),Ba,(0,s.defaultProps)({layerValidationStream:e=>e.switchMap((e=>L(e)))}),x,O),ja=(0,a(297977).Z)()((0,n.lazy)((()=>Promise.all([a.e(3370),a.e(8156)]).then(a.bind(a,188156))))),Ga=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.aggregateFunction&&e.aggregationAttribute&&e.groupByAttributes},Ua=le(re),Va=(0,s.compose)((0,s.lifecycle)({UNSAFE_componentWillReceiveProps:function(){let{data:e={},valid:t,setValid:a=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&!Ga(e.options)&&a(!1)}}))((e=>{let{onChange:t=(()=>{}),onFinish:a=(()=>{}),setPage:n=(()=>{}),data:r={},layer:l={},step:s=0,types:i,featureTypeProperties:c,dependencies:d}=e;return o().createElement(Ua,{step:s,setPage:n,onFinish:a,isStepValid:e=>1!==e||Ga(r.options),hideButtons:!0},o().createElement(ja,{dependencies:d,key:"chart-options",featureTypeProperties:c,types:i,data:r,onChange:t,layer:r.layer||l}),o().createElement(Et,{key:"widget-options",data:r,onChange:t,layer:r.layer||l}))})),qa=e=>e&&e.options&&e.options.propertyName&&0!==e.options.propertyName.length,Ya=e=>{switch(e){case 1:return"widgets.builder.wizard.backToTableOptions";case 2:return"widgets.builder.wizard.backToChartOptions";default:return"back"}},$a=function(e){let{id:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?"widgets.builder.wizard.updateWidget":"widgets.builder.wizard.addTheWidget"},Ha=(0,s.compose)((0,s.branch)((function(){let{catalog:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e}),(0,r.connect)((0,l.P1)($t.R7,(e=>({catalog:e}))))))(ma),Ka=function(){let{onClose:e=(()=>{}),setSelected:t=(()=>{}),onLayerChoice:a=(()=>{}),stepButtons:n,selected:r,error:l,canProceed:s,layer:i,catalog:d,defaultServices:p,onChangeSelectedService:m,defaultSelectedService:g,onChangeCatalogMode:u,dashboardServices:h,dashboardSelectedService:y}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{className:"bg-body layer-selector",header:o().createElement(Kt,{onClose:e},o().createElement(qt,{stepButtons:n,canProceed:s&&r,onProceed:()=>a(i)}),r&&!s&&l?o().createElement(Ie.Z,{trigger:!1,glyph:"warning-sign",bsStyle:"warning",title:o().createElement(E.v0,{msgId:"widgets.builder.errors.noWidgetsAvailableTitle"}),text:o().createElement(E.k9,{msgId:"widgets.builder.errors.noWidgetsAvailableDescription"})}):null)},o().createElement(Ha,{onChangeCatalogMode:u,selectedService:""===y?y:void 0===y?g:y,onChangeSelectedService:e=>m(e,h||p),services:h||p,selected:r,catalog:d,onRecordSelected:e=>t(e)}))};function Qa(){return Qa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Qa.apply(this,arguments)}const _a=(0,r.connect)(H.e3,{setPage:d.YA,setValid:e=>(0,d.t4)("valid",e),onEditorChange:d.Rz,insertWidget:d.Qe},H.eF)((0,s.compose)(S(),(0,s.renameProps)({editorData:"data",onEditorChange:"onChange"}),(0,s.mapPropsStream)((e=>e.merge(e.distinctUntilChanged((function(){let{featureTypeProperties:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{featureTypeProperties:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e===t})).do((function(){let{featureTypeProperties:e=[],onChange:t=(()=>{}),data:a={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&e.length>0&&!h()(a,"options.propertyName")&&t("options.propertyName",e.filter((e=>!(0,w.isGeometryType)(e))).map((e=>({name:e.name}))))})).ignoreElements()))))(Va)),Ja=(0,s.compose)((0,r.connect)(H.e3,{openFilterEditor:d.fy,setPage:d.YA,onChange:d.Rz,insertWidget:d.Qe},H.eF),U,Fa(),$((e=>{let{step:t}=e;return 0===t})))((function(){let{openFilterEditor:e=(()=>{}),step:t=0,stepButtons:a=[],editorData:n={},setPage:r=(()=>{}),onFinish:l=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(Vt.Z,{btnDefaultProps:{bsStyle:"primary",bsSize:"sm"},buttons:[{onClick:()=>r(Math.max(0,t-1)),visible:t>0,glyph:"arrow-left",tooltipId:Ya(t)},...a,{visible:t>=0,onClick:e,disabled:!qa(n),glyph:"filter",tooltipId:"widgets.builder.setupFilter"},{onClick:()=>r(Math.min(t+1,2)),visible:0===t,disabled:0===t&&!qa(n),glyph:"arrow-right",tooltipId:(s=qa(n),s?"widgets.builder.wizard.configureWidgetOptions":"widgets.builder.errors.checkAtLeastOneAttribute")},{onClick:()=>l(Math.min(t+1,1)),visible:1===t,glyph:"floppy-disk",tooltipId:$a(t,n)}]});var s})),Xa=(0,s.compose)((0,r.connect)(H.e3),Y,Pa,(0,s.branch)((function(){let{layer:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e}),(0,s.renderComponent)(Wa(Ka))))((function(){let{enabled:e,onClose:t=(()=>{}),editorData:a={},exitButton:n,toggleConnection:r,availableDependencies:l=[],dependencies:s,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{header:o().createElement(Kt,{onClose:t},o().createElement(Ja,{editorData:a,exitButton:n,toggleConnection:r,availableDependencies:l,onClose:t}),0===h()(a,"options.propertyName.length")?o().createElement(Ie.Z,{trigger:!1,glyph:"exclamation-mark",bsStyle:"warning",text:o().createElement(q.Z,{msgId:"widgets.builder.errors.checkAtLeastOneAttribute"})}):null)},e?o().createElement(_a,Qa({editorData:a,dependencies:s},i)):null)}));var en=a(643378);const tn=function(e){let{id:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?"widgets.builder.wizard.updateWidget":"widgets.builder.wizard.addTheWidget"};var an=a(360445),nn=a(885461),on=a(374891),rn=a(293333);const ln=(0,m.Z)((function(){let{map:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e.layers||0===(e.layers||[]).filter((e=>"background"!==e.group)).length}),(()=>({glyph:"1-layer",title:o().createElement(q.Z,{msgId:"widgets.selectMap.TOC.noLayerTitle"}),description:o().createElement(q.Z,{msgId:"widgets.selectMap.TOC.noLayerDescription"})})))(rn.Z),sn=(0,nn.Z)(on.Z),cn=(0,s.compose)(nn.Z,(0,s.withProps)((e=>{let{selectedNode:t}=e;return{title:t&&t.title}})),(0,an.Z)("title"))(Se.Z),dn=e=>{let{preview:t,map:a={},onChange:n=(()=>{}),selectedNodes:r=[],onNodeSelect:l=(()=>{}),editNode:s,closeNodeEditor:i=(()=>{}),isLocalizedLayerStylesEnabled:c}=e;return o().createElement("div",null,o().createElement(Se.Z,{title:o().createElement(q.Z,{msgId:"widgets.builder.wizard.configureMapOptions"})}),o().createElement("div",{key:"sample",style:{marginTop:10}},o().createElement(Se.Z,{title:o().createElement(q.Z,{msgId:"widgets.builder.wizard.preview"})}),o().createElement("div",{style:{width:"100%",height:"200px"}},t)),s?[o().createElement(cn,{map:a,editNode:s}),o().createElement(sn,{closeNodeEditor:i,editNode:s,map:a,onChange:n,isLocalizedLayerStylesEnabled:c})]:[o().createElement(Se.Z,{title:o().createElement(q.Z,{msgId:"layers"})}),o().createElement(ln,{selectedNodes:r,onSelect:l,onChange:n,map:a})])};var pn=a(500023),mn=a(688132),gn=a(747119);const un=le(re),hn=(0,s.compose)((0,r.connect)((0,l.P1)(i.xI,(e=>({widgetSelectionActive:e})))),(0,V.Z)((e=>{let{widgetSelectionActive:t}=e;return t}),(()=>o().createElement("div",{style:{margin:"auto"}},o().createElement(q.Z,{msgId:"widgets.builder.wizard.selectMapToConnect"}))),{alwaysWrap:!0})),yn=(0,r.connect)((0,l.P1)(i.E2,(function(){let{editNode:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{editNode:e}})),{setEditNode:e=>(0,d.t4)("editNode",e),closeNodeEditor:()=>(0,d.t4)("editNode",void 0)});var bn=a(399790);const vn=(0,s.compose)((0,s.withProps)((e=>{let{editorData:t={}}=e;return{layers:t.maps&&t.maps.find((e=>e.mapId===t.selectedMapId))?.layers||[],selectedMapId:t.selectedMapId}})),(0,r.connect)((()=>({})),{setLayers:(e,t)=>(0,d.Rz)(`maps[${t}].layers`,e)}),(0,s.withHandlers)({addLayer:e=>{let{layers:t=[],setLayers:a=(()=>{}),catalog:n={},selectedMapId:o}=e;return e=>n.localizedLayerStyles?a([...t,(0,bn.Cx)({...e,localizedLayerStyles:n.localizedLayerStyles})],o):a([...t,(0,bn.Cx)(e)],o)},removeLayersById:e=>{let{layers:t=[],setLayers:a=(()=>{}),selectedMapId:n}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a(t.filter((t=>!ue()(M()(e),(e=>e===t.id)))),n)}}})),Cn=(0,s.withHandlers)({onRemoveSelected:e=>{let{selectedLayers:t=[],removeLayersById:a=(()=>{}),onNodeSelect:n=(()=>{})}=e;return()=>{a(t),t.forEach((e=>n(e,"layer",!1)))}}});var fn=a(701469),En=a.n(fn),wn=a(66604),Sn=a.n(wn),xn=a(159398),Pn=a(351546),Zn=a(835516);const Tn=(0,s.compose)((0,r.connect)((()=>({})),{setMap:e=>(0,d.Rz)("maps",e)}),(0,s.withHandlers)({isEpsgSupported:e=>{let{editorData:t={},selectedNodes:a=[]}=e;return()=>{const e=t.maps?.find((e=>e.mapId===t.selectedMapId))?.layers||[],n=a.map((t=>e.find((e=>e.id===t)))).filter((e=>e)).filter((e=>e.bbox)).map((e=>e.bbox)),o=n.length>0?n.reduce(((e,t)=>e.crs===t.crs?e:{crs:"differentCRS"})):{crs:"differentCRS"},r=!!Ce()(n)&&"differentCRS"!==o.crs&&o.crs;return r&&xn.default.defs(r)}},zoomTo:e=>{let{editorData:t={},setMap:a=(()=>{})}=e;return e=>{const n=t.maps?.find((e=>e.mapId===t.selectedMapId))||{},o=n.layers||[],r=e.map((e=>o.find((t=>t.id===e)))).filter((e=>e)).filter((e=>e.bbox)).map((e=>e.bbox)),l=r.length>1?r.reduce(((e,t)=>({bounds:{maxx:e.bounds.maxx>t.bounds.maxx?e.bounds.maxx:t.bounds.maxx,maxy:e.bounds.maxy>t.bounds.maxy?e.bounds.maxy:t.bounds.maxy,minx:e.bounds.minx<t.bounds.minx?e.bounds.minx:t.bounds.minx,miny:e.bounds.miny<t.bounds.miny?e.bounds.miny:t.bounds.miny},crs:t.crs})),r[0]):r[0];let s=0,i=(e=>{if(En()(e))return e.map((e=>"string"==typeof e||e instanceof String?Number(e):e));if(_t()(e)){const t=Sn()(e,(e=>"string"==typeof e||e instanceof String?Number(e):e));return[t.minx,t.miny,t.maxx,t.maxy]}return null})(l.bounds),c=Pn.default.reprojectBbox(i,l.crs,n.bbox&&n.bbox.crs||"EPSG:4326");if(c){let e=Pn.default.reproject(Zn.default.getCenterForExtent(i,l.crs),l.crs,"EPSG:4326");if("EPSG:4326"===l.crs&&i&&i[0]<=-180&&i[1]<=-90&&i[2]>=180&&i[3]>=90)s=1;else{let e=Pn.default.reprojectBbox(i,l.crs,n.projection||"EPSG:4326");s=Zn.default.getZoomForExtent(e,n.size,0,21,null)}let t={minx:c[0],miny:c[1],maxx:c[2],maxy:c[3]},o={...n.bbox,bounds:t};a({...n,center:e,zoom:s,bbox:o,mapStateSource:"tool"})}}}}),(0,s.withProps)((e=>{let{isEpsgSupported:t=(()=>{})}=e;return{epsgSupported:t()}}))),An=(0,s.compose)((0,s.withProps)((function(){let{availableDependencies:e=[],editorData:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{availableDependencies:e.filter((e=>!(t.id&&e.indexOf(t.id)>=0)))}})),(0,s.withProps)((e=>{let{editorData:t={}}=e;return{canConnect:!0,connected:!!t.mapSync}})),j({center:"center",zoom:"zoom",filter:"filter",quickFilters:"quickFilters",layer:"layer",options:"options",mapSync:"mapSync",dependenciesMap:"dependenciesMap"})),In=(0,s.compose)((0,r.connect)(H.e3,{setPage:d.YA,onChange:d.Rz,insertWidget:d.Qe},H.eF),vn,yn,Cn,Tn,(0,s.branch)((e=>{let{editNode:t}=e;return!!t}),(0,s.withProps)((e=>{let{selectedNodes:t=[],setEditNode:a=(()=>{})}=e;return{buttons:[{visible:1===t.length,tooltipId:"close",glyph:"1-close",onClick:()=>a(!1)}]}})),(0,s.withProps)((e=>{let{selectedNodes:t=[],epsgSupported:a=!1,onRemoveSelected:n=(()=>{}),setEditNode:o=(()=>{}),zoomTo:r=(()=>{})}=e;return{tocButtons:[{visible:t.length>0,glyph:"zoom-to",tooltipId:1===t.length?"toc.toolZoomToLayerTooltip":"toc.toolZoomToLayersTooltip",disabled:!a,onClick:a?()=>r(t):()=>{}},{visible:1===t.length,glyph:"wrench",tooltipId:"toc.toolLayerSettingsTooltip",onClick:()=>o(t[0])},{onClick:()=>n(),visible:t.length>0,glyph:"trash",tooltipId:"toc.toolTrashLayerTooltip"}]}}))),An,Fa(void 0,{tooltipId:"widgets.builder.wizard.backToMapSelection"}),$((e=>{let{step:t,editorData:a}=e;const n=a?.maps?.some((e=>e.name===Zn.EMPTY_MAP));return 0===t&&!n}))),kn=(0,s.compose)((0,s.branch)((function(){let{catalog:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e}),(0,r.connect)((0,l.P1)($t.R7,(e=>({catalog:e}))))))(ma);var On=a(679426);const Ln=o().createElement(ta.Z,{glyph:"geoserver",padding:20}),Nn=e=>{let{results:t,totalCount:a}=e;return{items:(""!==t&&M()(t)||[]).map((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id,title:e.name,description:e.description,preview:e.thumbnail?o().createElement("img",{src:decodeURIComponent(e.thumbnail)}):Ln,map:e}})),total:a}},Mn=function(e){let{text:t="*",options:a={}}=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,On.jh)({category:"MAP",query:t,options:{params:{start:10*n,limit:10},...a}}).map(Nn).catch((e=>b().Observable.of({error:e,items:[],total:0})))},zn={querySelector:".ms2-border-layout-body .ms2-border-layout-content",pageSize:10},Fn=(0,s.compose)((0,Xt.Z)((e=>{let{loadPage:t,scrollSpyOptions:a,...n}=e;return{...n,scrollSpyOptions:{skip:1,...a},loadPage:(r=t,(e,t)=>e.disableEmptyMap||0!==t||!e||e.text?r(e,t):r(e,t).map((e=>{let{items:t,total:a,...n}=e;return{...n,total:a,items:[{id:Zn.EMPTY_MAP,title:o().createElement(q.Z,{msgId:"widgets.selectMap.emptyMap.title"}),description:o().createElement(q.Z,{msgId:"widgets.selectMap.emptyMap.description"}),preview:Ln,map:{id:"configs/new.json"}},...t]}}))),hasMore:e=>{let{total:t,items:a}=e;return a&&a.length>=1&&a[0].id===Zn.EMPTY_MAP?t>a.length-1:t>a.length}};var r})({loadPage:Mn,scrollSpyOptions:zn,hasMore:function(){let{total:e,items:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e>t.length}})),(0,s.withProps)((e=>{let{items:t}=e;return{skip:t&&t[0]&&t[0].id===Zn.EMPTY_MAP?1:0}}))),Dn=(0,ea.Z)("searchText","setSearchText",""),Rn=((0,Xt.Z)({loadPage:Mn,scrollSpyOptions:zn,hasMore:function(){let{total:e,items:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e>t.length}}),(0,s.mapPropsStream)((e=>e.merge(e.take(1).switchMap((t=>{let{loadFirst:a=(()=>{}),disableEmptyMap:n}=t;return e.debounceTime(500).startWith({searchText:""}).distinctUntilKeyChanged("searchText",((e,t)=>e===t)).do((function(){let{searchText:e,options:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a({text:e,options:t,disableEmptyMap:n})})).ignoreElements()})))))),Bn=(0,s.compose)(Dn,Fn,Rn);var Wn=a(52855);const jn=(0,Yt.Z)(ae.Z),Gn=(0,s.compose)((0,p.Z)((e=>{let{loading:t,items:a=[]}=e;return 0===a.length&&t})),(0,m.Z)((e=>{let{loading:t,items:a=[]}=e;return 0===a.length&&!t}),{title:o().createElement(q.Z,{msgId:"catalog.noRecordsMatched"}),style:{transform:"translateY(50%)"}}))(Jt.Z),Un=e=>{let{title:t=""}=e;return o().createElement(o().Fragment,null,t,o().createElement(jn,{style:{marginLeft:4},tooltipPosition:"right",tooltip:o().createElement(Te.Z,{msgId:"widgets.mapSwitcher.subTitle"}),className:"maps-subtitle square-button-md no-border",key:"info-sign"},o().createElement(te.Glyphicon,{glyph:"info-sign"})))};var Vn=a(470509),qn=a.n(Vn),Yn=a(234228),$n=a(828878);(0,s.setObservableConfig)($n.Z);var Hn=a(423570),Kn=a.n(Hn);const Qn=(0,s.compose)((0,s.withState)("selected","setSelected",null),(0,s.withState)("mapLoading","setMapLoading",!1),(0,s.withHandlers)({onMapChoice:function(){let{onMapSelected:e=(()=>{}),selectedSource:t={},includeMapId:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return qn().all(M()(n).map((e=>("string"==typeof e.id?qn().get(e.id).then((e=>e.data)):(0,On.RX)(e.id,{baseURL:t.baseURL,includeAttributes:!1}).toPromise().then((e=>{let{data:t}=e;return t}))).then((t=>{let n=t.version||"string"==typeof e.id?Yn.ZP.normalizeConfig(t.map):Yn.ZP.convertFromLegacy(t);return{mapId:Kn()(),name:"string"==typeof e.id?Zn.EMPTY_MAP:e.name,...n&&n.map||{},...a?{id:e.id}:{},groups:n&&n.groups||[],layers:(0,bn.IK)(n.layers.map((e=>("background"!==e.group||"ol"!==e.type&&"OpenLayers.Layer"!==e.type||(e.type="empty"),e))))}})).then((e=>(e.layers=e.sources?e.layers.map((t=>{const a=(0,bn.gv)(e.sources,t);return{...t,...a}})):e.layers,{...e,mapInfoControl:!0})))))).then((t=>e({maps:t})))}}}),(0,s.mapPropsStream)((e=>e.distinctUntilKeyChanged("selected").filter((function(){let{selected:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).startWith({}).combineLatest(e,(function(){let{canProceed:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{canProceed:e,...arguments.length>1?arguments[1]:void 0}}))))),_n=Bn((e=>{let{setSearchText:t=(()=>{}),selected:a,skip:n=0,onSelected:r,loading:l,searchText:s,items:i=[],loaderProps:d={},total:p,header:m,title:g=o().createElement(q.Z,{msgId:"maps.title"})}=e;return o().createElement(c.Z,{className:"map-catalog",header:m||o().createElement(Wn.Z,{title:o().createElement(Un,{title:g}),searchText:s,onSearchTextChange:t}),footer:o().createElement("div",{className:"catalog-footer"},l&&i.length>0?o().createElement(aa.Z,null):null,Ze()(p)?null:o().createElement("span",{className:"res-info"},o().createElement(q.Z,{msgId:"catalog.pageInfoInfinite",msgParams:{loaded:i.length-n,total:p}})))},o().createElement(Gn,{loaderProps:d,items:i.map((e=>!F()(a)&&e&&e.map&&a.some((t=>t.id===e.map.id))?{...e,selected:!0}:e)),loading:l,onItemClick:function(){let{map:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(arguments.length>2?arguments[2]:void 0).ctrlKey?r(F()(a)?M()(e):M()(a).concat(e)):r(M()(e))}}))})),Jn=Qn((function(){let{onClose:e=(()=>{}),setSelected:t=(()=>{}),onMapChoice:a=(()=>{}),stepButtons:n=[],selected:r,disableEmptyMap:l,mapLoading:s,setMapLoading:i=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{className:"bg-body layer-selector",header:o().createElement(Ht,{onClose:e},o().createElement(Vt.Z,{btnDefaultProps:{bsStyle:"primary",bsSize:"sm"},buttons:[...n,{tooltipId:"widgets.builder.wizard."+(r?.length>1?"useTheseMap":"useThisMap"),onClick:()=>{a(r),i(!0)},visible:!0,disabled:!r||s,glyph:"arrow-right"}]}))},o().createElement(_n,{title:o().createElement(q.Z,{msgId:"widgets.builder.wizard.selectAMap"}),selected:r,onSelected:e=>{t(e),i(!1)},disableEmptyMap:l}))})),Xn=(0,s.compose)((0,r.connect)((()=>({})),{onMapSelected:e=>{let{maps:t}=e;return(0,d.Rz)("maps",t)},onResetChange:d.Rz}),(0,s.withProps)((e=>{let{onResetChange:t=(()=>{})}=e;return{stepButtons:[{glyph:"arrow-left",tooltipId:"widgets.builder.wizard.backToWidgetTypeSelection",onClick:()=>{t("maps",void 0),t("selectedMapId",void 0),t("widgetType",void 0)}}]}})))(Jn);function eo(){return eo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},eo.apply(this,arguments)}const to=In((function(){let{step:e=0,buttons:t,tocButtons:a=[],stepButtons:n=[],dashBoardEditing:r=!1,editorData:l={},setPage:s=(()=>{}),onFinish:i=(()=>{}),toggleLayerSelector:c=(()=>{}),onChange:d=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const p=(l?.maps||[]).find((e=>e.mapId===l?.selectedMapId))||{},m="map"===l?.widgetType&&F()(p);return o().createElement(Vt.Z,{btnDefaultProps:{bsStyle:"primary",bsSize:"sm"},buttons:t||[...0===e?a:[],{onClick:()=>s(Math.max(e-1,0)),visible:1===e,glyph:"arrow-left",tooltipId:"widgets.builder.wizard.configureMapOptions"},...n,{onClick:()=>d(`maps[${l?.selectedMapId}].mapInfoControl`,!p?.mapInfoControl),visible:!m&&r&&"map"===l?.widgetType,glyph:"info-sign",bsStyle:p?.mapInfoControl?"success":"primary",tooltipId:p?.mapInfoControl?"widgets.builder.wizard.disableIdentifyTool":"widgets.builder.wizard.enableIdentifyTool"},{onClick:()=>c(!0),visible:!m&&0===e,glyph:"plus",tooltipId:"widgets.builder.wizard.addLayer"},{onClick:()=>s(Math.min(e+1,2)),visible:!m&&0===e,glyph:"arrow-right",tooltipId:"widgets.builder.wizard.configureWidgetOptions"},{onClick:()=>i(Math.min(e+1,1)),visible:1===e,glyph:"floppy-disk",tooltipId:tn(e,l)}]})})),ao=(0,s.compose)((0,r.connect)(H.e3,{onResetChange:d.Rz}),(0,s.branch)((function(){let{editorData:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e.maps}),(0,s.renderComponent)(Xn)),(0,s.withState)("layerSelectorOpen","toggleLayerSelector",!1),Pa,(0,s.branch)((function(){let{layerSelectorOpen:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}),(0,s.renderComponent)((0,s.compose)(vn,(0,s.withHandlers)({onLayerChoice:e=>{let{toggleLayerSelector:t=(()=>{}),addLayer:a=(()=>{})}=e;return e=>{a(e),t(!1)}}}),O)((function(){let{onClose:e=(()=>{}),setSelected:t=(()=>{}),onLayerChoice:a=(()=>{}),toggleLayerSelector:n=(()=>{}),selected:r,canProceed:l,layer:s,catalog:i,onChangeSelectedService:d,defaultServices:p,defaultSelectedService:m,onChangeCatalogMode:g,dashboardServices:u,dashboardSelectedService:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{className:"bg-body layer-selector",header:o().createElement(Kt,{onClose:e},o().createElement(Vt.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary",bsSize:"sm"},buttons:[{onClick:()=>n(!1),tooltipId:"close",glyph:"1-close"},{onClick:()=>a(s),disabled:!r||!l,tooltipId:"widgets.builder.wizard.useTheSelectedLayer",glyph:"plus"}]}),r&&!l?o().createElement(Ie.Z,{glyph:"exclamation-mark",bsStyle:"warning",title:o().createElement(E.v0,{msgId:"widgets.builder.errors.noWidgetsAvailableTitle"}),text:o().createElement(E.k9,{msgId:"widgets.builder.errors.noWidgetsAvailableDescription"})}):null)},o().createElement(kn,{onChangeCatalogMode:g,selectedService:""===h?h:void 0===h?m:h,onChangeSelectedService:e=>d(e,u||p),services:u||p,catalog:i,selected:r,onRecordSelected:e=>t(e)}))})))),(0,s.withProps)((e=>{let{onResetChange:t=(()=>{})}=e;return{exitButton:{glyph:"arrow-left",onClick:()=>{t("maps",void 0),t("selectedMapId",void 0)}}}}))),no=(0,r.connect)(H.e3,{onChange:d.Rz},H.eF)((function(){let{onChange:e=(()=>{}),onFinish:t=(()=>{}),setPage:a=(()=>{}),step:r=0,selectedNodes:l=[],onNodeSelect:s=(()=>{}),editorData:i={},editNode:c,setEditNode:d=(()=>{}),closeNodeEditor:p=(()=>{}),isLocalizedLayerStylesEnabled:m,env:g}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[u,h]=(0,n.useState)({}),[y,b]=(0,n.useState)(!1);return o().createElement(un,{step:r,setPage:a,onFinish:t,hideButtons:!0,className:"map-options"},o().createElement("div",null,y&&o().createElement(gn.Z,{glyph:"1-map",title:o().createElement(q.Z,{msgId:"widgets.selectMap.emptyMap.title"}),description:o().createElement(q.Z,{msgId:"widgets.selectMap.emptyMap.noNameDescription"})}),o().createElement(mn.Z,{editorData:i,onChange:e,value:i.selectedMapId,setSelectedMap:h,selectedMap:u,setEmptyMap:b,emptyMap:y,withContainer:!0}),!y&&o().createElement(dn,{editNode:c,setEditNode:d,closeNodeEditor:p,onNodeSelect:s,selectedNodes:l,onChange:e,isLocalizedLayerStylesEnabled:m,preview:o().createElement(pn.Z,{key:i.selectedMapId,onChange:e,layers:u&&u.layers,map:u,env:g,options:{style:{margin:10,height:"calc(100% - 20px)"}}}),map:u})),o().createElement(Et,{key:"widget-options",data:i,onChange:e}))})),oo=(0,s.compose)(ao,(0,s.withProps)((e=>{let{editorData:t={}}=e;return{map:ue()(t?.maps,(function(){let{mapId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e===t.selectedMapId}))||{}}})),hn,en.Z,yn)((function(){let{enabled:e,onClose:t=(()=>{}),toggleLayerSelector:a=(()=>{}),editorData:n={},editNode:r,setEditNode:l,closeNodeEditor:s,isLocalizedLayerStylesEnabled:i,env:d,selectedGroups:p=[],exitButton:m,selectedLayers:g=[],selectedNodes:u,onNodeSelect:h=(()=>{}),availableDependencies:y=[],toggleConnection:b=(()=>{}),...v}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{className:"map-selector",header:o().createElement(Kt,{onClose:t},o().createElement(to,{exitButton:m,editorData:n,availableDependencies:y,toggleConnection:b,selectedNodes:u,selectedLayers:g,selectedGroups:p,onNodeSelect:h,toggleLayerSelector:a}))},e?o().createElement(no,eo({setEditNode:l,editNode:r,closeNodeEditor:s,onNodeSelect:h,isLocalizedLayerStylesEnabled:i,env:d,selectedNodes:u},v)):null)})),ro=(0,s.compose)((0,s.setDisplayName)("CounterLayerSelector"),Ba,(0,s.defaultProps)({layerValidationStream:e=>e.switchMap((e=>(e=>y.Observable.forkJoin((0,v.v$)({layer:e}),f(e)))(e)))}),x,O);var lo=a(580328),so=a(677902);function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},io.apply(this,arguments)}const co=(0,p.Z)((e=>{let{loading:t,data:a}=e;return t||!a}),{width:500,height:200}),po=(0,s.compose)((0,s.lifecycle)({componentDidMount(){this.props.onChange&&this.props.onChange("options.groupByAttributes",void 0)}}),be,(0,se.Z)((e=>{let{options:t=[]}=e;return 0===t.length})))(ft),mo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{hasAggregateProcess:t}=arguments.length>1?arguments[1]:void 0;return e.aggregateFunction&&e.aggregationAttribute&&t},go=(0,s.compose)((0,s.lifecycle)({UNSAFE_componentWillReceiveProps:function(){let{valid:e,data:t=[],options:a={},setValid:n=(()=>{}),error:o,hasAggregateProcess:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const l=!Ze()(t[0])&&!o;!!e!=!!l&&mo(a,{hasAggregateProcess:r})&&n(l)}})),uo=(0,s.compose)(Zt.Z,Tt.Z,At.Z,lo.Z,go,co,kt.Z,It.Z),ho={style:{width:450,height:100}},yo=le(re),bo=uo(so.Z),vo=e=>{let{data:t={},layer:a,dependencies:n={},valid:r,setValid:l=(()=>{}),hasAggregateProcess:s}=e;return mo(t.options,{hasAggregateProcess:s})?o().createElement(bo,io({hasAggregateProcess:s},ho,{valid:r,dependenciesMap:t.dependenciesMap,dependencies:n,setValid:l,type:t.type,legend:t.legend,layer:t.layer||a,filter:t.filter,geomProp:t.geomProp,mapSync:t.mapSync,options:t.options})):o().createElement(so.Z,io({},ho,{data:[{data:42}],options:t.options,series:[{dataKey:"data"}]}))},Co=(0,s.compose)((0,s.lifecycle)({UNSAFE_componentWillReceiveProps:function(){let{data:e={},valid:t,setValid:a=(()=>{}),hasAggregateProcess:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&!mo(e.options,{hasAggregateProcess:n})&&a(!1)}}))((e=>{let{onChange:t=(()=>{}),onFinish:a=(()=>{}),setPage:n=(()=>{}),setValid:r=(()=>{}),valid:l,formOptions:s,data:i={},layer:c={},step:d=0,types:p,featureTypeProperties:m,dependencies:g,hasAggregateProcess:u}=e;return o().createElement(yo,{step:d,setPage:n,onFinish:a,isStepValid:e=>1!==e||mo(i.options,{hasAggregateProcess:u}),hideButtons:!0},o().createElement(po,{hasAggregateProcess:u,dependencies:g,key:"chart-options",formOptions:s,featureTypeProperties:m,types:p,data:i,onChange:t,layer:i.layer||c,sampleChart:o().createElement(vo,{hasAggregateProcess:u,data:i,valid:l,layer:i.layer||c,dependencies:g,setValid:e=>r(e&&mo(i.options,{hasAggregateProcess:u}))})}),o().createElement(Et,{key:"widget-options",data:i,onChange:t,layer:i.layer||c,sampleChart:o().createElement(vo,{hasAggregateProcess:u,data:i,valid:l,layer:i.layer||c,dependencies:g,setValid:e=>r(e&&mo(i.options,{hasAggregateProcess:u}))})}))})),fo=e=>{switch(e){case 0:return"widgets.builder.wizard.backToTypeSelection";case 1:return"widgets.builder.wizard.backToChartOptions";default:return"back"}},Eo=e=>0===e?"widgets.builder.wizard.configureWidgetOptions":"next",wo=function(e){let{id:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?"widgets.builder.wizard.updateWidget":"widgets.builder.wizard.addTheWidget"};function So(){return So=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},So.apply(this,arguments)}const xo=(0,r.connect)(H.e3,{setPage:d.YA,setValid:e=>(0,d.t4)("valid",e),onEditorChange:d.Rz,insertWidget:d.Qe},H.eF)((0,s.compose)(S({needsWPS:!0}),(0,s.renameProps)({editorData:"data",onEditorChange:"onChange"}))(Co)),Po=(0,s.compose)((0,r.connect)(H.e3,{openFilterEditor:d.fy,setPage:d.YA,onChange:d.Rz,insertWidget:d.Qe},H.eF),U,Fa(),$((e=>{let{step:t}=e;return 0===t})))((function(){let{openFilterEditor:e=(()=>{}),step:t=0,stepButtons:a=[],editorData:n={},valid:r,setPage:l=(()=>{}),onFinish:s=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(Vt.Z,{btnDefaultProps:{bsStyle:"primary",bsSize:"sm"},buttons:[{onClick:()=>l(Math.max(0,t-1)),visible:t>0,glyph:"arrow-left",tooltipId:fo(t)},...a,{visible:0===t,onClick:e,disabled:!r,glyph:"filter",tooltipId:"widgets.builder.setupFilter"},{onClick:()=>l(Math.min(t+1,2)),visible:0===t,disabled:0===t&&!r,glyph:"arrow-right",tooltipId:Eo(t)},{onClick:()=>s(Math.min(t+1,1)),visible:1===t,glyph:"floppy-disk",tooltipId:wo(t,n)}]})})),Zo=(0,s.compose)((0,r.connect)(H.e3),Y,Pa,(0,s.branch)((function(){let{layer:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e}),(0,s.renderComponent)(ro(Ka))))((function(){let{enabled:e,onClose:t=(()=>{}),exitButton:a,editorData:n,toggleConnection:r,availableDependencies:l=[],dependencies:s,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{header:o().createElement(Kt,{onClose:t},o().createElement(Po,{exitButton:a,editorData:n,toggleConnection:r,availableDependencies:l,onClose:t}))},e?o().createElement(xo,So({formOptions:{showColorRamp:!1,showUom:!0,showGroupBy:!1,showLegend:!1},dependencies:s},i)):null)})),To=e=>{switch(e){case 1:return"widgets.builder.wizard.backToPreview";case 2:return"widgets.builder.wizard.backToChartOptions";default:return"back"}},Ao=(e,t)=>t?"widgets.builder.wizard.configureWidgetOptions":void 0,Io=e=>{let{mapSync:t}=e;return t},ko=function(e){let{id:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?"widgets.builder.wizard.updateWidget":"widgets.builder.wizard.addTheWidget"};var Oo=a(526214),Lo=a(819369),No=a(657461);const Mo=le(re),zo=(0,s.compose)(Lo.Z,(0,m.Z)((e=>{let{valid:t}=e;return!t}),{title:o().createElement(q.Z,{msgId:"widgets.builder.errors.noMapAvailableForLegend"}),description:o().createElement(q.Z,{msgId:"widgets.builder.errors.noMapAvailableForLegendDescription"})}),(0,Oo.Z)(!1))(No.Z);var Fo=a(707366);const Do=(0,s.compose)((0,s.withProps)((function(){let{availableDependencies:e=[],editorData:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{availableDependencies:e.filter((e=>!(t.id&&e.indexOf(t.id)>=0)))}})),(0,s.withProps)((e=>{let{editorData:t={},availableDependencies:a=[]}=e;return{canConnect:a.length>0,connected:!!t.mapSync}})));function Ro(){return Ro=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Ro.apply(this,arguments)}const Bo=(0,s.withProps)((e=>{let{availableDependencies:t=[],editorData:a}=e;return{valid:t.length>0&&a.mapSync}})),Wo=(0,l.P1)(Fo.Pz,(e=>({currentLocale:e}))),jo=(0,s.compose)((0,r.connect)(H.e3,{setPage:d.YA,onEditorChange:d.Rz,insertWidget:d.Qe,updateWidgetProperty:d.Ij},H.eF),(0,r.connect)(Wo),Bo,(0,s.renameProps)({editorData:"data",onEditorChange:"onChange",updateWidgetProperty:"updateProperty"}))((function(){let{onChange:e=(()=>{}),onFinish:t=(()=>{}),setPage:a=(()=>{}),step:n=0,dependencies:r,valid:l,data:s={},currentLocale:i,language:c,updateProperty:d=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(Mo,{step:n,setPage:a,onFinish:t,hideButtons:!0},o().createElement(te.Row,null,o().createElement(Se.Z,{title:o().createElement(q.Z,{msgId:"widgets.builder.wizard.preview"})}),o().createElement(te.Col,{xs:12},o().createElement("div",{style:{marginBottom:"30px"}},o().createElement(zo,{valid:l,dependencies:r,dependenciesMap:s.dependenciesMap,key:"widget-options",currentLocale:i,language:c,updateProperty:d,disableVisibility:!0,disableOpacitySlider:!0,legendExpanded:!0})))),o().createElement(Et,{key:"widget-options",onChange:e}))})),Go=(0,s.compose)((0,r.connect)(H.e3,{openFilterEditor:d.fy,setPage:d.YA,onChange:d.Rz,insertWidget:d.Qe},H.eF),Do,Bo,(0,r.connect)((()=>({})),{onLayerChoice:e=>(0,d.Rz)("layer",e),onResetChange:d.Rz}),(0,s.withProps)((e=>{let{onResetChange:t=(()=>{})}=e;return{exitButton:{glyph:"arrow-left",tooltipId:"widgets.builder.wizard.backToWidgetTypeSelection",onClick:()=>t("widgetType",void 0)}}})),Fa((e=>{let{step:t}=e;return 0===t})),$((e=>{let{step:t}=e;return 0===t})))((function(){let{step:e=0,editorData:t={},valid:a,stepButtons:n=[],onFinish:r=(()=>{}),setPage:l=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(Vt.Z,{btnDefaultProps:{bsStyle:"primary",bsSize:"sm"},buttons:[{onClick:()=>l(Math.max(0,e-1)),visible:e>0,glyph:"arrow-left",tooltipId:To(e)},...n,{onClick:()=>l(Math.min(e+1,1)),visible:0===e,disabled:0===e&&!Io(t)||!a,glyph:"arrow-right",tooltipId:Ao(0,a)},{onClick:()=>r(Math.min(e+1,1)),visible:1===e,glyph:"floppy-disk",tooltipId:ko(e,t)}]})})),Uo=(0,s.compose)((0,r.connect)(H.e3),Y,Do,j({layers:"layers",zoom:"zoom",viewport:"viewport"}),(0,s.mapPropsStream)((e=>e.merge(e.filter((e=>{let{editorData:t={}}=e;return!t.mapSync})).take(1).distinctUntilChanged().do((e=>{let{toggleConnection:t=(()=>{}),availableDependencies:a,widgets:n}=e;return t(a,n)})).ignoreElements())))),Vo=Uo((function(){let{enabled:e,onClose:t=(()=>{}),editorData:a={},exitButton:n,toggleConnection:r,availableDependencies:l=[],dependencies:s,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{header:o().createElement(Kt,{onClose:t},o().createElement(Go,{editorData:a,exitButton:n,toggleConnection:r,availableDependencies:l,onClose:t}),0===h()(a,"options.propertyName.length")?o().createElement(Ie.Z,{trigger:!1,glyph:"exclamation-mark",bsStyle:"warning",text:o().createElement(q.Z,{msgId:"widgets.builder.errors.checkAtLeastOneAttribute"})}):null)},e?o().createElement(jo,Ro({availableDependencies:l,editorData:a,dependencies:s},i)):null)})),qo=[{title:o().createElement(q.Z,{msgId:"widgets.types.chart.title"}),type:"chart",caption:o().createElement(q.Z,{msgId:"widgets.types.chart.caption"}),glyph:"stats",className:"ms-widget-selector-chart"},{title:o().createElement(q.Z,{msgId:"widgets.types.text.title"}),type:"text",glyph:"sheet",caption:o().createElement(q.Z,{msgId:"widgets.types.text.caption"}),className:"ms-widget-selector-text"},{title:o().createElement(q.Z,{msgId:"widgets.types.table.title"}),type:"table",glyph:"features-grid",caption:o().createElement(q.Z,{msgId:"widgets.types.table.caption"}),className:"ms-widget-selector-table"},{title:o().createElement(q.Z,{msgId:"widgets.types.counter.title"}),type:"counter",glyph:"counter",caption:o().createElement(q.Z,{msgId:"widgets.types.counter.caption"}),className:"ms-widget-selector-counter"},{title:o().createElement(q.Z,{msgId:"widgets.types.map.title"}),type:"map",glyph:"1-map",caption:o().createElement(q.Z,{msgId:"widgets.types.map.caption"}),className:"ms-widget-selector-map"},{title:o().createElement(q.Z,{msgId:"widgets.types.legend.title"}),type:"legend",glyph:"list",caption:o().createElement(q.Z,{msgId:"widgets.types.legend.caption"}),className:"ms-widget-selector-legend"}],Yo=(0,r.connect)((()=>({})),{onSelect:e=>(0,d.Rz)("widgetType",e)})((e=>{let{widgetTypes:t=qo,typeFilter:a=(()=>!0),onSelect:n=(()=>{})}=e;return o().createElement(Jt.Z,{key:"content",onItemClick:e=>{n(e.type)},items:t&&t.filter(a).map((e=>({...e,preview:o().createElement(ta.Z,{glyph:e.glyph,padding:20})})))})}));function $o(){return $o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},$o.apply(this,arguments)}const Ho=(0,l.P1)(i.YI,(e=>({widgetType:e&&e.widgetType}))),Ko={chart:Ia,text:function(){let{enabled:e,onClose:t=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{header:o().createElement(Kt,{onClose:t},o().createElement(Da,null))},e?o().createElement(Ra,null):null)},table:Xa,map:oo,counter:Zo,legend:Vo},Qo=(0,s.compose)((0,r.connect)(Ho),(0,s.withProps)((e=>{let{typeFilter:t=(()=>!0),availableDependencies:a=[]}=e;return{typeFilter:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(e)&&!("legend"===e.type&&0===a.length)}}})),(0,s.branch)((function(){let{widgetType:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!e}),(0,s.renderComponent)((function(){let{enabled:e,onClose:t=(()=>{}),typeFilter:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(c.Z,{className:"bg-body",header:o().createElement(Kt,{onClose:t},o().createElement(q.Z,{msgId:"widgets.selectWidgetType"}))},e?o().createElement(Yo,{typeFilter:a}):null)})),(()=>function(){let{widgetType:e,onClose:t=(()=>{}),...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=Ko[e];return o().createElement(n,$o({},a,{onClose:t,widgetType:e}))})))()},366907:(e,t,a)=>{"use strict";a.d(t,{eF:()=>d,e3:()=>p,Nb:()=>m,Tw:()=>g});var n=a(414293),o=a.n(n),r=a(22222),l=a(641259),s=a(707366),i=a(665529),c=a(952273);const d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{...a,...e,...t,step:e&&e.settings&&e.settings.step,valid:e&&e.settings&&e.settings.valid,onFinish:()=>t.insertWidget&&t.insertWidget({layer:e.layer,url:e.layer&&e.layer.url,...e.editorData||{}},a.target)}},p=(0,r.P1)(c.GW,c.TK,c.YI,c.E2,c.zm,l.i$,((e,t,a,n,o,r)=>({layer:e,layers:t,editorData:a,settings:n,widgets:o,dashBoardEditing:r}))),m=(0,r.P1)(c.YI,l.P0,c.h9,c.zA,((e,t,a,n)=>{let{layer:o}=e;return{layer:o,showConnections:t,dependencies:a,...n}})),g=(0,r.P1)(i.Yf,s.KV,i.fY,((e,t,a)=>({isLocalizedLayerStylesEnabled:!o()(e),language:t,env:a})));c.GW,c.zA}}]);