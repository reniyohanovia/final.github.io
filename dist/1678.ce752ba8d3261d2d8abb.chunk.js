(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[1678],{16075:(e,t,i)=>{"use strict";i.d(t,{H:()=>v,k:()=>F});var r=i(333101),o=i(467763),l=i(487758),s=i(470509),n=i.n(s),a=i(472500),p=i.n(a),d=i(727418),u=i.n(d),c=i(505055),h=i.n(c);const f={describeCoverage:function(e,t){const i=p().parse(e,!0),r=p().format(u()({},i,{query:u()({service:"WCS",version:"1.1.0",identifiers:t,request:"DescribeCoverage"},i.query)}));return n().get(r).then((e=>{let t;return h().parseString(e.data,{explicitArray:!1},((e,i)=>{t=i})),t}))}};var m=i(399790),b=i(227361),g=i.n(b),y=i(988594);function v(e,t,i){return s=>o.ZP.describeLayer(e,t.name,i).then((i=>i&&"WFS"===i.owsType?l.v$(e,i.name).then((e=>(i.geometryType=(0,y.mI)(e),s((0,r.tV)(t.id,"id",{describeLayer:i,describeFeatureType:e}))))).catch((()=>s((0,r.tV)(t.id,"id",{describeLayer:i||{error:"no describe feature found"}})))):(i&&"WCS"===i.owsType&&f.describeCoverage(e,i.name).then((e=>{let o=g()(e,"wcs:CoverageDescriptions.wcs:CoverageDescription.wcs:Range.wcs:Field.wcs:Axis.wcs:AvailableKeys.wcs:Key");i.bands=o&&"string"==typeof o?["1"]:o.map(((e,t)=>t+1+"")),s((0,r.tV)(t.id,"id",{describeLayer:i,describeCoverage:e}))})).catch((()=>s((0,r.tV)(t.id,"id",{describeLayer:i||{error:"no describe coverage found"}})))),s((0,r.tV)(t.id,"id",{describeLayer:i||{error:"no describe Layer found"}}))))).catch((e=>s((0,r.tV)(t.id,"id",{describeLayer:{error:e.status}}))))}function F(e,t){const i=(0,m.Fh)(e);return l=>(l((0,r.tV)(e.id,"id",{capabilitiesLoading:!0})),o.ZP.getCapabilities(i,t).then((t=>{const i=o.ZP.parseLayerCapabilities(t,e);l(i?(0,r.tV)(e.id,"id",(0,m.IA)(i)):(0,r.tV)(e.id,"id",{capabilitiesLoading:null,capabilities:{error:"error getting capabilities",details:"no layer info"},description:null}))})).catch((t=>{l((0,r.tV)(e.id,"id",{capabilitiesLoading:null,capabilities:{error:"error getting capabilities",details:t},description:null}))})))}},651493:(e,t,i)=>{"use strict";i.d(t,{Z:()=>ee});var r=i(124852),o=i.n(r),l=i(45697),s=i.n(l),n=i(630294),a=i(8204),p=i(401811),d=i(581368),u=i(727418),c=i.n(u),h=i(719648);function f(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class m extends o().Component{constructor(){super(...arguments),f(this,"renderOperatorField",(()=>o().createElement(d.Z,{dropUp:this.props.dropUp,fieldOptions:this.props.operatorOptions,fieldName:"operator",fieldRowId:this.props.filterField.rowId,fieldValue:this.props.filterField.operator,onUpdateField:this.updateFieldElement}))),f(this,"renderValueField",(e=>o().cloneElement(o().Children.toArray(this.props.children).filter((t=>t.props.attType===e.type))[0],c()({fieldName:"value",fieldRowId:this.props.filterField.rowId,fieldValue:this.props.filterField.value,fieldException:this.props.filterField.exception,onUpdateField:this.updateFieldElement,toggleMenu:this.props.toggleMenu,maxFeaturesWPS:this.props.maxFeaturesWPS,onUpdateExceptionField:this.updateExceptionFieldElement},e.fieldOptions||{})))),f(this,"updateExceptionFieldElement",((e,t)=>{this.props.onUpdateExceptionField(e,t)})),f(this,"updateFieldElement",((e,t,i,r,o)=>{let l;if("attribute"===t){l=this.props.attributes.filter((e=>e.attribute===i))[0];const s=l&&l.type||r;this.props.onUpdateField(e,t,i,s,o),"array"===s&&this.props.onUpdateField(e,"operator","contains",s,o)}else this.props.onUpdateField(e,t,i,"boolean"===r?"string":r,o);if("value"===t){let e=this.props.attributes.filter((e=>e.dependson&&e.dependson.field===this.props.filterField.attribute));e.length>0&&this.props.onChangeCascadingValue(e)}}))}render(){let e=this.props.attributes.filter((e=>e.attribute===this.props.filterField.attribute))[0];return o().createElement("div",{className:"filter-field-row"},o().createElement("div",{className:"filter-field-attribute"},o().createElement(d.Z,{dropUp:this.props.dropUp,valueField:"id",textField:"name",fieldOptions:this.props.attributes.map((e=>({id:e.attribute,name:e.label}))),placeholder:(0,h.S$)(this.context.messages,"queryform.attributefilter.combo_placeholder"),fieldValue:this.props.filterField.attribute,attType:e&&e.type,fieldName:"attribute",fieldRowId:this.props.filterField.rowId,onUpdateField:this.updateFieldElement,comboFilter:"contains"})),o().createElement("div",{className:"filter-field-operator"},e?this.renderOperatorField():null),o().createElement("div",{className:"filter-field-value"},e&&this.props.filterField.operator?this.renderValueField(e):null),this.props.deleteButton?o().createElement("div",{className:"filter-field-tools"},this.props.deleteButton):null)}}f(m,"propTypes",{dropUp:s().bool,attributes:s().array,filterField:s().object,operatorOptions:s().array,onUpdateField:s().func,maxFeaturesWPS:s().number,toggleMenu:s().func,deleteButton:s().node,onUpdateExceptionField:s().func,onChangeCascadingValue:s().func}),f(m,"contextTypes",{messages:s().object}),f(m,"defaultProps",{attributes:[],filterField:null,operatorOptions:["=",">","<",">=","<=","<>","><"],onUpdateField:()=>{},toggleMenu:()=>{},onUpdateExceptionField:()=>{},onChangeCascadingValue:()=>{}});const b=m;var g=i(730381),y=i.n(g),v=i(93054),F=i.n(v),E=i(63528),w=i(804504),x=i(926244),P=i(200020);function I(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}F()(y());const C=(0,E.Z)({dateProp:"value",dateTypeProp:"type",setDateProp:"onChange"})(P.DateTimePicker);class T extends o().Component{constructor(){super(...arguments),I(this,"updateValueState",(e=>{e.startDate&&e.endDate&&e.startDate>e.endDate?this.props.onUpdateExceptionField(this.props.fieldRowId,"queryform.attributefilter.datefield.wrong_date_range"):this.props.onUpdateExceptionField(this.props.fieldRowId,null),this.props.onUpdateField(this.props.fieldRowId,this.props.fieldName,e,this.props.attType)}))}render(){const e=this.props.fieldValue&&this.props.fieldValue.startDate||null,t=this.props.fieldValue&&this.props.fieldValue.endDate||null;return"><"===this.props.operator?o().createElement("div",{className:"query-field"},o().createElement("div",{className:"query-field-value date-filter-left"},this.props.showLabels&&o().createElement(w.Z,{msgId:"queryform.from"}),o().createElement(C,{type:this.props.attType,defaultValue:e,value:e,calendar:this.props.dateEnabled,time:this.props.timeEnabled,format:(0,x.V$)(this.context.locale,this.props.attType),onChange:e=>this.updateValueState({startDate:e,endDate:t})})),o().createElement("div",{className:"query-field-value date-filter-right"},this.props.showLabels&&o().createElement(w.Z,{msgId:"queryform.to"}),o().createElement(C,{type:this.props.attType,defaultValue:t,value:t,calendar:this.props.dateEnabled,time:this.props.timeEnabled,format:(0,x.V$)(this.context.locale,this.props.attType),onChange:t=>this.updateValueState({startDate:e,endDate:t})}))):o().createElement("div",null,this.props.showLabels&&o().createElement(w.Z,{msgId:"queryform.date"}),o().createElement(C,{type:this.props.attType,defaultValue:e,value:e,time:this.props.timeEnabled,calendar:this.props.dateEnabled,format:(0,x.V$)(this.context.locale,this.props.attType),onChange:e=>{this.updateValueState({startDate:e,endDate:null})}}))}}I(T,"propTypes",{attType:s().string,dateEnabled:s().bool,fieldName:s().string,fieldRowId:s().number,fieldValue:s().object,fieldException:s().string,operator:s().string,onUpdateField:s().func,onUpdateExceptionField:s().func,showLabels:s().bool,timeEnabled:s().bool}),I(T,"contextTypes",{locale:s().string}),I(T,"defaultProps",{timeEnabled:!1,dateEnabled:!0,operator:null,fieldName:null,fieldRowId:null,attType:null,fieldValue:null,fieldException:null,onUpdateField:()=>{},onUpdateExceptionField:()=>{},showLabels:!1});const V=T;var U=i(509886);function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},O.apply(this,arguments)}function S(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.n(U)()();class N extends o().Component{constructor(){super(...arguments),S(this,"renderPicker",(e=>{let t=this.props.label?o().createElement("label",null,this.props.label):null,i=this.props.lowLabel?o().createElement("label",null,this.props.lowLabel):null,r=this.props.upLabel?o().createElement("label",null,this.props.upLabel):null;return"><"===this.props.operator?o().createElement("div",{className:"query-field"},o().createElement("div",{className:"query-field-value"},i,o().createElement(P.NumberPicker,O({style:e,value:this.props.fieldValue&&null!==this.props.fieldValue.lowBound&&void 0!==this.props.fieldValue.lowBound?this.props.fieldValue.lowBound:null,onChange:e=>!isNaN(e)&&this.changeNumber({lowBound:e,upBound:this.props.fieldValue&&null!==this.props.fieldValue.upBound&&void 0!==this.props.fieldValue.upBound?this.props.fieldValue.upBound:null})},this.props.options))),o().createElement("div",{className:"query-field-value"},r,o().createElement(P.NumberPicker,O({style:e,value:this.props.fieldValue&&null!==this.props.fieldValue.upBound&&void 0!==this.props.fieldValue.upBound?this.props.fieldValue.upBound:null,onChange:e=>!isNaN(e)&&this.changeNumber({upBound:e,lowBound:this.props.fieldValue&&null!==this.props.fieldValue.lowBound&&void 0!==this.props.fieldValue.lowBound?this.props.fieldValue.lowBound:null})},this.props.options)))):o().createElement("div",null,t,o().createElement(P.NumberPicker,O({style:e,value:this.props.fieldValue&&null!==this.props.fieldValue.lowBound&&void 0!==this.props.fieldValue.lowBound?this.props.fieldValue.lowBound:this.props.fieldValue,onChange:e=>!isNaN(e)&&this.changeNumber(e)},this.props.options)))})),S(this,"changeNumber",(e=>{"><"===this.props.operator?null!==e.lowBound&&void 0!==e.lowBound&&null!==e.upBound&&void 0!==e.upBound&&e.lowBound>=e.upBound?this.props.onUpdateExceptionField(this.props.fieldRowId,(0,h.S$)(this.context.messages,"queryform.attributefilter.numberfield.wrong_range")):this.props.fieldException&&this.props.onUpdateExceptionField(this.props.fieldRowId,null):this.props.isRequired&&null==e?this.props.onUpdateExceptionField(this.props.fieldRowId,(0,h.S$)(this.context.messages,"queryform.attributefilter.numberfield.isRequired")):this.props.fieldException&&this.props.onUpdateExceptionField(this.props.fieldRowId,null),this.props.onUpdateField(this.props.fieldRowId,this.props.fieldName,e,this.props.attType)}))}render(){let e=this.props.style;return this.props.fieldException&&(e={...this.props.style,borderColor:"#FF0000"}),o().createElement(p.Z,{placement:"bottom",overlay:this.props.fieldException?o().createElement(n.Tooltip,{id:this.props.fieldRowId+"_tooltip"},o().createElement("strong",null,this.props.fieldException)):o().createElement("noscript",null)},this.renderPicker(e))}}S(N,"propTypes",{operator:s().string,fieldName:s().string,fieldRowId:s().number,attType:s().string,fieldValue:s().oneOfType([s().number,s().object]),fieldException:s().oneOfType([s().object,s().bool,s().string]),onUpdateField:s().func,onUpdateExceptionField:s().func,isRequired:s().bool,label:s().string,lowLabel:s().string,upLabel:s().string,options:s().shape({format:s().string,min:s().number,max:s().number,step:s().number,precision:s().number}),style:s().object}),S(N,"contextTypes",{messages:s().object}),S(N,"defaultProps",{style:{borderColor:"#dedede"},operator:"=",fieldName:null,fieldRowId:null,attType:"number",fieldValue:null,fieldException:null,isRequired:!1,label:null,lowLabel:null,upLabel:null,options:{},onUpdateField:()=>{},onUpdateExceptionField:()=>{}});const k=N;var L=i(867517),j=i(738839);function B(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class R extends o().Component{constructor(){super(...arguments),B(this,"renderField",(()=>{let e=(0,h.S$)(this.context.messages,"queryform.attributefilter.text_placeholder"),t=o().createElement(n.Tooltip,{id:"textField-tooltip"+this.props.fieldRowId},o().createElement(L.Z,{msgId:this.props.tooltipMessage??"queryform.attributefilter.tooltipTextField"})),i=o().createElement(n.FormControl,{disabled:"isNull"===this.props.operator,placeholder:e,onChange:this.changeText,type:"text",value:this.props.fieldValue||""});return(0,j.isLikeOrIlike)(this.props.operator)?o().createElement(p.Z,{key:"textField-overlay"+this.props.fieldRowId,placement:"top",overlay:t},i):i})),B(this,"changeText",(e=>{this.props.onUpdateField(this.props.fieldRowId,this.props.fieldName,e.target.value,this.props.attType)}))}componentDidMount(){"isNull"!==this.props.operator||this.props.fieldValue||this.props.onUpdateField(this.props.fieldRowId,this.props.fieldName," ",this.props.attType)}componentDidUpdate(){"isNull"!==this.props.operator||this.props.fieldValue||this.props.onUpdateField(this.props.fieldRowId,this.props.fieldName," ",this.props.attType)}render(){let e=this.props.label?o().createElement("label",null,this.props.label):o().createElement("span",null);return o().createElement("div",{className:"textField"},e,this.renderField())}}B(R,"propTypes",{operator:s().string,fieldName:s().string,fieldRowId:s().number,attType:s().string,fieldValue:s().string,label:s().string,tooltipMessage:s().string,fieldException:s().oneOfType([s().object,s().string]),onUpdateField:s().func,onUpdateExceptionField:s().func,style:s().object}),B(R,"contextTypes",{messages:s().object}),B(R,"defaultProps",{operator:"like",fieldName:null,fieldRowId:null,attType:"string",fieldValue:null,label:null,fieldException:null,onUpdateField:()=>{},onUpdateExceptionField:()=>{},style:{}});const q=R;var Z=i(157155),D=i(727437);function M(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class G extends o().Component{constructor(){super(...arguments),M(this,"getOptions",(()=>this.props.filterField&&this.props.filterField.options&&this.props.filterField.options[this.props.filterField.attribute]&&this.props.filterField.options[this.props.filterField.attribute].map((e=>({value:e,label:e}))))),M(this,"getPagination",(e=>{if(!this.props.filterField.options)return{};const t=Math.ceil(this.props.filterField.fieldOptions.valuesCount/this.props.maxFeaturesWPS),i=1===this.props.filterField.fieldOptions.currentPage||!this.props.filterField.fieldOptions.currentPage,r=this.props.filterField.fieldOptions.currentPage===t||!this.props.filterField.fieldOptions.currentPage;return c()({},this.props.pagination,{paginated:0!==e.length&&!(i&&1===e.length),firstPage:i,lastPage:r,loadPrevPage:()=>this.props.onUpdateField(this.props.filterField.rowId,"value",this.props.filterField.value,"string",{currentPage:this.props.filterField.fieldOptions.currentPage-1,delayDebounce:0}),loadNextPage:()=>this.props.onUpdateField(this.props.filterField.rowId,"value",this.props.filterField.value,"string",{currentPage:this.props.filterField.fieldOptions.currentPage+1,delayDebounce:0})})})),M(this,"getTooltip",(()=>c()({},this.props.tooltip,{enabled:(0,j.isLikeOrIlike)(this.props.filterField.operator),id:"autocompleteField-tooltip"+this.props.filterField&&this.props.filterField.rowId,message:o().createElement(L.Z,{msgId:"queryform.attributefilter.tooltipTextField"}),overlayTriggerKey:"autocompleteField-overlay"+this.props.filterField&&this.props.filterField.rowId,placement:"top"}))),M(this,"renderField",(()=>{let e;this.props.filterField&&this.props.filterField.value&&"*"!==this.props.filterField.value&&(e={value:this.props.filterField.value,label:this.props.filterField.value});let t=this.getOptions()?this.getOptions().slice(0):[];return o().createElement(D.Z,{dropUp:this.props.dropUp,busy:this.props.filterField.loading,data:this.props.filterField.loading?[]:t,disabled:"isNull"===this.props.filterField.operator,itemComponent:this.props.itemComponent,open:this.props.filterField.openAutocompleteMenu,onChange:e=>this.handleChange(e),onFocus:()=>this.handleFocus(t),onSelect:()=>this.handleSelect(),onToggle:()=>this.handleToggle(t),pagination:this.getPagination(t),selectedValue:e&&e.value,tooltip:this.getTooltip()})})),M(this,"handleSelect",(()=>{this.selected=!0})),M(this,"handleChange",(e=>{this.selected?(this.selected=!1,e&&""!==e.value&&this.props.onUpdateField(this.props.filterField.rowId,"value",e.value,"string",{currentPage:1,selected:"selected",delayDebounce:0})):this.props.onUpdateField(this.props.filterField.rowId,"value","string"==typeof e?e:e.value,"string",{currentPage:1,delayDebounce:1e3})})),M(this,"handleFocus",(e=>{this.loadWithoutfilter(e)})),M(this,"handleToggle",(()=>{this.props.toggleMenu(this.props.filterField.rowId,!this.props.filterField.openAutocompleteMenu)})),M(this,"loadWithoutfilter",(e=>{0!==e.length||this.props.filterField.value||this.props.onUpdateField(this.props.filterField.rowId,"value","","string",{currentPage:1,delayDebounce:0})}))}render(){let e=this.props.label?o().createElement("label",null,this.props.label):o().createElement("span",null);return o().createElement("div",{className:"autocompleteField"},e,this.renderField())}}M(G,"propTypes",{dropUp:s().bool,disabled:s().bool,filterField:s().object,label:s().string,itemComponent:s().oneOfType([s().object,s().func]),maxFeaturesWPS:s().number,onUpdateField:s().func,pagination:s().object,textField:s().string,tooltip:s().object,toggleMenu:s().func,valueField:s().string}),M(G,"contextTypes",{messages:s().object}),M(G,"defaultProps",{label:null,onUpdateField:()=>{},pagination:{paginated:!0,nextPageIcon:"chevron-right",prevPageIcon:"chevron-left"},itemComponent:Z.Z,toggleMenu:()=>{},filterField:{fieldOptions:{}}});const _=G;var A=i(569291),W=i(313311),$=i.n(W);function H(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class K extends o().Component{constructor(){super(...arguments),H(this,"state",{open:!1}),H(this,"getSelected",(()=>$()(this.props.options,this.getFindFunciton()))),H(this,"getValue",(e=>this.props.valueField&&e&&e[this.props.valueField]?e[this.props.valueField]:e)),H(this,"getLabel",(e=>this.props.labelField&&e&&e[this.props.labelField]?e[this.props.labelField]:this.getValue(e))),H(this,"getFindFunciton",(()=>this.props.valueField?{[this.props.valueField]:this.props.value}:this.props.value)),H(this,"renderLabel",(e=>this.props.labelRenderer?this.props.labelRenderer(e):this.getLabel(e))),H(this,"handleOutsideClick",(e=>{this.node&&this.node.contains&&!this.node.contains(e.target)&&this.state.open?this.handleClick():document&&!this.node&&this.handleOutsideClick&&document.removeEventListener("click",this.handleOutsideClick,!1)})),H(this,"handleClick",(()=>{document&&!this.state.open?document.addEventListener("click",this.handleOutsideClick,!1):document.removeEventListener("click",this.handleOutsideClick,!1);const e=!this.state.open;this.setState({open:e})}))}render(){return o().createElement("span",{ref:e=>{this.node=e},className:"mapstore-string-select"},o().createElement("span",{onClick:this.handleClick},o().createElement("strong",null,this.renderLabel(this.getSelected())),o().createElement(n.Glyphicon,{glyph:"chevron-down"})),this.state.open&&o().createElement("div",{className:"m-options"},o().createElement("ul",null,this.props.options.map(((e,t)=>o().createElement("li",{key:t,onClick:()=>{this.setState({open:!1}),this.props.onSelect(this.getValue(e),e)}},this.renderLabel(e)))))))}}H(K,"propTypes",{options:s().array,value:s().any,onSelect:s().func,valueField:s().string,labelField:s().string,labelRenderer:s().any}),H(K,"defaultProps",{onSelect:()=>{},options:[]});const z=K;var J=i(131400),Q=i(23888);function X(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Y extends o().Component{constructor(){super(...arguments),X(this,"getComboValues",((e,t)=>{if(e&&e.dependson){let i=this.props.filterFields.filter((t=>t.attribute===e.dependson.field))[0];if(i&&i.value){let r=t.filter((e=>e.attribute===i.attribute))[0],o=r.values.filter((e=>e[r.valueId]===i.value))[0][e.dependson.from],l=e.values.filter((t=>t[e.dependson.to]===o));return e&&"list"===e.type?l.map((t=>({id:e.fidPrefix?e.fidPrefix+"."+t[e.valueId]:t[e.valueId],name:t[e.valueLabel]}))):null}}return e&&"list"===e.type?e.values.map((t=>({id:e.fidPrefix?e.fidPrefix+"."+t[e.valueId]:t[e.valueId],name:t[e.valueLabel]}))):null})),X(this,"getOperator",(e=>{switch(e&&e.type?e.type:""){case"list":return this.props.listOperators;case"string":return this.props.stringOperators;case"boolean":return this.props.booleanOperators;case"array":return this.props.arrayOperators;default:return this.props.defaultOperators}})),X(this,"renderFilterField",(e=>{let t=this.props.attributes.filter((t=>t.attribute===e.attribute))[0],i=this.getComboValues(t,this.props.attributes);const r=e.exception?o().createElement(p.Z,{placement:"bottom",overlay:o().createElement(n.Tooltip,{id:e.rowId+"tooltip"},o().createElement("strong",null,o().createElement(J.ZP.Message,{msgId:e.exception||""})))},o().createElement(Q.Z,{id:"remove-filter-field",className:"filter-buttons no-border",bsStyle:this.props.buttonStyle,style:{backgroundColor:"red"},onClick:()=>this.props.actions.onRemoveFilterField(e.rowId)},o().createElement(n.Glyphicon,{style:{color:"white"},glyph:"glyphicon glyphicon-warning-sign"}))):o().createElement(p.Z,{placement:"top",overlay:o().createElement(n.Tooltip,{id:e.rowId+"tooltip"},o().createElement("strong",null,o().createElement(J.ZP.Message,{msgId:"queryform.attributefilter.delete"})))},o().createElement(Q.Z,{id:"remove-filter-field",bsStyle:this.props.buttonStyle,className:"filter-buttons no-border",onClick:()=>this.props.actions.onRemoveFilterField(e.rowId)},o().createElement(n.Glyphicon,{glyph:this.props.removeButtonIcon})));return o().createElement(b,{dropUp:this.props.dropUp,key:e.rowId,deleteButton:r,attributes:this.props.attributes,filterField:e,operatorOptions:this.getOperator(t),onUpdateField:this.props.actions.onUpdateFilterField,toggleMenu:this.props.actions.toggleMenu,maxFeaturesWPS:this.props.maxFeaturesWPS,onUpdateExceptionField:this.props.actions.onUpdateExceptionField,onChangeCascadingValue:this.props.actions.onChangeCascadingValue},o().createElement(d.Z,{dropUp:this.props.dropUp,attType:"list",valueField:"id",textField:"name",fieldOptions:i||[],comboFilter:"contains"}),o().createElement(V,{attType:"date",dateEnabled:!0,operator:e.operator}),o().createElement(V,{attType:"date-time",timeEnabled:!0,dateEnabled:!0,operator:e.operator}),o().createElement(q,{attType:"array",operator:e.operator}),o().createElement(V,{attType:"time",timeEnabled:!0,dateEnabled:!1,operator:e.operator}),o().createElement(k,{operator:e.operator,attType:"number"}),this.props.autocompleteEnabled?o().createElement(_,{dropUp:this.props.dropUp,filterField:e,attType:"string"}):o().createElement(q,{tooltipMessage:this.props.textFieldTooltipMessageId,operator:e.operator,attType:"string"}),o().createElement(d.Z,{dropUp:this.props.dropUp,fieldOptions:["true","false"],attType:"boolean",comboFilter:"contains"}))})),X(this,"renderGroupButtons",(e=>{const t=[];return e.index<=this.props.groupLevels&&t.push({key:"add-condition-group",id:"add-condition-group",className:"filter-buttons no-border",glyph:"list-alt",bsStyle:this.props.buttonStyle,tooltipId:"queryform.attributefilter.add_group",onClick:()=>this.props.actions.onAddGroupField(e.id,e.index)}),t.push({key:"add-filter-field",id:"add-filter-field",className:"filter-buttons no-border",glyph:this.props.addButtonIcon,bsStyle:this.props.buttonStyle,tooltipId:"queryform.attributefilter.add_condition",onClick:()=>this.props.actions.onAddFilterField(e.id)}),e.groupId&&t.push({key:"remove-group",className:"filter-buttons no-border",bsStyle:this.props.buttonStyle,tooltipId:"queryform.attributefilter.deleteGroup",glyph:this.props.removeGroupButtonIcon,onClick:()=>this.props.actions.onRemoveGroupField(e.id)}),o().createElement(a.Z,{buttons:t,btnDefaultProps:{}})})),X(this,"renderGroupHeader",(e=>o().createElement("div",{className:"logicHeader filter-logic-header"},o().createElement("div",{key:"filter-logic-header",className:"filter-logic-header-text m-label"},o().createElement("span",{className:"group_label_a"},o().createElement(J.ZP.Message,{msgId:"queryform.attributefilter.group_label_a"}))," ",o().createElement(z,{options:this.props.logicComboOptions,valueField:"logic",value:e.logic,onSelect:t=>this.props.actions.onUpdateLogicCombo(e.id,t),labelRenderer:function(){let{name:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(J.ZP.Message,{msgId:e})}})," ",o().createElement("span",{className:"group_label_b"},o().createElement(J.ZP.Message,{msgId:"queryform.attributefilter.group_label_b"}))),this.renderGroupButtons(e)))),X(this,"renderGroupField",(e=>{const t=[...this.props.filterFields.filter((t=>t.groupId===e.id)),...this.props.groupFields.filter((t=>t.groupId===e.id))].map((e=>{let t;return t=void 0!==e.rowId?this.renderFilterField(e):this.renderGroupField(e),t}));return o().createElement("div",{className:"mapstore-conditions-group",key:e.id},this.renderGroupHeader(e),o().createElement("div",{className:"query-content"},t))})),X(this,"renderHeader",(()=>(0,h.S$)(this.context.messages,"queryform.attributefilter.attribute_filter_header"))),X(this,"updateLogicCombo",((e,t,i)=>{const r=this.props.logicComboOptions.filter((e=>i===(0,h.S$)(this.context.messages,e.name)))[0].logic;this.props.actions.onUpdateLogicCombo(e,r)}))}render(){return this.props.withContainer?o().createElement(A.Z,{id:"attributeFilterPanel",className:"query-filter-container",header:this.renderHeader(),collapsible:!0,expanded:this.props.attributePanelExpanded,onSwitch:e=>this.props.actions.onExpandAttributeFilterPanel(e)},this.props.groupFields.filter((e=>!e.groupId)).map(this.renderGroupField)):o().createElement("div",{className:"query-filter-container"},this.props.groupFields.filter((e=>!e.groupId)).map(this.renderGroupField))}}X(Y,"propTypes",{dropUp:s().bool,groupLevels:s().number,withContainer:s().bool,autocompleteEnabled:s().bool,maxFeaturesWPS:s().number,groupFields:s().array,filterFields:s().array,attributes:s().array,fieldWidth:s().string,removeButtonIcon:s().string,addButtonIcon:s().string,removeGroupButtonIcon:s().string,buttonStyle:s().string,logicComboOptions:s().array,attributePanelExpanded:s().bool,actions:s().object,arrayOperators:s().array,listOperators:s().array,stringOperators:s().array,booleanOperators:s().array,defaultOperators:s().array,comboOptions:s().object,textFieldTooltipMessageId:s().string}),X(Y,"contextTypes",{messages:s().object}),X(Y,"defaultProps",{autocompleteEnabled:!0,withContainer:!0,groupLevels:1,groupFields:[],filterFields:[],attributes:[],removeButtonIcon:"trash",removeGroupButtonIcon:"trash",bsStyle:"default",addButtonIcon:"glyphicon glyphicon-plus",attributePanelExpanded:!0,logicComboOptions:[{logic:"OR",name:"queryform.attributefilter.groupField.any"},{logic:"AND",name:"queryform.attributefilter.groupField.all"},{logic:"NOR",name:"queryform.attributefilter.groupField.none"}],actions:{onAddGroupField:()=>{},onAddFilterField:()=>{},onRemoveFilterField:()=>{},onUpdateFilterField:()=>{},onUpdateExceptionField:()=>{},onUpdateLogicCombo:()=>{},onRemoveGroupField:()=>{},onChangeCascadingValue:()=>{},onExpandAttributeFilterPanel:()=>{},toggleMenu:()=>{}},listOperators:["="],stringOperators:["=","<>","like","ilike","isNull"],arrayOperators:["contains"],booleanOperators:["="],defaultOperators:["=",">","<",">=","<=","<>","><"],textFieldTooltipMessageId:"queryform.attributefilter.tooltipTextField"});const ee=Y}}]);